%%%% utfpr-article.sty, 2025/08/07 v1.9
%%%% Copyright (C) 2016-2025 Luiz E. M. Lima (luizeduardomlima@gmail.com)
%%
%% This work may be distributed and/or modified under the conditions of the
%% LaTeX Project Public License, either version 1.3 of this license or (at your
%% option) any later version.
%% The latest version of this license is in
%%   https://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX version
%% 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `maintained'.
%%
%% The Current Maintainer of this work is Luiz E. M. Lima.
%%
%% This work consists of all files listed in readme.html.
%%
%% A brief description of this work is in readme.txt.

%% Identificação e atualizações
\NeedsTeXFormat{LaTeX2e}[2005/12/01]
\ProvidesPackage{utfpr-article}[2025/08/07 v1.9 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2024/10/05 v1.8 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2024/08/10 v1.7 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2024/02/15 v1.6 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2023/10/10 v1.5 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2023/06/08 v1.4 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-article}[2023/04/20 v1.3 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
%%%% Alteração dos arquivos constituintes para uso em eventos (SEI-SICITE, etc.).
% \ProvidesPackage{utfpr-article}[2019/12/05 v1.2 utfpr-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
%%%% Alteração de nomes dos arquivos (utfprpgtex-article --> utfpr-article).
%%%% Inserção de opção para uso do estilo numérico da ABNT.
% \ProvidesPackage{utfprpgtex-article}[2019/02/20 v1.1 utfprpgtex-article package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
%%%% Alteração de bibtex para biber (biblatex) na produção de citações e referências.
% \ProvidesPackage{utfprpgtex-article}[2016/03/01 v1.0 utfprpgtex-article package]
%%%% Criação dos arquivos constituintes.

%% Opções do pacote (^ = padrão; ¹ = Leiaute A; ² = Leiaute B)
\RequirePackage{xpatch}
\RequirePackage{xkeyval}
\@ifpackageloaded{xstring}{}{\RequirePackage{xstring}}
% \tracingpatches%
%%%% Leiaute (margens): A (esquerda menor + recuo) ou B (iguais) (^)
\newbool{@LayoutA}
\DeclareOptionX{Layout}[B]{%
  \ifstrequal{#1}{A}{%
    \booltrue{@LayoutA}%
    \ExecuteOptionsX{%
      Font      = Calibri,%
      Rule      = Both,%
      SectNum   = Off,%
      UnnumSect = Center,%
    }%
  }{}%
  \ifstrequal{#1}{B}{%
    \boolfalse{@LayoutA}%
    \ExecuteOptionsX{%
      Font      = Arial,%
      Rule      = None,%
      SectNum   = On,%
      UnnumSect = Left,%
    }%
  }{}%
}
%%%% Fonte principal: Arial (²), Calibri (¹), Times ou LaTeX(*)
\newbool{@FontArial}
\newbool{@FontCalibri}
\newbool{@FontTimes}
\DeclareOptionX{Font}[Arial]{%
  \boolfalse{@FontArial}%
  \boolfalse{@FontCalibri}%
  \boolfalse{@FontTimes}%
  \ifstrequal{#1}{Arial}{\booltrue{@FontArial}}{}%
  \ifstrequal{#1}{Calibri}{\booltrue{@FontCalibri}}{}%
  \ifstrequal{#1}{Times}{%
    \booltrue{@FontTimes}%
    \csdef{rm@font}{ntxtlf}%
  }{}%
  \ifstrequal{#1}{LaTeX*}{\csdef{rm@font}{lmr}}{}%% Serif
}
%%%% Cor (HTML) texto (preto ^)
\DeclareOptionX{TextColor}{\ifblank{#1}{}{\csdef{@TextColor}{#1}}}
%%%% Cor (HTML) ênfase (preto ^)
\DeclareOptionX{EmphColor}{\ifblank{#1}{}{\csdef{@EmphColor}{#1}}}
%%%% Cor (HTML) hyperlink (azul escuro ^): nenhuma (cor texto)
\DeclareOptionX{LinkColor}[00008B]{\ifblank{#1}{\csdef{@LinkColor}{}}{\csdef{@LinkColor}{#1}}}
%%%% Linha (cabeçalho e rodapé): None (²), Header, Footer ou Both (¹)
\newbool{@RuleHeader}
\newbool{@RuleFooter}
\DeclareOptionX{Rule}[None]{%
  \ifstrequal{#1}{Header}{\booltrue{@RuleHeader}}{}%
  \ifstrequal{#1}{Footer}{\booltrue{@RuleFooter}}{}%
  \ifstrequal{#1}{Both}{\ExecuteOptionsX{Rule = Header, Rule = Footer}}{}%
}
%%%% Ícones de e-mail, Lattes, ORCID e Instituição: On (^) ou Off
\newbool{@AffilIconOn}
\DeclareOptionX{AffilIcon}[On]{\ifstrequal{#1}{On}{\booltrue{@AffilIconOn}}{\boolfalse{@AffilIconOn}}}
%%%% Licença do documento: CC (Creative Commons) (^) ou None
\newbool{@DocLicCC}
\DeclareOptionX{DocLic}[CC]{\ifstrequal{#1}{CC}{\booltrue{@DocLicCC}}{\boolfalse{@DocLicCC}}}
%%%% Licença CC: BY (^), BY-SA, BY-ND, BY-NC, BY-NC-SA ou BY-NC-ND
\newbool{@CCLicSA}
\newbool{@CCLicND}
\newbool{@CCLicNC}
\DeclareOptionX{CCLic}[BY]{%
  \ifstrequal{#1}{BY-SA}{\booltrue{@CCLicSA}}{}%
  \ifstrequal{#1}{BY-ND}{\booltrue{@CCLicND}}{}%
  \ifstrequal{#1}{BY-NC}{\booltrue{@CCLicNC}}{}%
  \ifstrequal{#1}{BY-NC-SA}{\ExecuteOptionsX{CCLic = BY-NC, CCLic = BY-SA}}{}%
  \ifstrequal{#1}{BY-NC-ND}{\ExecuteOptionsX{CCLic = BY-NC, CCLic = BY-ND}}{}%
}
%%%% Numeração de páginas: On (^) ou Off
\newbool{@PageNumOn}
\DeclareOptionX{PageNum}[On]{\ifstrequal{#1}{On}{\booltrue{@PageNumOn}}{\boolfalse{@PageNumOn}}}
%%%% Numeração de seções (\section): On (²) ou Off (¹)
\newbool{@SectNumOn}
\DeclareOptionX{SectNum}[On]{\ifstrequal{#1}{On}{\booltrue{@SectNumOn}}{\boolfalse{@SectNumOn}}}
%%%% Alinhamento de seções (\section*): Center (¹) ou Left (²)
\csletcs{UnnumSectCenter}{relax}
\DeclareOptionX{UnnumSect}[Left]{\ifstrequal{#1}{Center}{\csletcs{UnnumSectCenter}{centering}}{}}
%%%% Alinhamento de legendas: Center (^) ou Left
\newbool{@CaptionCenter}
\DeclareOptionX{Caption}[Center]{\ifstrequal{#1}{Center}{\booltrue{@CaptionCenter}}{\boolfalse{@CaptionCenter}}}
%%%% Alinhamento de fontes (autoria): Center (^) ou Left
\newbool{@SourceCenter}
\DeclareOptionX{Source}[Center]{\ifstrequal{#1}{Center}{\booltrue{@SourceCenter}}{\boolfalse{@SourceCenter}}}
%%%% Citação ABNT: AAY (Nome, Ano) (^), NRB (1) ou NSB [1]
\newbool{@ABNTCitNRB}
\newbool{@ABNTCitNSB}
\DeclareOptionX{ABNTCit}[AAY]{%
  \boolfalse{@ABNTCitNRB}%
  \boolfalse{@ABNTCitNSB}%
  \ifstrequal{#1}{NRB}{\booltrue{@ABNTCitNRB}}{}%
  \ifstrequal{#1}{NSB}{%
    \booltrue{@ABNTCitNRB}%
    \booltrue{@ABNTCitNSB}%
  }{}%
}
%%%% Ícone de DOI em referências: On ou Off (^)
\newbool{@DOIIconOn}
\DeclareOptionX{DOIIcon}[Off]{\ifstrequal{#1}{On}{\booltrue{@DOIIconOn}}{\boolfalse{@DOIIconOn}}}
%%%% Ícone de URL em referências: On ou Off (^)
\newbool{@URLIconOn}
\DeclareOptionX{URLIcon}[Off]{\ifstrequal{#1}{On}{\booltrue{@URLIconOn}}{\boolfalse{@URLIconOn}}}
%%%% Índice Remissivo (makeindex): On ou Off (^)
\newbool{@IndexOn}
\DeclareOptionX{Index}[Off]{\ifstrequal{#1}{On}{\booltrue{@IndexOn}}{\boolfalse{@IndexOn}}}
%%%% Aviso de indisponíveis, execução de padrões e processamento de atribuídas
\DeclareOptionX*{\PackageWarning{utfpr-article}{Unknown option `\CurrentOption'}}
\ExecuteOptionsX{%
  Layout    = B,%
  LinkColor = 00008B,%
  AffilIcon = On,%
  DocLic    = CC,%
  CCLic     = BY,%
  PageNum   = On,%
  Caption   = Center,%
  Source    = Center,%
  ABNTCit   = AAY,%
  DOIIcon   = Off,%
  URLIcon   = Off,%
  Index     = Off,%
}
\ProcessOptionsX\relax%

%% Pacotes utilizados
\RequirePackage{ifdraft}
\RequirePackage{iftex}
\RequirePackage{babel}
\RequirePackage{iflang}
\ifboolexpr{ bool {LuaTeX} or bool {XeTeX} }{%
  \RequirePackage{fontspec}%
  \RequirePackage{amsmath}%
  \RequirePackage[bold-style = ISO]{unicode-math}%
  \defaultfontfeatures{Ligatures = TeX}%
  \ifboolexpr{ bool {@FontArial} or bool {@FontTimes} }{%
    \setmainfont{texgyretermes}[%
      UprightFont    = *-regular,%
      BoldFont       = *-bold,%
      ItalicFont     = *-italic,%
      BoldItalicFont = *-bolditalic,%
      Extension      = .otf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \setsansfont{texgyreheros}[%
      UprightFont    = *-regular,%
      BoldFont       = *-bold,%
      ItalicFont     = *-italic,%
      BoldItalicFont = *-bolditalic,%
      Extension      = .otf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \setmathfont{texgyretermes-math}[Extension = .otf]%% CHKTEX 26
    \setmathfont{texgyretermes-math}[Extension = .otf, version = bold]%% CHKTEX 26
  }{}%
  \ifbool{@FontCalibri}{%
    \setsansfont{Carlito}[%
      UprightFont    = *-Regular,%
      BoldFont       = *-Bold,%
      ItalicFont     = *-Italic,%
      BoldItalicFont = *-BoldItalic,%
      Extension      = .ttf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \ifbool{LuaTeX}{\pdfvariable omitcidset = 1}{}%% CHKTEX 1
  }{}%
}{%
  \RequirePackage[utf8]{inputenc}%
  \RequirePackage[T1]{fontenc}%
  \@ifl@t@r\fmtversion{2023/02/11}{\pdfspacefont{texnansi-lmr1\@ptsize}}{}%
  \pdfinterwordspaceon%
  \ifboolexpr{ bool {@FontArial} or bool {@FontTimes} }{%
    \RequirePackage[scaled = 1.0, helvratio = 1.0]{newtxtext}%
    \RequirePackage[smallerops]{newtxmath}%
  }{%
    \RequirePackage{amsmath}%
    \@ifpackageloaded{amssymb}{}{\RequirePackage{amssymb}}%
    \RequirePackage{lmodern}%
    \RequirePackage{textcomp}%
  }%
  \ifbool{@FontCalibri}{\RequirePackage[sfdefault, lining, tabular]{carlito}}{}%
}
\RequirePackage{fontawesome5}
\RequirePackage{microtype}
\RequirePackage{ragged2e}
\RequirePackage[overload]{textcase}
\RequirePackage{csquotes}
\RequirePackage{lipsum}
\RequirePackage[table]{xcolor}
\RequirePackage[\ifdraft{showframe}{}]{geometry}
\ifbool{@LayoutA}{\RequirePackage{scrextend, xstring}}{}
\RequirePackage{indentfirst}
\RequirePackage{fancyhdr}
\RequirePackage[bottom, hang]{footmisc}
\RequirePackage{enumitem}
\RequirePackage{icomma}
\RequirePackage{newfloat}
\RequirePackage[content = {\faFileImage}, position = {center}]{draftfigure}
\RequirePackage{eso-pic}
\RequirePackage{graphicx}
\RequirePackage{booktabs}
\RequirePackage{tabularx}
\RequirePackage{caption}
\RequirePackage[%
  style        = abnt\ifbool{@ABNTCitNRB}{-numeric}{},%
  natbib       = true,%
  sorting      = \ifbool{@ABNTCitNRB}{none}{nty},%
  uniquename   = minfull,%
  uniquelist   = \ifbool{@ABNTCitNRB}{false}{minyear},%
  extradate    = true,%
  repeatfields = true,%
  \ifbool{@ABNTCitNRB}{comp = true,}{}%
]{biblatex}
\ifbool{@IndexOn}{%
  \RequirePackage{multicol}%
  \RequirePackage{makeidx}%
}{}
\RequirePackage[hyphens]{xurl}
\RequirePackage[numbered = true, \ifdraft{draft = true}{}]{bookmark}
\RequirePackage[capitalise, nameinlink]{cleveref}

%% Configuração do pacote microtype
\@ifpackagelater{microtype}{2021/10/31}{\microtypesetup{nopatch = {eqnum,footnote}}}{}

%% Fontes
\ifcsvoid{rm@font}{\renewcommand*{\familydefault}{\sfdefault}}{}
\newcommand*{\VIIptFS}{\fontsize{7}{9}\selectfont}
\newcommand*{\IXptFS}{\fontsize{9}{11}\selectfont}
\newcommand*{\XVptFS}{\fontsize{15}{17}\selectfont}
\csletcs{old@ttfamily}{ttfamily}
\renewrobustcmd*{\ttfamily}{\old@ttfamily\hyphenchar\font=`\-\relax}
\csletcs{Old@TeX}{TeX}
\csletcs{Old@LaTeX}{LaTeX}
\AtBeginDocument{%
  \renewrobustcmd*{\TeX}{{\fontfamily{lmr}\selectfont\protect\Old@TeX}}%
  \renewrobustcmd*{\LaTeX}{{\fontfamily{lmr}\selectfont\Old@LaTeX}}%
}
\newrobustcmd*{\UTFPR}{UTF{\tiny\kern-0.1em\hbox{PR}}}

%% Cores
\definecolor{UTFPRBlack}{RGB}{0, 0, 0}
\definecolor{UTFPRYellow}{RGB}{255, 204, 0}
\definecolor{ORCIDGreen}{RGB}{166, 206, 57}
\ifcsvoid{@TextColor}{}{\definecolor{TextColor}{HTML}{\@TextColor}}
\@ifundefinedcolor{TextColor}{}{\color{TextColor}}
\ifcsvoid{@EmphColor}{%
  \colorlet{EmphColor}{.}%
}{%
  \definecolor{EmphColor}{HTML}{\@EmphColor}%
}
\ifcsvoid{@LinkColor}{%
  \colorlet{LinkColor}{.}%
}{%
  \definecolor{LinkColor}{HTML}{\@LinkColor}%
}
\colorlet{HyRefColor}{\ifcsvoid{@LinkColor}{}{LinkColor!50!}.}

%% Hiperlinks e URLs
\hypersetup{%
  colorlinks         = true,%
  allcolors          = HyRefColor,%
  pdfdisplaydoctitle = true,%
  pdfencoding        = unicode,%
}
\pdfstringdefDisableCommands{%
  \csletcs{MakeUppercase}{@firstofone}%
  \renewcommand*{\\}{ }%
}
\DeclareUrlCommand{\URL}{%
  \renewcommand*{\UrlFont}{\color{HyRefColor}\ttfamily}%
  \renewcommand*{\UrlLeft}{<}%
  \renewcommand*{\UrlRight}{>}%
}
\csgappto{UrlBreaks}{\UrlOrds}
\csgappto{UrlSpecials}{\do\_{\_\penalty\UrlBreakPenalty}}

%% Variáveis dependentes do idioma
\newcommand*{\SectAutoRefName}[1]{\csletcs{#1autorefname}{Cref@section@name}}
\newcommand*{\MECName}{Ministério da Educação}
\newcommand*{\UTFPRName}{Universidade Tecnológica Federal do Paraná}
\newcommand*{\BRName}{Brasil}
\newcommand*{\CityCall}{Cidade}
\newcommand*{\InstDeptEx}{Departamento, Coordenação, Programa ou Curso}
\newcommand*{\FullNameCall}{Nome Completo do{(a)} Autor{(a)}}
\newcommand*{\KWCall}{Palavras-chave}
\newcommand*{\RcvdCall}{Recebido}
\newcommand*{\AppdCall}{Aprovado}
\newcommand*{\CCLicCall}{Direito autoral}
\newcommand*{\CCLicType}{%
  \ifbool{@CCLicNC}{\csuse{textendash}Não\-Co\-mer\-cial}{}%
  \ifbool{@CCLicND}{\csuse{textendash}Sem\-De\-ri\-va\-ções}{}%
  \ifbool{@CCLicSA}{\csuse{textendash}Com\-par\-ti\-lha\-Igual}{}%
}
\newcommand*{\CCLicDescr}{%
  Este artigo\ifcsvoid{@CCLicYear}{}{ \@CCLicYear}\ifcsvoid{@CCLicAuthor}{}{ de \@CCLicAuthor} está licenciado sob %
  \href{\CCLicURL}{Cre\-ative Com\-mons Atribuição{\CCLicType} 4.0 Internacional \CCLicIcons}%
  \ifbool{@LayoutA}{}{%
    \ifboolexpr{ test {\ifcsvoid{@CCLicYear}} and test {\ifcsvoid{@CCLicAuthor}} }{, %
      que permite uso e distribuição em qualquer meio ou formato, %
      desde que o trabalho original seja devidamente citado%
      \ifbool{@CCLicNC}{\ifboolexpr{ bool {@CCLicND} or bool {@CCLicSA} }{,}{ e} o uso não seja comercial}{}%
      \ifbool{@CCLicND}{ e nenhuma modificação ou adaptação seja feita}{}%
      \ifbool{@CCLicSA}{ e as modificações ou adaptações sejam licenciadas sob termos idênticos}{}%
    }{}%
  }.%
}
\newcommand*{\HdrWrng}{Inserir Cabeçalho\\(\LengthTo*{cm}{\HdrWidth}\,cm \texttimes\ \LengthTo*{cm}{\TopLine}\,cm)}
\newcommand*{\LogoWrng}{Inserir Logo}
\newcommand*{\SDGStmpWrng}{Inserir Selo ODS}
\newcommand*{\SrcCall}{Fonte}
\ifbool{@IndexOn}{%
  \renewcommand*{\seename}{ver}%
  \renewcommand*{\seealso}{ver também}%
}{}
\newcommand*{\TtlPgName}{Página de Título}
\newcommand*{\AcronymsListName}{Lista de Abreviaturas e Siglas}
\newcommand*{\SymbolsListName}{Lista de Símbolos}
\newcommand*{\flowchartname}{Fluxograma}
\newcommand*{\photographname}{Fotografia}
\newcommand*{\graphname}{Gráfico}
\newcommand*{\tabframedname}{Quadro}
\renewcommand*{\listfigurename}{Lista de Ilustrações}
\Crefname{flowchart}{Fluxograma}{Fluxogramas}
\crefname{flowchart}{Flux.}{Fluxs.}
\Crefname{photograph}{Fotografia}{Fotografias}
\crefname{photograph}{Fot.}{Fots.}
\Crefname{graph}{Gráfico}{Gráficos}
\crefname{graph}{Gráf.}{Gráfs.}
\Crefname{tabframed}{Quadro}{Quadros}
\crefname{tabframed}{Quad.}{Quads.}
\Crefname{annex}{Anexo}{Anexos}
\crefname{annex}{Anexo}{Anexos}
\forcsvlist{\SectAutoRefName}{section, subsection, subsubsection, paragraph, subparagraph}
%%%% Definições em português
\csappto{extrasbrazilian}{%
  \renewcommand*{\MECName}{Ministério da Educação}%
  \renewcommand*{\UTFPRName}{Universidade Tecnológica Federal do Paraná}%
  \renewcommand*{\BRName}{Brasil}%
  \renewcommand*{\CityCall}{Cidade}%
  \renewcommand*{\InstDeptEx}{Departamento, Coordenação, Programa ou Curso}%
  \renewcommand*{\FullNameCall}{Nome Completo do{(a)} Autor{(a)}}%
  \renewcommand*{\KWCall}{Palavras-chave}%
  \renewcommand*{\RcvdCall}{Recebido}%
  \renewcommand*{\AppdCall}{Aprovado}%
  \renewcommand*{\CCLicCall}{Direito autoral}%
  \renewcommand*{\CCLicType}{%
    \ifbool{@CCLicNC}{\csuse{textendash}Não\-Co\-mer\-cial}{}%
    \ifbool{@CCLicND}{\csuse{textendash}Sem\-De\-ri\-va\-ções}{}%
    \ifbool{@CCLicSA}{\csuse{textendash}Com\-par\-ti\-lha\-Igual}{}%
  }%
  \renewcommand*{\CCLicDescr}{%
    Este artigo\ifcsvoid{@CCLicYear}{}{ \@CCLicYear}\ifcsvoid{@CCLicAuthor}{}{ de \@CCLicAuthor} está licenciado sob %
    \href{\CCLicURL}{Cre\-ative Com\-mons Atribuição{\CCLicType} 4.0 Internacional \CCLicIcons}%
    \ifbool{@LayoutA}{}{%
      \ifboolexpr{ test {\ifcsvoid{@CCLicYear}} and test {\ifcsvoid{@CCLicAuthor}} }{, %
        que permite uso e distribuição em qualquer meio ou formato, %
        desde que o trabalho original seja devidamente citado%
        \ifbool{@CCLicNC}{\ifboolexpr{ bool {@CCLicND} or bool {@CCLicSA} }{,}{ e} o uso não seja comercial}{}%
        \ifbool{@CCLicND}{ e nenhuma modificação ou adaptação seja feita}{}%
        \ifbool{@CCLicSA}{ e as modificações ou adaptações sejam licenciadas sob termos idênticos}{}%
      }{}%
    }.%
  }%
  \renewcommand*{\HdrWrng}{Inserir Cabeçalho\\(\LengthTo*{cm}{\HdrWidth}\,cm \texttimes\ \LengthTo*{cm}{\TopLine}\,cm)}%
  \renewcommand*{\LogoWrng}{Inserir Logo}%
  \renewcommand*{\SDGStmpWrng}{Inserir Selo ODS}%
  \renewcommand*{\SrcCall}{Fonte}%
  \ifbool{@IndexOn}{%
    \renewcommand*{\seename}{ver}%
    \renewcommand*{\seealso}{ver também}%
  }{}%
  \renewcommand*{\TtlPgName}{Página de Título}%
  \renewcommand*{\AcronymsListName}{Lista de Abreviaturas e Siglas}%
  \renewcommand*{\SymbolsListName}{Lista de Símbolos}%
  \renewcommand*{\flowchartname}{Fluxograma}%
  \renewcommand*{\photographname}{Fotografia}%
  \renewcommand*{\graphname}{Gráfico}%
  \renewcommand*{\tabframedname}{Quadro}%
  \renewcommand*{\listfigurename}{Lista de Ilustrações}%
  \Crefname{flowchart}{Fluxograma}{Fluxogramas}%
  \crefname{flowchart}{Flux.}{Fluxs.}%
  \Crefname{photograph}{Fotografia}{Fotografias}%
  \crefname{photograph}{Fot.}{Fots.}%
  \Crefname{graph}{Gráfico}{Gráficos}%
  \crefname{graph}{Gráf.}{Gráfs.}%
  \Crefname{tabframed}{Quadro}{Quadros}%
  \crefname{tabframed}{Quad.}{Quads.}%
  \Crefname{annex}{Anexo}{Anexos}%
  \crefname{annex}{Anexo}{Anexos}%
  \forcsvlist{\SectAutoRefName}{section, subsection, subsubsection, paragraph, subparagraph}%
}
%%%% Definitions in english
\csappto{captionsenglish}{\renewcommand*{\contentsname}{Summary}}
\csappto{extrasenglish}{%
  \renewcommand*{\MECName}{Ministry of Education}%
  \renewcommand*{\UTFPRName}{Federal University of Technology \textemdash\ Paraná}%
  \renewcommand*{\BRName}{Brazil}%
  \renewcommand*{\CityCall}{City}%
  \renewcommand*{\InstDeptEx}{Department, Coordination, Program or Course}%
  \renewcommand*{\FullNameCall}{Author Full Name}%
  \renewcommand*{\KWCall}{Keywords}%
  \renewcommand*{\RcvdCall}{Received}%
  \renewcommand*{\AppdCall}{Approved}%
  \renewcommand*{\CCLicCall}{Copyright}%
  \renewcommand*{\CCLicType}{%
    \ifbool{@CCLicNC}{\csuse{textendash}Non\-Com\-mer\-cial}{}%
    \ifbool{@CCLicND}{\csuse{textendash}No\-De\-riv\-a\-tives}{}%
    \ifbool{@CCLicSA}{\csuse{textendash}Share\-Alike}{}%
  }%
  \renewcommand*{\CCLicDescr}{%
    This article\ifcsvoid{@CCLicYear}{}{ \@CCLicYear}\ifcsvoid{@CCLicAuthor}{}{ by \@CCLicAuthor} is licensed under %
    \href{\CCLicURL}{Creative Commons Attribution{\CCLicType} 4.0 International \CCLicIcons}%
    \ifbool{@LayoutA}{}{%
      \ifboolexpr{ test {\ifcsvoid{@CCLicYear}} and test {\ifcsvoid{@CCLicAuthor}} }{, %
        which permits use and distribution in any medium or format, %
        provided that the original work is properly cited%
        \ifbool{@CCLicNC}{\ifboolexpr{ bool {@CCLicND} or bool {@CCLicSA} }{,}{ and} use is non-commercial}{}%
        \ifbool{@CCLicND}{\ifbool{@CCLicNC}{,}{} and no modification or adaptation is made}{}%
        \ifbool{@CCLicSA}{\ifbool{@CCLicNC}{,}{} and the modifications or adaptations are licensed under identical terms}{}%
      }{}%
    }.%
  }%
  \renewcommand*{\HdrWrng}{Insert Header\\(\LengthTo*{cm}{\HdrWidth}\,cm \texttimes\ \LengthTo*{cm}{\TopLine}\,cm)}%
  \renewcommand*{\LogoWrng}{Insert Logo}%
  \renewcommand*{\SDGStmpWrng}{Insert SDG Stamp}%
  \renewcommand*{\SrcCall}{Source}%
  \ifbool{@IndexOn}{%
    \renewcommand*{\seename}{see}%
    \renewcommand*{\seealso}{see also}%
  }{}%
  \renewcommand*{\TtlPgName}{Title Page}%
  \renewcommand*{\AcronymsListName}{List of Abbreviations and Initials}%
  \renewcommand*{\SymbolsListName}{List of Symbols}%
  \renewcommand*{\flowchartname}{Flowchart}%
  \renewcommand*{\photographname}{Photograph}%
  \renewcommand*{\graphname}{Graph}%
  \renewcommand*{\tabframedname}{Frame}%
  \renewcommand*{\listfigurename}{List of Illustrations}%
  \Crefname{flowchart}{Flowchart}{Flowcharts}%
  \crefname{flowchart}{Flow.}{Flows.}%
  \Crefname{photograph}{Photograph}{Photographs}%
  \crefname{photograph}{Phot.}{Phots.}%
  \Crefname{graph}{Graph}{Graphs}%
  \crefname{graph}{Graph}{Graphs}%
  \Crefname{tabframed}{Frame}{Frames}%
  \crefname{tabframed}{Frame}{Frames}%
  \Crefname{annex}{Annex}{Annexes}%
  \crefname{annex}{Annex}{Annexes}%
  \forcsvlist{\SectAutoRefName}{section, subsection, subsubsection, paragraph, subparagraph}%
}

%% Definições de comandos
\newcommand*{\MakeIcon}[2][\faQuestionCircle]{%
  \ifdraft{%
    \ifblank{#1}{\faQuestionCircle}{#1}%
  }{%
    \ifblank{#2}{}{\raisebox{-0.275ex}{\XeTeXLinkBox{\includegraphics[height = \f@size\p@]{#2}}}}%
  }%
}
\ifcsvoid{faOrcid}{%
  \newcommand*{\faOrcid}{\MakeIcon{orcid}}%
}{%
  \csletcs{old@faOrcid}{faOrcid}%
  \renewcommand*{\faOrcid}{{\color{ORCIDGreen}\old@faOrcid}}%
}
\newcommand*{\HRef}[2]{\ifblank{#1}{}{\href{#1}{\ifblank{#2}{#1}{#2}}}}
\newcommand*{\ORCIDURL}{https://orcid.org/}
\newcommand*{\ORCIDFull}[1]{\HRef{\ORCIDURL#1}{\ifbool{@AffilIconOn}{\faOrcid~}{}\ORCIDURL#1}}
\newcommand*{\ORCIDShort}[1]{\HRef{\ORCIDURL#1}{\ifbool{@AffilIconOn}{\faOrcid~}{\ORCIDURL}#1}}
\newcommand*{\ORCIDIcon}[1]{\HRef{\ORCIDURL#1}{\,\faOrcid}}
\providecommand*{\faLattes}{\MakeIcon{lattes}}
\newcommand*{\LattesURL}{http://lattes.cnpq.br/}
\newcommand*{\LattesFull}[1]{\HRef{\LattesURL#1}{\ifbool{@AffilIconOn}{\faLattes~}{}\LattesURL#1}}
\newcommand*{\LattesShort}[1]{\HRef{\LattesURL#1}{\ifbool{@AffilIconOn}{\faLattes~}{\LattesURL}#1}}
\newcommand*{\LattesIcon}[1]{\HRef{\LattesURL#1}{\,\faLattes}}
\newcommand*{\email}[1]{\ifblank{#1}{}{\href{mailto:#1}{\ifbool{@AffilIconOn}{\faEnvelope~}{}#1}}}
\newcommand*{\emailIcon}[1]{\ifblank{#1}{}{\href{mailto:#1}{\,\faEnvelope}}}
\newcommand*{\Affil}[1]{\ifblank{#1}{}{\ifbool{@AffilIconOn}{\faUniversity~}{}#1}}
\newcommand*{\@DOIName}{}
\newcommand*{\DOIName}[1]{\ifblank{#1}{}{\renewcommand*{\@DOIName}{#1}}}
\newcommand*{\@CCLicYear}{}
\newcommand*{\@CCLicAuthor}{}
\newcommand*{\CCLicenseAttribution}[2]{%
  \ifblank{#1}{}{\renewcommand*{\@CCLicYear}{\faCopyright[regular] #1}}%
  \ifblank{#2}{}{\renewcommand*{\@CCLicAuthor}{#2}}%
}
\newcommand*{\CCLicAcr}[1]{%
  \ifbool{@CCLicNC}{#1nc}{}%
  \ifbool{@CCLicND}{#1nd}{}%
  \ifbool{@CCLicSA}{#1sa}{}%
}
\newcommand*{\CCLicIcons}{%
  \faCreativeCommons\,\faCreativeCommonsBy%
  \ifbool{@CCLicNC}{\,\faCreativeCommonsNc}{}%
  \ifbool{@CCLicND}{\,\faCreativeCommonsNd}{}%
  \ifbool{@CCLicSA}{\,\faCreativeCommonsSa}{}%
}
\newcommand*{\CCLicURL}{https://creativecommons.org/licenses/by\CCLicAcr{-}/4.0/}
\newcommand*{\LinkIcon}{\textsuperscript{\fontsize{1.2ex}{1.2ex}\selectfont\faExternalLinkSquare*}}
\newcommand*{\SourceOrNote}[2][\SrcCall:]{%
  \ifblank{#2}{}{%
    \begingroup%
    \ifblank{#1}{\boolfalse{@SourceCenter}}{}%
    \ifbool{@SourceCenter}{}{%
      \captionsetup{%
        format          = hang,%
        justification   = justified,%
        singlelinecheck = false,%
      }%
    }%
    \caption*{\ifblank{#1}{}{#1 }#2}%
    \endgroup%
  }%
}
\newcommand*{\SDGStmpA}{}
\newcommand*{\SDGStmpB}{}
\newcommand*{\SDGStmpC}{}
\newcommand*{\SDGStamps}[3]{%
  \ifblank{#1}{}{\renewcommand*{\SDGStmpA}{#1}}%
  \ifblank{#2}{}{\renewcommand*{\SDGStmpB}{#2}}%
  \ifblank{#3}{}{\renewcommand*{\SDGStmpC}{#3}}%
}
\newcommand*{\s@LengthTo}[2]{\strip@pt\dimexpr\ifdimless{#2}{\z@}{-#2}{#2}*65536/\dimexpr1#1\relax}
\newcommand*{\@LengthTo}[2]{\strip@pt\dimexpr#2*65536/\dimexpr1#1\relax}
\newcommand*{\LengthTo}{\@ifstar{\s@LengthTo}{\@LengthTo}}
%%%% Evento
\dimdef{\HdrWidth}{\paperwidth}
\dimdef{\HdrSkip}{\z@}
\newbool{@RepeatHdr}
\newsavebox{\HdrFtrRuleBox}
\savebox{\HdrFtrRuleBox}{{\color{EmphColor}\hskip\HdrSkip\rule{\HdrWidth}{0.5\p@}}}
\define@key{Event}{Name}{\ifblank{#1}{}{\csdef{EvntName}{#1}}}
\define@key{Event}{Acronym}{\ifblank{#1}{}{\csdef{EvntAcr}{#1}}}
\define@key{Event}{Date}{\ifblank{#1}{}{\csdef{EvntDate}{#1}}}
\define@key{Event}{Local}{\ifblank{#1}{}{\csdef{EvntLocal}{#1}}}
\define@key{Event}{Logo}{\ifblank{#1}{}{\csdef{EvntLogo}{#1}}}
\define@key{Event}{Header}{\ifblank{#1}{}{\csdef{EvntHdr}{#1}}}
\define@key{Event}{HdrWidth}{%
  \ifblank{#1}{}{%
    \ifboolexpr{ test {\ifstrequal{#1}{paper}} or test {\ifstrequal{#1}{text}}}{%
      \dimdef{\HdrWidth}{\csuse{#1width}}%
      \dimdef{\HdrSkip}{\ifdimequal{\HdrWidth}{\textwidth}{\oddsidemargin+1in}{\z@}}%
      \savebox{\HdrFtrRuleBox}{{\color{EmphColor}\hskip\HdrSkip\rule{\HdrWidth}{0.5\p@}}}%
    }{}%
  }%
}
\define@key{Event}{URL}{\ifblank{#1}{}{\csdef{EvntURL}{#1}}}
\csletcs{KV@Event@name}{KV@Event@Name}
\csletcs{KV@Event@acronym}{KV@Event@Acronym}
\csletcs{KV@Event@date}{KV@Event@Date}
\csletcs{KV@Event@local}{KV@Event@Local}
\csletcs{KV@Event@logo}{KV@Event@Logo}
\csletcs{KV@Event@header}{KV@Event@Header}
\csletcs{KV@Event@hdrwidth}{KV@Event@HdrWidth}
\csletcs{KV@Event@url}{KV@Event@URL}
\NewDocumentCommand{\EventInfo}{ s m }{%
  \ifblank{#2}{}{%
    \IfBooleanTF{#1}{\booltrue{@RepeatHdr}}{\boolfalse{@RepeatHdr}}%
    \setkeys{Event}{%
      Name     = {},%
      Acronym  = {},%
      Date     = {},%
      Local    = {},%
      Logo     = {},%
      Header   = {},%
      HdrWidth = {},%
      URL      = {},%
      #2,%
    }%
    \ifcsvoid{EvntName}{%
      \csundef{EvntAcr}%
      \csundef{EvntDate}%
      \csundef{EvntLocal}%
      \csundef{EvntLogo}%
      \csundef{EvntHdr}%
      \csundef{EvntURL}%
    }{}%
  }%
}
%%%% Instituição
\define@key{Institution}{Campus}{\ifblank{#1}{}{\csdef{InstCmps}{#1}}}
\define@key{Institution}{Department}{\ifblank{#1}{}{\csdef{InstDept}{#1}}}
\define@key{Institution}{DeptLogo}{\ifblank{#1}{}{\csdef{InstDeptLogo}{#1}}}
\csletcs{KV@Institution@campus}{KV@Institution@Campus}
\csletcs{KV@Institution@department}{KV@Institution@Department}
\csletcs{KV@Institution@deptlogo}{KV@Institution@DeptLogo}
\NewDocumentCommand{\InstitutionInfo}{ s m }{%
  \ifblank{#2}{}{%
    \IfBooleanTF{#1}{\booltrue{@RepeatHdr}}{\boolfalse{@RepeatHdr}}%
    \setkeys{Institution}{%
      Campus     = {},%
      Department = {},%
      DeptLogo   = {},%
      #2,%
    }%
    \ifcsvoid{InstCmps}{%
      \csundef{InstDept}%
      \csundef{InstDeptLogo}%
    }{}%
  }%
}
%%%% Título
\csletcs{Short@Title}{@Title}
\newcommand*{\Title}[3][\@Title]{%
  \ifblank{#1}{}{\csdef{Short@Title}{#1}}%
  \ifblank{#2}{}{%
    \csdef{@Title}{#2}%
    \csappto{extrasbrazilian}{\csdef{@Title}{#2}}%
  }%
  \ifblank{#3}{}{\csappto{extrasenglish}{\csdef{@Title}{#3}}}%
}
\Title{%
  \ifbool{@LayoutA}{%
    O título deve conter até 70 caracteres sem espaço, não deve conter caracteres especiais ou símbolos. %
    Utilizar caixa baixa como neste exemplo e letra maiúscula somente quando necessário%
  }{%
    O título do trabalho deve ser em caixa baixa e conter até duas linhas sem ponto final%
  }%
}{%
  \ifbool{@LayoutA}{%
    Title in english, follow the same format as the title in portuguese%
  }{%
    The title of the work must be in lower case and contain up to two lines without a period%
  }%
}
%%%% Data(s)
\newcommand*{\YearNum}{\number\year}
\newcommand*{\RcvdDate}{}
\newcommand*{\AppdDate}{}
\newcommand*{\Dates}[3][]{%
  \ifblank{#1}{\renewcommand*{\YearNum}{}}{\renewcommand*{\YearNum}{#1}}%
  \ifblank{#2}{\renewcommand*{\RcvdDate}{}}{\renewcommand*{\RcvdDate}{#2}}%
  \ifblank{#3}{\renewcommand*{\AppdDate}{}}{\renewcommand*{\AppdDate}{#3}}%
}
\csletcs{Date}{date}
\AtBeginDocument{\Date{\AppdDate}}
%%%% Autor(es) e Palavras-chave
\newcommand{\MakeList}[4][]{%
  \ifboolexpr{ test {\ifcsundef{the#3Ctr}} or test {\ifcsundef{the#3Num}} or test {\ifcsundef{the#3Tmp}} }{}{%
    \setcounter{#3Tmp}{\ifnumgreater{\value{#3Num}}{#2}{#2}{\value{#3Num}}}%
    \@whilenum\value{#3Ctr}<\value{#3Tmp}\do{%
      \stepcounter{#3Ctr}%
      \ifblank{#1}{}{\csdef{#1}{#3\Alph{#3Ctr}}}%
      #4%
    }%
    \ifblank{#1}{}{\csundef{#1}}%
    \setcounter{#3Ctr}{0}%
    \setcounter{#3Tmp}{0}%
  }%
}
\newcommand*{\Attrib@Num@Ex}[3][1]{%
  \ifboolexpr{ test {\ifcsundef{the#2Ctr}} or test {\ifcsundef{the#2Num}} }{}{%
    \setcounter{#2Num}{\ifblank{#1}{1}{#1}}%
    \@whilenum\value{#2Ctr}<\value{#2Num}\do{%
      \stepcounter{#2Ctr}%
      #3%
    }%
    \setcounter{#2Ctr}{0}%
  }%
}
%%%%%% Autor(es)
\newcounter{AuthCtr}
\newcounter{AuthNum}
\newcounter{AuthTmp}
\define@key{Author}{Name}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}Name}{#1}}}}
\define@key{Author}{Email}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}Email}{#1}}}}
\define@key{Author}{Lattes}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}Lattes}{#1}}}}
\define@key{Author}{ORCID}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}ORCID}{#1}}}}
\define@key{Author}{Affiliation}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}Affil}{#1}}}}
\define@key{Author}{Role}{\ifcsvoid{ATag}{}{\ifblank{#1}{}{\csdef{\csuse{ATag}Role}{#1}}}}
\csletcs{KV@Author@name}{KV@Author@Name}
\csletcs{KV@Author@email}{KV@Author@Email}
\csletcs{KV@Author@lattes}{KV@Author@Lattes}
\csletcs{KV@Author@orcid}{KV@Author@ORCID}
\csletcs{KV@Author@affiliation}{KV@Author@Affiliation}
\csletcs{KV@Author@role}{KV@Author@Role}
\newcommand*{\Author}[2]{%
  \ifboolexpr{ test {\ifcsundef{theAuthNum}} or test {\ifcsundef{theAuthTmp}} }{}{%
    \ifblank{#2}{}{%
      \setcounter{AuthTmp}{#1}%
      \csdef{ATag}{Auth\Alph{AuthTmp}}%
      \setkeys{Author}{%
        Name        = {},%
        Email       = {},%
        Lattes      = {},%
        ORCID       = {},%
        Affiliation = {},%
        Role        = {},%
        #2,%
      }%
      \ifnumless{\value{AuthNum}}{\value{AuthTmp}}{\setcounter{AuthNum}{\value{AuthTmp}}}{}%
      \setcounter{AuthTmp}{0}%
      \csundef{ATag}%
    }%
  }%
}
\newcommand*{\Authors}[1]{\ifblank{#1}{}{\csdef{Short@Authors}{#1}}}
\newcommand*{\AuthorsNumber}[1][1]{%
  \Attrib@Num@Ex[#1]{Auth}{%
    \Author{\value{AuthCtr}}{%
      Name        = {\FullNameCall-A\arabic{AuthCtr}},%
      Email       = {author\arabic{AuthCtr}@domain},%
      Affiliation = {\UTFPRName, \CityCall, Paraná, \BRName},%
    }%
  }%
}
\AuthorsNumber%
%%%%%% Palavras-chave
\newcounter{KWCtr}
\newcounter{KWNum}
\newcounter{KWTmp}
\newcommand*{\KWCallFrmt}{\bfseries\MakeUppercase}
\newcommand*{\KeywordsCallFormat}[1]{\renewcommand*{\KWCallFrmt}{\ifblank{#1}{}{#1}}}
\newcommand*{\Keyword}[3]{%
  \ifboolexpr{ test {\ifcsundef{theKWNum}} or test {\ifcsundef{theKWTmp}} }{}{%
    \setcounter{KWTmp}{#1}%
    \csdef{KW\Alph{KWTmp}}{}%
    \cseappto{extrasbrazilian}{\csdef{KW\Alph{KWTmp}}{}}%
    \cseappto{extrasenglish}{\csdef{KW\Alph{KWTmp}}{}}%
    \ifblank{#2}{}{%
      \csdef{KW\Alph{KWTmp}}{#2}%
      \cseappto{extrasbrazilian}{\csdef{KW\Alph{KWTmp}}{#2}}%
    }%
    \ifblank{#3}{}{%
      \cseappto{extrasenglish}{\csdef{KW\Alph{KWTmp}}{#3}}%
    }%
    \ifnumless{\value{KWNum}}{\value{KWTmp}}{\setcounter{KWNum}{\value{KWTmp}}}{}%
    \setcounter{KWTmp}{0}%
  }%
}
\newcommand*{\KeywordsList}[3][]{%
  \MakeList{5}{KW}{%
    \ifcsvoid{KW\Alph{KWCtr}}{}{%
      {#1{\csuse{KW\Alph{KWCtr}}}}%
      \ifnumless{\value{KWCtr}}{\value{KWTmp}}{#2}{#3}%
    }%
  }%
}
\newcommand*{\KeywordsNumber}[1][3]{%
  \Attrib@Num@Ex[#1]{KW}{%
    \Keyword{\value{KWCtr}}{palavra-chave \arabic{KWCtr}}{keyword \arabic{KWCtr}}%
  }%
}
\KeywordsNumber%

%% Texto
\geometry{%
  top          = 35mm,%
  left         = \ifbool{@LayoutA}{10mm}{25mm},%
  right        = \ifbool{@LayoutA}{20mm}{25mm},%
  bottom       = 25mm,%
  head         = 25mm,%
  headsep      = 5mm,%
  footskip     = 5mm,%
  marginpar    = 15mm,%
  marginparsep = 2.5mm,%
}
\setlength{\parindent}{\ifbool{@LayoutA}{7mm}{12.5mm}}
\setlength{\parskip}{\ifbool{@LayoutA}{6\p@\@plus\p@}{\z@\@plus\p@}}
\newcommand*{\IfStringInList}[2]{\IfSubStr{,#2,}{,#1,}}
\newcommand*{\Add@Period}[1]{\ifblank{#1}{}{#1\@addpunct{.}}}
\newcommand*{\LessSloppy}{%
  \setlength{\emergencystretch}{3em}%
  \hbadness\@M%
}
\csgappto{Centering}{%
  \sloppy%
  \hbadness\@M%
  \hyphenpenalty\@M%
  \exhyphenpenalty\@M%
}
\newrobustcmd*{\ENLangIt}[1]{\foreignlanguage{english}{\textit{#1}}}
\newrobustcmd*{\ENLangNoIt}[1]{\foreignlanguage{english}{#1}}
\newrobustcmd*{\ENLang}{\@ifstar{\ENLangIt}{\ENLangNoIt}}
\csletcs{old@selectlanguage}{selectlanguage}
\renewcommand*{\selectlanguage}[1]{\IfStringInList{#1}{\bbl@loaded}{\old@selectlanguage{#1}}{}}
\AtBeginDocument{\frenchspacing}
\ifboolexpr{ bool {XeTeX} or test {\ifdraft} }{\LessSloppy}{}

%% Cabeçalhos e rodapés
\newcounter{StmpCtr}
\newlength{\TopLine}
\newlength{\BottomLine}
\setlength{\TopLine}{-\topmargin-\headheight-1in}
\setlength{\BottomLine}{\paperheight-\textheight-\topmargin-\headheight-\headsep-\footskip-1in}
\AddToShipoutPictureFG{%
  \normalcolor\normalfont%
  \ifcsvoid{EvntHdr}{}{%
    \ifnumless{\value{page}}{\ifbool{@RepeatHdr}{\@M}{2}}{%
      \AtPageUpperLeft{%
        \raisebox{-\height}{%
          \hskip\HdrSkip%
          \ifcsstring{EvntHdr}{example-image}{%
            \setlength{\fboxsep}{\z@}%
            \setkeys{draftfigure}{content = {\faFileImage{\\}\HdrWrng}, size = {tiny}}%
            \colorbox{gray!25!white}{\includegraphics[width = \HdrWidth, height = 30mm, draft]{\EvntHdr}}%
          }{%
            \includegraphics[width = \HdrWidth, height = 30mm]{\EvntHdr}%
          }%
        }%
      }%
    }{}%
  }%
  \ifbool{@RuleHeader}{\AtPageUpperLeft{\raisebox{\TopLine}{\usebox{\HdrFtrRuleBox}}}}{}%
  \ifbool{@RuleFooter}{\AtPageLowerLeft{\raisebox{\BottomLine}{\usebox{\HdrFtrRuleBox}}}}{}%
}
\newcommand*{\PrintEventOrInstitutionHeader}{%
  \ifcsvoid{EvntName}{%
    \begin{minipage}[t]{\textwidth}%
    \begin{minipage}[b][15mm][c]{35mm}%
    \raggedright%
    \includegraphics[height = 12mm]{utfpr}%
    \end{minipage}%
    \ifcsvoid{InstDeptLogo}{{\color{UTFPRBlack}\vrule\@width0.5\p@}\hskip6\p@}{\ifbool{@LayoutA}{\hfill}{}}%
    \begin{minipage}[b][15mm][c]{\textwidth-70mm}%
    \ifcsvoid{InstDeptLogo}{}{\centering}\IXptFS\sffamily%
    \MECName\vskip-\p@%
    {\bfseries\UTFPRName}\vskip-\p@%
    Campus \ifcsvoid{InstCmps}{\CityCall}{\InstCmps}\vskip-\p@%
    {\ifcsvoid{InstDeptLogo}{}{\bfseries}\ifcsvoid{InstDept}{\InstDeptEx}{\InstDept}}%
    \end{minipage}%
    \ifcsvoid{InstDeptLogo}{}{%
      \ifbool{@LayoutA}{\hfill}{}%
      \begin{minipage}[b][15mm][c]{35mm}%
      \raggedleft%
      \ifcsstring{InstDeptLogo}{example-image}{%
        \setlength{\fboxsep}{\z@}%
        \setkeys{draftfigure}{content = {\faFileImage{\\}\LogoWrng}, size = {tiny}}%
        \colorbox{gray!25!white}{\includegraphics[width = 32.2mm, height = 12mm, draft]{example-image}}%
      }{%
        \includegraphics[height = 12mm]{\InstDeptLogo}%
      }%
      \end{minipage}%
    }%
    \vskip2\p@%
    {\color{UTFPRBlack}\hrule\@height0.5\p@}\vskip\p@%
    {\color{UTFPRYellow}\hrule\@height0.5\p@}%
    \end{minipage}%
  }{%
    \makebox[\z@][l]{\PrintEventLogo}%
    \begin{minipage}[b]{\textwidth}%
    \ifbool{@LayoutA}{\color{EmphColor}}{\color{gray}}\raggedleft\IXptFS\EvntName%
    \ifcsvoid{EvntDate}{}{{\\}\EvntDate}%
    \ifcsvoid{EvntLocal}{}{{\\}\EvntLocal}%
    \end{minipage}%
  }%
  \vskip\z@\VIIptFS\strut%
}
\newcommand*{\PrintEventLogo}{%
  \ifcsvoid{EvntLogo}{}{%
    \ifcsstring{EvntLogo}{example-image}{%
      \setlength{\fboxsep}{\z@}%
      \setkeys{draftfigure}{content = {\faFileImage{\\}\LogoWrng}, size = {tiny}}%
      \colorbox{gray!25!white}{\includegraphics[width = 30mm, height = 15mm, draft]{\EvntLogo}}%
    }{%
      \includegraphics[height = 15mm]{\EvntLogo}%
    }%
  }%
}
\newcommand*{\PrintSDGStamps}[1][0.125\BottomLine]{%
  \@whilenum\value{StmpCtr}<3\do{%
    \stepcounter{StmpCtr}%
    \ifcsvoid{SDGStmp\Alph{StmpCtr}}{}{%
      \ifcsstring{SDGStmp\Alph{StmpCtr}}{example-image}{%
        \begingroup%
        \setlength{\fboxsep}{\z@}%
        \setkeys{draftfigure}{content = {\faFileImage{\\}\SDGStmpWrng{\\}\arabic{StmpCtr}}, size = {tiny}}%
        \csdef{SDGStmpX}{\csuse{SDGStmp\Alph{StmpCtr}}-\alph{StmpCtr}}%
        \colorbox{gray!25!white}{\includegraphics[width = 0.75\BottomLine, height = 0.75\BottomLine, draft]{\SDGStmpX}}%
        \csundef{SDGStmpX}%
        \endgroup%
      }{%
        \includegraphics[width = 0.75\BottomLine, height = 0.75\BottomLine]{\csuse{SDGStmp\Alph{StmpCtr}}}%
      }%
      \hskip#1%
    }%
  }%
  \setcounter{StmpCtr}{0}%
}
\renewcommand*{\headrule}{}
\fancypagestyle{TitlePage}{%
  \fancyhf{}%
  \fancyhead[L]{\PrintEventOrInstitutionHeader}%
  \fancyfoot[L]{%
    \vskip2\p@%
    \begin{minipage}[b]{\textwidth}%
    \ifbool{@LayoutA}{%
      \VIIptFS\raisebox{\baselineskip}{\parbox[t]{0.5\linewidth}{\vskip\z@\PrintSDGStamps}}%
      \ifbool{@PageNumOn}{\hfill\color{EmphColor}\pagename\ \textbar\ \thepage}{}%
    }{%
      \color{gray}\hypersetup{allcolors = {\ifcsvoid{@LinkColor}{}{LinkColor!50!}gray}}%
      \ifbool{@DocLicCC}{%
        \vskip6\p@%
        \IXptFS\sffamily\CCLicDescr%
      }{%
        \IXptFS\ifcsvoid{EvntURL}{}{\url{\EvntURL}}\ifbool{@PageNumOn}{\hfill\thepage}{}%
      }%
    }%
    \end{minipage}%
  }%
}
\fancypagestyle{plain}{}
\fancyhf{}
\fancyhead[L]{%
  \ifbool{@RepeatHdr}{%
    \PrintEventOrInstitutionHeader%
  }{%
    \begin{minipage}[b]{\textwidth}%
    \ifbool{@LayoutA}{\color{EmphColor}\VIIptFS}{\color{gray}\IXptFS}%
    \Short@Title{\\}\ifcsvoid{Short@Authors}{\PDF@Authors}{\Short@Authors}%
    \end{minipage}%
    \vskip\z@\VIIptFS\strut%
  }%
}
\fancyfoot[L]{%
  \vskip2\p@%
  \begin{minipage}[b]{\textwidth}%
  \ifbool{@LayoutA}{%
    \color{EmphColor}\hypersetup{allcolors = {\ifcsvoid{@LinkColor}{}{LinkColor!50!}EmphColor}}%
    \VIIptFS\ifcsvoid{EvntURL}{}{\url{\EvntURL}}\ifbool{@PageNumOn}{\hfill\pagename\ \textbar\ \thepage}{}%
  }{%
    \color{gray}\hypersetup{allcolors = {\ifcsvoid{@LinkColor}{}{LinkColor!50!}gray}}%
    \IXptFS\ifcsvoid{EvntURL}{}{\url{\EvntURL}}\ifbool{@PageNumOn}{\hfill\thepage}{}%
  }%
  \end{minipage}%
}
\pagestyle{fancy}

%% Seções
\setcounter{secnumdepth}{\ifbool{@SectNumOn}{5}{0}}
\gluedef{\BSSkip}{-12\p@\@plus-4\p@\@minus-4\p@}
\gluedef{\ASSkip}{\ifbool{@LayoutA}{6\p@\@plus2\p@\@minus2\p@}{12\p@\@plus4\p@\@minus4\p@}}
\crefalias{paragraph}{section}
\crefalias{subparagraph}{section}
\RenewDocumentCommand{\section}{ s O{#3} m O{} }{%
  \IfBooleanTF{#1}{%
    \@startsection{section}{1}%
      {\z@}{-\BSSkip}{\ASSkip}%
      {\UnnumSectCenter\color{EmphColor}\bfseries}%
      *{\MakeUppercase{#3}}%
    \renewcommand*{\@currentlabelname}{#3}%
    \ifblank{#4}{}{%
      \label{#4}%
      \addcontentsline{toc}{section}{\numberlinespace#3}%
    }%
  }{%
    \@startsection{section}{1}%
      {\z@}{-\BSSkip}{\ASSkip}%
      {\color{EmphColor}\bfseries}%
      [#2]{\MakeUppercase{#3}}%
  }%
}
\ifbool{@SectNumOn}{%
  \renewcommand*{\subsection}{\@startsection{subsection}{2}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}\bfseries}}%
  \renewcommand*{\subsubsection}{\@startsection{subsubsection}{3}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}\bfseries}}%
  \renewcommand*{\paragraph}{\@startsection{paragraph}{4}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}\bfseries}}%
  \renewcommand*{\subparagraph}{\@startsection{subparagraph}{5}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}\bfseries}}%
}{%
  \RenewDocumentCommand{\subsection}{ s O{#3} m }{%
    \IfBooleanTF{#1}{%
      \@startsection{subsection}{2}%
        {\z@}{-\BSSkip}{\ASSkip}%
        {\color{EmphColor}}%
        *{\MakeUppercase{#3}}%
      \renewcommand*{\@currentlabelname}{#3}%
    }{%
      \@startsection{subsection}{2}%
        {\z@}{-\BSSkip}{\ASSkip}%
        {\color{EmphColor}}%
        [#2]{\MakeUppercase{#3}}%
    }%
  }%
  \renewcommand*{\subsubsection}{\@startsection{subsubsection}{3}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}}}%
  \renewcommand*{\paragraph}{\@startsection{paragraph}{4}{\z@}{-\BSSkip}{\ASSkip}{\color{EmphColor}}}%
  \renewcommand*{\subparagraph}{\@startsection{subparagraph}{5}{-\parindent}{-\BSSkip}{\ASSkip}{\color{EmphColor}\emph}}%
}
\NewDocumentEnvironment{InfoSection}{ m O{} }{%
  \bigskip%
  \ifblank{#2}{}{%
    \pdfbookmark[1]{#1}{#2}%
    \hypertarget{#2}{}%
    \csgdef{#2ref}{\hyperlink{#2}{#1}}%
  }%
  \noindent%
  \begin{minipage}{\textwidth}%
  \setlength{\parindent}{\ifbool{@LayoutA}{7mm}{12.5mm}}%
  \noindent{\color{EmphColor}\bfseries#1}%
  \vskip\ASSkip%
  \ignorespaces%
}{%
  \end{minipage}%
  \ignorespacesafterend%
}

%% Listas de itens
\AtBeginEnvironment{itemize}{\LessSloppy}
\AtBeginEnvironment{enumerate}{\LessSloppy}
\setlist{%
  topsep     = \z@,%
  partopsep  = \z@,%
  parsep     = \z@,%
  itemsep    = \z@,%
  leftmargin = *,%
  align      = left,%
}
\setlist[1]{labelindent = \parindent}
\newcommand*{\alphsect}{\alph*^^29}
\renewcommand*{\@listI}{%
  \leftmargin\leftmargini%
  \topsep\z@%
  \parsep\z@%
  \itemsep\z@%
}

%% Notas de rodapé
\setlength{\footnotemargin}{1em}
\csletcs{old@footnotetext}{@footnotetext}
\renewcommand*{\@footnotetext}[1]{\old@footnotetext{\Add@Period{\LessSloppy#1}}}
\renewcommand*{\footnoterule}{\kern-3\p@\hrule\@width50mm\kern2.5\p@}
\renewcommand*{\@makefntext}[1]{%
  \setlength{\hangindent}{1em}%
  \makebox[1em][l]{\@makefnmark}\Add@Period{\LessSloppy#1}%
}
\csletcs{old@makefntext}{@makefntext}
\cspreto{@thanks}{\csletcs{@makefntext}{old@makefntext}}
\csletcs{old@footnote}{footnote}
\newcommand*{\ufootnote}[2][\faExclamationTriangle]{%
  \begingroup%
  \csletcs{@makefnmark}{relax}%
  \renewcommand*{\thefootnote}{\ifblank{#1}{}{#1}}%
  \renewcommand*{\@makefntext}[1]{%
    \setlength{\hangindent}{1em}%
    \makebox[1em][l]{\ifcsvoid{thefootnote}{}{\textsuperscript{\thefootnote}}}\Add@Period{\LessSloppy#2}%
  }%
  {\old@footnote{#2}}%
  \addtocounter{footnote}{-1}%
  \endgroup%
}

%% Citações diretas: curtas e longas
\dimdef{\CitLeftSkip}{40mm}
\NewDocumentCommand{\Citation}{ O{\languagename} m m O{} }{%
  \IfStringInList{#1}{\bbl@loaded}{\csdef{@CitLang}{#1}}{\csdef{@CitLang}{\languagename}}%
  \hyphenblockquote{\@CitLang}[%
    \ignorespaces\ifblank{#2}{}{#2}\ifblank{#4}{}{\footnote{#4}}\unskip%
  ]{%
    \ignorespaces\ifcsstring{languagename}{#1}{#3}{\textit{#3}}\unskip%
  }%
}
\NewDocumentEnvironment{DisplayCitation}{ O{\languagename} m O{} }{%
  \IfStringInList{#1}{\bbl@loaded}{\csdef{@CitLang}{#1}}{\csdef{@CitLang}{\languagename}}%
  \begin{hyphendisplayquote}{\@CitLang}[%
    \ifblank{#2}{}{\ignorespaces#2\unskip}%
    \ifblank{#3}{}{\footnote{\ignorespaces#3\unskip}}\@addpunct{.}%
  ]%
  \begingroup%
  \ifcsstring{languagename}{#1}{}{\itshape}%
}{%
  \endgroup%
  \end{hyphendisplayquote}%
}
\newenvironment*{DisplayCitationBlock}{%
  \vskip\parskip%
  \linespread{1.0}%
  \list{}{\setlength{\leftmargin}{\z@}}%
  \item%
  \LessSloppy%
  \ifbool{@twocolumn}{%
    \addtolength{\leftskip}{0.25\linewidth}%
  }{%
    \addtolength{\leftskip}{\CitLeftSkip}%
  }%
  \ifcsstring{@ptsize}{2}{\footnotesize}{\small}%
}{%
  \endlist%
}
\renewcommand*{\mkcitation}[1]{\ifblank{#1}{}{ #1}}
\SetBlockThreshold{\ifbool{@LayoutA}{2}{3}}
\SetBlockEnvironment{DisplayCitationBlock}

%% Equações
\ifbool{@fleqn}{\setlength{\mathindent}{\ifbool{@LayoutA}{5mm}{7.5mm}}}{}
\csletcs{math@up}{mathrm}
\AtBeginDocument{%
  \csxdef{rm@default}{\rmdefault}%
  \ifcsequal{f@family}{rm@default}{%
    \csletcs{math@up@fm}{mathrm}%
  }{%
    \csletcs{math@up@fm}{mathsf}%
  }%
}
\newrobustcmd*{\Unit}[2][]{%
  \ifbool{mmode}{%
    \math@up{\ifblank{#1}{}{#1\,}#2}%
  }{%
    \ensuremath{\math@up@fm{\ifblank{#1}{}{#1\,}#2}}%
  }%
}
\newrobustcmd*{\MathBF}[1]{%
  \ifboolexpr{ bool {LuaTeX} or bool {XeTeX} }{%
    \begingroup%
    \ifcsequal{f@family}{rm@default}{%
      \csletcs{math@up@fm}{symbfup}%
    }{%
      \csletcs{math@up@fm}{symbfsf}%
    }%
    \ifbool{mmode}{\symbf{#1}}{{\csletcs{math@up}{math@up@fm}\ensuremath{\symbf{#1}}}}%
    \endgroup%
  }{%
    \ifbool{mmode}{\text{\boldmath\ensuremath{#1}}}{{\csletcs{math@up}{math@up@fm}\boldmath\ensuremath{#1}}}%
  }%
}
\newrobustcmd*{\Degree}[1][]{\ifbool{mmode}{\text{\textdegree}}{\textdegree}\ifblank{#1}{}{#1}}
\ExplSyntaxOn%
\ProvideExpandableDocumentCommand{\inteval}{ m }{\int_eval:n {#1}}
\ProvideExpandableDocumentCommand{\fpeval}{ m }{\fp_eval:n {#1}}
\cs_new:Npn \point_to_comma:n #1
  {
    \exp_args:Ne \tl_to_str:n
      { \str_map_function:nN {#1} \__point_to_comma:n }
  }
\cs_new:Npn \__point_to_comma:n #1
  {
    \int_compare:nNnTF { `#1 } = { `. }
      { , }                                   %% CHKTEX 26
      { #1 }
  }
\cs_generate_variant:Nn \point_to_comma:n {e}
\cs_set_eq:NN \pointtocomma \point_to_comma:e %% CHKTEX 1
\cs_set_eq:NN \origfpeval \fp_eval:n          %% CHKTEX 1
\RenewExpandableDocumentCommand{\fpeval}{ s m }{%
  \IfBooleanTF{#1}{%
    \origfpeval{#2}%
  }{%
    \IfLanguageName{brazilian}{%
      \pointtocomma{\origfpeval{#2}}%
    }{%
      \origfpeval{#2}%
    }%
  }%
}
\ExplSyntaxOff%

%% Objetos flutuantes: figuras, tabelas, etc.
\graphicspath{{./Headers/}{./Illustrations/}{./Logos/}{./SGDStamps/}}
\arrayrulecolor{EmphColor}
\setlength{\textfloatsep}{12\p@\@plus4\p@\@minus4\p@}
\setlength{\intextsep}{12\p@\@plus4\p@\@minus4\p@}
\setlength{\floatsep}{12\p@\@plus4\p@\@minus4\p@}
\setlength{\aboverulesep}{\z@}
\setlength{\belowrulesep}{\z@}
\setlength{\extrarowheight}{0.25ex}
\setlength{\arrayrulewidth}{\lightrulewidth}
\newcolumntype{?}[1]{!{\color{EmphColor}\vrule\@width\ifblank{#1}{\heavyrulewidth}{#1}}}
\newcolumntype{e}[1]{@{\extracolsep{\ifblank{#1}{\fill}{#1}}}}
\newcolumntype{Y}{>{\centering\arraybackslash}X}
\newcolumntype{Z}{>{\raggedleft\arraybackslash}X}
\DeclareFloatingEnvironment[fileext = low, name = \flowchartname]{flowchart}
\DeclareFloatingEnvironment[fileext = lop, name = \photographname]{photograph}
\DeclareFloatingEnvironment[fileext = loh, name = \graphname]{graph}
\DeclareFloatingEnvironment[fileext = lod, name = \tabframedname]{tabframed}
\newcommand*{\Flt@Fmt}[1]{%
  \RenewDocumentEnvironment{#1}{ O{} O{\linewidth} }{%
    \csuse{@float}{#1}[##1]%
    \ifbool{@LayoutA}{\begin{addmargin}[50mm]{0mm}}{}%
    \ifblank{##2}{}{\setlength{\CaptionWidth}{##2}}%
    \centering%
    \begin{minipage}{\CaptionWidth}%
    \centering\ifcsstring{@ptsize}{2}{\footnotesize}{\small}%
  }{%
    \end{minipage}%
    \ifbool{@LayoutA}{\end{addmargin}}{}%
    \csuse{end@float}%
  }%
}
\forcsvlist{\Flt@Fmt}{figure, flowchart, photograph, graph, tabframed, table}
%%%% Legendas
\newlength{\CaptionWidth}
\setlength{\CaptionWidth}{\linewidth}
\newcommand*{\CaptionStyle}{}
\newcommand*{\BoldCaption}{%
  \renewcommand*{\CaptionStyle}{\bfseries}%
  \captionsetup{font+ = bf}%
}
\newcommand*{\SetCaptionWidth}[1]{%
  \ifblank{#1}{}{%
    \setlength{\CaptionWidth}{#1}%
    \captionsetup{width = \CaptionWidth}%
  }%
}
\captionsetup{%
  labelsep      = endash,%
  justification = centerlast,%
  font          = small,%
  skip          = 2\p@,%
}
\ifbool{@CaptionCenter}{}{%
  \captionsetup{%
    format          = hang,%
    justification   = justified,%
    singlelinecheck = false,%
  }%
}
\ifcsstring{@ptsize}{2}{\captionsetup{font = footnotesize}}{}

%% Citações e referências
\setlength{\bibitemsep}{12\p@\@plus4\p@\@minus4\p@}%% ABNT NBR 6023:2018
\DeclareLanguageMapping{brazilian}{brazilian-abnt}
\DeclareLanguageMapping{english}{english-abnt}
\DeclareLanguageMappingSuffix{}
\NewBibliographyString{%
  apud,%% ABNT NBR 10520:2023
  sheettotal,%
  sheettotals,%
  sineloco,%
  sinenomine,%
}
\DefineBibliographyStrings{brazilian}{%
  apud        = {\textit{apud}},%% ABNT NBR 10520:2023
  sineloco    = {s\adddot~l\adddot},%
  sinenomine  = {s\adddot~n\adddot},%
}
\DefineBibliographyStrings{english}{%
  apud        = {\textit{apud}},%% ABNT NBR 10520:2023
  sheettotal  = {s\adddot},%
  sheettotals = {s\adddot},%
  sineloco    = {s\adddot~l\adddot},%
  sinenomine  = {s\adddot~n\adddot},%
}
\xpretofieldformat{pages}{\midsentence}{}{}
\xpatchbibmacro{in:}{%% ABNT NBR 6023:2018
  \bibstring{in}%
}{%
  \mkbibemph{\bibstring{in}}%
}{}{}
\xpatchbibmacro{name:andothers}{%% ABNT NBR 6023:2018
  \bibstring{andothers}%
}{%
  \mkbibemph{\bibstring{andothers}}%
}{}{}
\xpatchbibmacro{location}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
}{}{}
\xpatchbibmacro{venue}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
}{}{}
\xpatchbibmacro{publisher}{%% ABNT NBR 6023:2018
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\xpatchbibmacro{publisher+location+date}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
  \setunit{\addcolon\addnbspace}%
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
  \setunit{\addcolon\addnbspace}%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\xpatchbibmacro{publisher+location+issue+date}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
  \setunit{\addcolon\addnbspace}%
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
  \setunit{\addcolon\addnbspace}%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\ifbool{@ABNTCitNRB}{%
  \csletcs{multinamedelim}{multinamedelimorig}%
  \csletcs{finalnamedelim}{finalnamedelimorig}%
}{%
  \xpatchbibmacro{textcite}{%
    \ifnumequal{\value{textcitecount}}{\value{textcitetotal}-1}{%
      \finalnamedelim%
    }{%
      \multinamedelim%
    }%
  }{%
    \textcitedelim%
  }{}{}%
}
\ifbool{@ABNTCitNSB}{%
  \csletcs{mkbibparens}{mkbibbrackets}%
  \csletcs{bibopenparen}{bibopenbracket}%
  \csletcs{bibcloseparen}{bibclosebracket}%
  \DeclareFieldFormat{labelnumberwidth}{\mkbibbrackets{#1}}%
}{}
\DeclareFieldFormat{firstword}{%% ABNT NBR 10520:2023
  \iftoggle{sccite}{%
    \normalfont\textsc{\MakeLowercase{\FirstWord{#1}}}\space[\ldots]\isdot%
  }{%
    \normalfont\FirstWord{#1}\space[\ldots]\isdot%
  }%
}
\DeclareFieldFormat{doi}{%
  \ifbool{@DOIIconOn}{\MakeIcon{doi}\addnbspace}{}\mkbibacro{DOI}\addcolon\space%
  \ifhyperref{\href{https://doi.org/#1}{\nolinkurl{#1}}}{\nolinkurl{#1}}%
}
\DeclareFieldFormat{url}{%% ABNT NBR 6023:2018
  \ifbool{@URLIconOn}{\faExternalLinkSquare*\addnbspace\mkbibacro{URL}}{\bibstring{urlfrom}}\addcolon\space%
  \url{#1}%
}
\defbibheading{bibliography}[\refname]{%
  \section*{#1}%
  \label{sect:ref}%
}
\csappto{printbibliography}{\addcontentsline{toc}{section}{\numberlinespace\refname}}
\renewcommand*{\mkbibnamefamily}[1]{#1}%% ABNT NBR 10520:2023

%% Resumo
\newbool{@AbsTtlInLine}
\newlength{\AbstractMargin}
\setlength{\AbstractMargin}{\z@}
\newcommand*{\AbsCallFrmt}{\bfseries\MakeUppercase}
\NewDocumentCommand{\AbstractCallFormat}{ s m }{%
  \IfBooleanTF{#1}{\booltrue{@AbsTtlInLine}}{\boolfalse{@AbsTtlInLine}}%
  \renewcommand*{\AbsCallFrmt}{\ifblank{#2}{}{#2}}%
}
\newcommand*{\AbstractText}[2]{%
  \ifblank{#1}{}{%
    \csgdef{AbstrText}{#1}%
    \csgappto{extrasbrazilian}{\csgdef{AbstrText}{#1}}%
  }%
  \ifblank{#2}{}{\csgappto{extrasenglish}{\csgdef{AbstrText}{#2}}}%
}
\NewDocumentEnvironment{Abstract}{ O{} b }{%
  \ifblank{#1}{%
    \IfLanguageName{brazilian}{%
      \csgdef{AbstrBody}{#2}%
      \AbstractText{\AbstrBody}{}%
    }{}%
    \IfLanguageName{english}{%
      \csgdef{FrgnAbstrBody}{#2}%
      \AbstractText{}{\FrgnAbstrBody}%
    }{}%
  }{%
    \ifstrequal{#1}{brazilian}{%
      \csgdef{AbstrBody}{#2}%
      \AbstractText{\AbstrBody}{}%
    }{}%
    \ifstrequal{#1}{english}{%
      \csgdef{FrgnAbstrBody}{#2}%
      \AbstractText{}{\FrgnAbstrBody}%
    }{}%
  }%
}{}
\AbstractText{\lipsum[1]}{\lipsum[2]}

%% Página de Título
\newtoggle{@BRLang}
\newtoggle{@ENLang}
\ifpatchable*{\and}{%
  \xpatchcmd{\and}{%
    \hskip 1em \@plus.17fil%
  }{%
    \hskip\z@\@plus0fil%
  }{}{}%
}{}
\csletcs{old@thanks}{thanks}
\renewcommand*{\thanks}[1]{\begingroup\csletcs{rlap}{relax}\old@thanks{#1}\endgroup}
%%%% Leiaute A
\newcommand*{\@maketitleA}{%
  \pdfbookmark[1]{\TtlPgName}{ttlpg}%
  \thispagestyle{TitlePage}%
  \begingroup%
  \raggedleft%
  \parbox{130mm}{\raggedleft\VIIptFS\ifcsvoid{EvntURL}{\null}{\url{\EvntURL}}}\vskip10\p@%
  \begin{minipage}{130mm}%
  \IfLanguageName{brazilian}{\selectlanguage{brazilian}}{\selectlanguage{english}}%
  \raggedright\XVptFS\bfseries\@Title%
  \end{minipage}%
  \vskip10\p@%
  \ifboolexpr{ togl {@BRLang} and togl {@ENLang} }{%
    \begin{minipage}{130mm}%
    \IfLanguageName{brazilian}{\selectlanguage{english}}{\selectlanguage{brazilian}}%
    \raggedright\XVptFS\bfseries\@Title%
    \end{minipage}%
    \vskip10\p@%
  }{}%
  \begin{minipage}[t][\z@][t]{45mm}%
  \vskip20\p@%
  \raggedright\VIIptFS\sffamily%
  \MakeList[ATag]{8}{Auth}{%
    \ifcsvoid{\csuse{ATag}Name}{}{%
      {\bfseries\csuse{\csuse{ATag}Name}}%
      \ifcsvoid{\csuse{ATag}Email}{}{\par\email{\csuse{\csuse{ATag}Email}}}%
      \ifcsvoid{\csuse{ATag}Lattes}{}{\par\LattesShort{\csuse{\csuse{ATag}Lattes}}}%
      \ifcsvoid{\csuse{ATag}ORCID}{}{\par\ORCIDShort{\csuse{\csuse{ATag}ORCID}}}%
      \ifcsvoid{\csuse{ATag}Affil}{}{\par\Affil{\csuse{\csuse{ATag}Affil}}}%
      \ifnumless{\value{AuthCtr}}{\value{AuthTmp}}{\vskip5\p@}{\vskip10\p@}%
    }%
  }%
  \ifcsvoid{@DOIName}{}{%
    \ifbool{@AffilIconOn}{}{{\color{EmphColor}\bfseries DOI:}}%
    \href{https://www.doi.org/\@DOIName}{\ifbool{@AffilIconOn}{\MakeIcon{doi}}{}~\@DOIName}\par%
  }%
  \ifcsvoid{RcvdDate}{}{{\color{EmphColor}\bfseries\RcvdCall:} \RcvdDate.\par}%
  \ifcsvoid{AppdDate}{}{{\color{EmphColor}\bfseries\AppdCall:} \AppdDate.\par}%
  \ifbool{@DocLicCC}{\parbox[t]{45mm}{{\color{EmphColor}\bfseries\CCLicCall:} \CCLicDescr}}{}%
  \end{minipage}%
  \hfill%
  \begin{minipage}[t][\z@][t]{130mm}%
  \begin{minipage}[t]{\linewidth}%
  \IfLanguageName{brazilian}{\selectlanguage{brazilian}}{\selectlanguage{english}}%
  \ifbool{@AbsTtlInLine}{%
    \parbox[t]{\linewidth}{\small{\color{EmphColor}\AbsCallFrmt{\abstractname}:} \AbstrText}\vskip6\p@%
  }{%
    \parbox[t]{\linewidth}{\centering\color{EmphColor}\AbsCallFrmt{\abstractname}}\vskip10\p@%
    \parbox[t]{\linewidth}{\small\AbstrText}\vskip6\p@%
  }%
  \parbox[t]{\linewidth}{\small{\color{EmphColor}\KWCallFrmt{\KWCall}:} \KeywordsList{; }{.}}%
  \end{minipage}%
  \ifboolexpr{ togl {@BRLang} and togl {@ENLang} }{%
    \vskip10\p@%
    \begin{minipage}[t]{\linewidth}%
    \IfLanguageName{brazilian}{\selectlanguage{english}}{\selectlanguage{brazilian}}%
    \ifbool{@AbsTtlInLine}{%
      \parbox[t]{\linewidth}{\small{\color{EmphColor}\AbsCallFrmt{\abstractname}:} \AbstrText}\vskip6\p@%
    }{%
      \parbox[t]{\linewidth}{\centering\color{EmphColor}\AbsCallFrmt{\abstractname}}\vskip10\p@%
      \parbox[t]{\linewidth}{\small\AbstrText}\vskip6\p@%
    }%
    \parbox[t]{\linewidth}{\small{\color{EmphColor}\KWCallFrmt{\KWCall}:} \KeywordsList{; }{.}}%
    \end{minipage}%
  }{}%
  \end{minipage}%
  \endgroup%
  \clearpage%
}
%%%% Leiaute B
\newcommand*{\@maketitleB}{%
  \newpage%
  \pdfbookmark[1]{\TtlPgName}{ttlpg}%
  \begin{Center}%
  \csletcs{footnote}{thanks}%
  \begingroup%
  \IfLanguageName{brazilian}{\selectlanguage{brazilian}}{\selectlanguage{english}}%
  \large\bfseries\@title%
  \ifboolexpr{ test {\ifcsvoid{@DOIName}} and test {\ifcsvoid{RcvdDate}} and test {\ifcsvoid{AppdDate}} }{}{%
    \ufootnote[\faInfoCircle]{%
      \ifcsvoid{@DOIName}{}{%
        \ifbool{@AffilIconOn}{}{\textbf{DOI:} }%
        \href{https://www.doi.org/\@DOIName}{\ifbool{@AffilIconOn}{\MakeIcon{doi}~}{}\@DOIName}%
        \ifboolexpr{ test {\ifcsvoid{RcvdDate}} and test {\ifcsvoid{AppdDate}} }{}{. }%
      }%
      \ifcsvoid{RcvdDate}{}{\textbf{\RcvdCall:} \RcvdDate\ifcsvoid{AppdDate}{}{. }}%
      \ifcsvoid{AppdDate}{}{\textbf{\AppdCall:} \AppdDate}%
    }%
  }%
  \endgroup%
  \vskip\baselineskip%
  \ifboolexpr{ togl {@BRLang} and togl {@ENLang} }{%
    \begingroup%
    \IfLanguageName{brazilian}{\selectlanguage{english}}{\selectlanguage{brazilian}}%
    \large\bfseries\@title%
    \endgroup%
    \vskip\baselineskip%
  }{}%
  \begingroup%
  \normalsize%
  \setlength{\lineskip}{0.5em}%
  \begin{tabular}[t]{c}%
  \@author%
  \end{tabular}%
  \endgroup%
  \end{Center}%
  \begin{center}%
  \begin{minipage}[t]{\textwidth-2\AbstractMargin}%
  \IfLanguageName{brazilian}{\selectlanguage{brazilian}}{\selectlanguage{english}}%
  \footnotesize%
  \ifbool{@AbsTtlInLine}{%
    \parbox[t]{\linewidth}{{\color{EmphColor}\AbsCallFrmt{\abstractname}:} \AbstrText}\vskip5\p@%
  }{%
    \parbox[t]{\linewidth}{\centering\color{EmphColor}\AbsCallFrmt{\abstractname}}\vskip10\p@%
    \parbox[t]{\linewidth}{\AbstrText}\vskip5\p@%
  }%
  \parbox[t]{\linewidth}{\footnotesize{\color{EmphColor}\KWCallFrmt{\KWCall}:} \KeywordsList{; }{.}}%
  \end{minipage}%
  \ifboolexpr{ togl {@BRLang} and togl {@ENLang} }{%
    \vskip10\p@%
    \begin{minipage}[t]{\textwidth-2\AbstractMargin}%
    \IfLanguageName{brazilian}{\selectlanguage{english}}{\selectlanguage{brazilian}}%
    \footnotesize%
    \ifbool{@AbsTtlInLine}{%
      \parbox[t]{\linewidth}{{\color{EmphColor}\AbsCallFrmt{\abstractname}:} \AbstrText}\vskip5\p@%
    }{%
      \parbox[t]{\linewidth}{\centering\color{EmphColor}\AbsCallFrmt{\abstractname}}\vskip10\p@%
      \parbox[t]{\linewidth}{\AbstrText}\vskip5\p@%
    }%
    \parbox[t]{\linewidth}{\footnotesize{\color{EmphColor}\KWCallFrmt{\KWCall}:} \KeywordsList{; }{.}}%
    \end{minipage}%
  }{}%
  \end{center}%
}

%% Inicialização do documento
\AtBeginDocument{%
  \newrobustcmd*{\@Authors}{%
    \MakeList[ATag]{\ifbool{@LayoutA}{8}{16}}{Auth}{%
      \csuse{\csuse{ATag}Name}%
      \ifbool{@LayoutA}{}{%
        \ifcsvoid{\csuse{ATag}Affil}{}{%
          \thanks{%
            \ifcsvoid{\csuse{ATag}Role}{}{\faAddressCard~\csuse{\csuse{ATag}Role}.\ }%
            \Affil{\csuse{\csuse{ATag}Affil}}%
            \ifcsvoid{\csuse{ATag}Email}{}{.\ \email{\csuse{\csuse{ATag}Email}}}%
            \ifcsvoid{\csuse{ATag}Lattes}{}{.\ \LattesShort{\csuse{\csuse{ATag}Lattes}}}%
            \ifcsvoid{\csuse{ATag}ORCID}{}{.\ \ORCIDShort{\csuse{\csuse{ATag}ORCID}}}%
          }%
        }%
      }%
      \ifnumless{\value{AuthCtr}}{\value{AuthTmp}}{,\and}{}%
    }%
  }%
  \newrobustcmd*{\PDF@Authors}{}%
  \MakeList[ATag]{\ifbool{@LayoutA}{8}{16}}{Auth}{%
    \csxappto{PDF@Authors}{%
      \csuse{\csuse{ATag}Name}%
      \ifnumless{\value{AuthCtr}}{\value{AuthTmp}}{, }{}%
    }%
  }%
  \newrobustcmd*{\PDF@Keywords}{}%
  \MakeList{5}{KW}{%
    \csxappto{PDF@Keywords}{%
      \csuse{KW\Alph{KWCtr}}%
      \ifnumless{\value{KWCtr}}{\value{KWTmp}}{, }{}%
    }%
  }%
  \title{\@Title}%
  \author{\@Authors}%
  \hypersetup{%
    pdftitle    = {\@title},%
    pdfauthor   = {\PDF@Authors},%
    pdfsubject  = {\ifcsvoid{EvntAcr}{UTFPR \YearNum}{\EvntAcr}},%
    pdfkeywords = {\PDF@Keywords},%
  }%
  \IfStringInList{brazilian}{\bbl@loaded}{\toggletrue{@BRLang}}{\togglefalse{@BRLang}}%
  \IfStringInList{english}{\bbl@loaded}{\toggletrue{@ENLang}}{\togglefalse{@ENLang}}%
  \ifbool{@LayoutA}{%
    \csletcs{@maketitle}{@maketitleA}%
  }{%
    \csletcs{@maketitle}{@maketitleB}%
    \csgappto{maketitle}{\thispagestyle{TitlePage}}%
  }%
  \maketitle%
  \ifbool{@LayoutA}{\begin{addmargin}[50mm]{0mm}}{}%
}

%% Listas: ilustrações; tabelas
\csletcs{listfontsize}{relax}
\newcommand*{\L@Flt@Fmt}[1]{%
  \csdef{l@#1}{%
    \savebox0{\csuse{#1name}~\csuse{the#1}\space\textendash\space}%
    \renewcommand*{\numberline}[1]{\makebox[\wd0][l]{\csuse{#1name}~####1\hfill\textendash\hfill}}%
    \@dottedtocline{1}{\z@}{\wd0}%
  }%
  \AtBeginDocument{\addtocontents{\csuse{ext@#1}}{\setlength{\parskip}{\z@\@plus\p@}\listfontsize\CaptionStyle}}%
}
\forcsvlist{\L@Flt@Fmt}{figure, flowchart, photograph, graph, tabframed, table}
%%%% Lista de Ilustrações
\cspreto{listoffigures}{\pdfbookmark[1]{\listfigurename}{lof}}
\newcommand*{\@StartToC}[1]{\@starttoc{#1}}
\ifpatchable*{\listoffigures}{%
  \xpatchcmd{\listoffigures}{%
    \@starttoc{lof}%
  }{%
    \ifbool{@LayoutA}{\medskip}{}%
    \forcsvlist{\@StartToC}{lof, low, lop, loh, lod}%
  }{}{}%
}{}
%%%% Lista de Tabelas
\cspreto{listoftables}{\pdfbookmark[1]{\listtablename}{lot}}
\ifpatchable*{\listoftables}{%
  \xpatchcmd{\listoftables}{%
    \@starttoc{lot}%
  }{%
    \ifbool{@LayoutA}{\medskip}{}%
    \@starttoc{lot}%
  }{}{}%
}{}

%% Listas: abreviaturas e siglas; símbolos
\newcommand*{\AcronymsListLabelFont}[1]{\normalfont#1}
\newenvironment*{AcronymsList}[1][]{%
  \pdfbookmark[1]{\ifblank{#1}{\AcronymsListName}{#1}}{acr}%
  \section*{\ifblank{#1}{\AcronymsListName}{#1}}%
  \label{acr}%
  \begingroup%
  \listfontsize%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = multiline,%
    font          = \AcronymsListLabelFont,%
    leftmargin    = 0.125\linewidth,%
    listparindent = -\leftmargin,%
  ]%
}{%
  \end{description}%
  \endgroup%
}
\newcommand*{\SymbolsListLabelFont}[1]{\ensuremath{#1}}
\newenvironment*{SymbolsList}[1][]{%
  \pdfbookmark[1]{\ifblank{#1}{\SymbolsListName}{#1}}{sym}%
  \section*{\ifblank{#1}{\SymbolsListName}{#1}}%
  \label{sym}%
  \begingroup%
  \listfontsize%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = multiline,%
    font          = \SymbolsListLabelFont,%
    leftmargin    = 0.125\linewidth,%
    listparindent = -\leftmargin,%
  ]%
}{%
  \end{description}%
  \endgroup%
}

%% Sumário
\setcounter{tocdepth}{5}
\dimdef{\ToCNumWd}{%
  \ifnumequal{\c@tocdepth}{1}{1.5em}{}%
  \ifnumequal{\c@tocdepth}{2}{2.3em}{}%
  \ifnumequal{\c@tocdepth}{3}{3.2em}{}%
  \ifnumequal{\c@tocdepth}{4}{4.1em}{}%
  \ifnumequal{\c@tocdepth}{5}{5.0em}{}%
}
\csletcs{old@contentsline}{contentsline}
\newcommand*{\numberlinespace}{\ifnumgreater{\value{secnumdepth}}{0}{\texorpdfstring{\protect\numberline{}}{}}{}}
\newcommand*{\LoX@ToC@Style}[2]{%
  \ifboolexpr{%
    test {\ifcsequal{l@#1}{l@figure}}     or %
    test {\ifcsequal{l@#1}{l@flowchart}}  or %
    test {\ifcsequal{l@#1}{l@photograph}} or %
    test {\ifcsequal{l@#1}{l@graph}}      or %
    test {\ifcsequal{l@#1}{l@tabframed}}  or %
    test {\ifcsequal{l@#1}{l@table}}         %
  }{\CaptionStyle{#2}}{%
    \ifbool{@SectNumOn}{\bfseries#2}{%
      \ifcsequal{l@#1}{l@section}{\bfseries#2}{%
        \ifcsequal{l@#1}{l@subparagraph}{\textit{#2}}{#2}%
      }%
    }%
  }%
}
\renewcommand*{\contentsline}[3]{%
  \ifboolexpr{%
    test {\ifcsequal{l@#1}{l@section}}                                or %
    (test {\ifcsequal{l@#1}{l@subsection}} and not bool {@SectNumOn})    %
  }{%
    \expandafter\@firstoftwo%
  }{%
    \expandafter\@secondoftwo%
  }%
  {\old@contentsline{#1}{\LoX@ToC@Style{#1}{\MakeUppercase{#2}}}{\LoX@ToC@Style{#1}{#3}}}%
  {\old@contentsline{#1}{\LoX@ToC@Style{#1}{#2}}{\LoX@ToC@Style{#1}{#3}}}%
}
\renewcommand*{\l@section}{\@dottedtocline{1}{\z@}{\ToCNumWd}}
\renewcommand*{\l@subsection}{\@dottedtocline{2}{\z@}{\ToCNumWd}}
\renewcommand*{\l@subsubsection}{\@dottedtocline{3}{\z@}{\ToCNumWd}}
\renewcommand*{\l@paragraph}{\@dottedtocline{4}{\z@}{\ToCNumWd}}
\renewcommand*{\l@subparagraph}{\@dottedtocline{5}{\z@}{\ToCNumWd}}
\cspreto{tableofcontents}{\pdfbookmark[1]{\contentsname}{toc}}
\ifpatchable*{\tableofcontents}{%
  \xpatchcmd{\tableofcontents}{%
    \@starttoc{toc}%
  }{%
    \ifbool{@LayoutA}{\medskip}{}%
    \@starttoc{toc}%
  }{}{}%
}{}
\AtBeginDocument{\addtocontents{toc}{\setlength{\parskip}{\z@\@plus\p@}\listfontsize}}

%% Glossário
\newenvironment*{Glossary}[1][\normalfont]{%
  \csdef{GlossaryLabelFont}##1{#1{##1}:}%
  \phantomsection%
  \section*{\glossaryname}%
  \label{gly}%
  \addcontentsline{toc}{section}{\numberlinespace\MakeUppercase{\glossaryname}}%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = unboxed,%
    font          = \GlossaryLabelFont,%
    leftmargin    = \ifbool{@LayoutA}{7mm}{12.5mm},%
    listparindent = -\leftmargin,%
    labelsep      = 0.25em,%
  ]%
}{%
  \end{description}%
}

%% Apêndices e Anexos
\newcommand*{\annexname}{\Cref@annex@name}
\newcommand*{\apx@sect@fmt}[1]{%
  \csletcs{old@#1}{#1}%
  \csdef{apx@#1}##1{%
    \refstepcounter{#1}%
    \csuse{old@#1}*{\ApxOrAnxName\ \csuse{the#1} \textemdash\ ##1}%
    \addcontentsline{toc}{#1}{\numberlinespace\ApxOrAnxName\ \csuse{the#1} \textemdash\ ##1}%
  }%
}
\forcsvlist{\apx@sect@fmt}{section, subsection, subsubsection, paragraph, subparagraph}
\newcommand*{\let@apx@sect}[1]{\csletcs{#1}{apx@#1}}
\newcommand*{\crefalias@sect}[1]{\crefalias{#1}{\Hy@appendixstring}}
\newcommand*{\Hy@param@chk}[1]{\ifcsstring{Hy@param}{#1}{\csletcs{Hy@param}{Hy@appendixstring}}{}}
\newenvironment*{Appendix}[1][appendix]{%
  \appendix%
  \csgdef{ApxOrAnxName}{\csuse{Cref@#1@name}}%
  \csletcs{sectionautorefname}{Cref@#1@name}%
  \forcsvlist{\let@apx@sect}{section, subsection, subsubsection, paragraph, subparagraph}%
  \renewcommand*{\Hy@appendixstring}{#1}%
  \renewcommand*{\Hy@chapapp}{\Hy@appendixstring}%
  \forcsvlist{\crefalias@sect}{appendix, subappendix, subsubappendix, subsubsubappendix, paragraph, subparagraph}%
  \ifpatchable*{\hyper@makecurrent}{%
    \xpatchcmd{\hyper@makecurrent}{%
      \ifx\Hy@param\Hy@chapterstring\let\Hy@param\Hy@chapapp\fi%
    }{%
      \forcsvlist{\Hy@param@chk}{chapter, section, subsection, subsubsection, paragraph, subparagraph}%
    }{}{}%
  }{}%
  \phantomsection%
  \renewcommand*{\@currentlabelname}{\csuse{Cref@#1@name@plural}}%
  \label{sect:#1}%
}{}
\newenvironment*{Annex}{%
  \begin{Appendix}[annex]%
}{%
  \end{Appendix}%
}

%% Índice Remissivo
\ifbool{@IndexOn}{%
  \DeclareRobustCommand*{\GobbleComma}[1]{\@gobble{#1}}%
  \renewcommand*{\see}[2]{\ifblank{#1}{}{\textbf{\seename} #1}}%
  \renewcommand*{\seealso}[2]{\ifblank{#1}{}{\textbf{\alsoname} #1}}%
  \renewcommand*{\@idxitem}{\par\hangindent40\p@}%
  \renewcommand*{\subitem}{\@idxitem\nobreak\hskip15\p@}%
  \renewcommand*{\subsubitem}{\@idxitem\nobreak\hskip30\p@}%
  \renewenvironment{theindex}{%
    \section*{\indexname}%
    \begin{multicols}{2}%
    \raggedcolumns%
    \vfuzz\maxdimen%
    \parindent\z@%
    \parskip\z@\@plus0.3\p@\relax%
    \columnsep35\p@%
    \columnseprule\z@%
    \csletcs{item}{@idxitem}%
  }{%
    \end{multicols}%
  }%
  \cspreto{makeindex}{\IfFileExists{\jobname.idx}{\immediate\write18{makeindex -c -q \jobname.idx}}{}}%
  \cspreto{printindex}{%
    \phantomsection%
    \addcontentsline{toc}{section}{\numberlinespace\indexname}%
  }%
}{%
  \csletcs{makeindex}{relax}%
  \csletcs{printindex}{relax}%
}

%% Finalização do documento
\cspreto{enddocument}{\ifbool{@LayoutA}{\end{addmargin}}{}}
