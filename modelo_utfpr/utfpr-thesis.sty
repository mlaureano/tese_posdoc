%%%% utfpr-thesis.sty, 2025/08/03 v2.2
%%%% Copyright (C) 2021-2025 Luiz E. M. Lima (luizeduardomlima@gmail.com)
%%
%% This work may be distributed and/or modified under the conditions of the
%% LaTeX Project Public License, either version 1.3 of this license or (at your
%% option) any later version.
%% The latest version of this license is in
%%   https://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX version
%% 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `maintained'.
%%
%% The Current Maintainer of this work is Luiz E. M. Lima.
%%
%% This work consists of all files listed in readme.html.
%%
%% A brief description of this work is in readme.txt.

%% Identificação e atualizações
\NeedsTeXFormat{LaTeX2e}[2005/12/01]
\ProvidesPackage{utfpr-thesis}[2025/08/03 v2.2 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2025/01/26 v2.1 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2024/10/05 v2.0 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2024/08/10 v1.9 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2024/02/10 v1.8 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2023/10/08 v1.7 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2023/06/27 v1.6 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2023/05/11 v1.5 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2023/03/10 v1.4 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2022/07/31 v1.3 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2021/09/20 v1.2 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2021/07/18 v1.1 utfpr-thesis package]
%%%% Alteração de alguns pacotes, comandos, formatações e tipografias.
% \ProvidesPackage{utfpr-thesis}[2021/02/10 v1.0 utfpr-thesis package]
%%%% Criação dos arquivos constituintes.

%% Opções do pacote (^ = padrão; ¹ = somente twoside; ² = somente openany)
\RequirePackage{xpatch}
\RequirePackage{xkeyval}
\@ifpackageloaded{xstring}{}{\RequirePackage{xstring}}
% \tracingpatches%
%%%% Versão de documento: Final (^), Defense ou Abstract
\newbool{@VersionFinal}
\newbool{@VersionAbstract}
\csletcs{EndDocumentVersionAbstract}{relax}
\DeclareOptionX{Version}[Final]{%
  \boolfalse{@VersionFinal}%
  \boolfalse{@VersionAbstract}%
  \ifstrequal{#1}{Final}{\booltrue{@VersionFinal}}{}%
  \ifstrequal{#1}{Defense}{%
    \boolfalse{@twoside}%
    \boolfalse{@mparswitch}%
    \ExecuteOptionsX{CoverBG = Off}%
  }{}%
  \ifstrequal{#1}{Abstract}{%
    \ExecuteOptionsX{Version = Defense}%
    \booltrue{@VersionAbstract}%
    \csletcs{EndDocumentVersionAbstract}{enddocument}%
  }{}%
}
%%%% Fonte principal: Arial (^), Calibri, Times ou LaTeX(*)
\newbool{@FontArial}
\newbool{@FontCalibri}
\newbool{@FontTimes}
\DeclareOptionX{Font}[Arial]{%
  \boolfalse{@FontArial}%
  \boolfalse{@FontCalibri}%
  \boolfalse{@FontTimes}%
  \ifstrequal{#1}{Arial}{\booltrue{@FontArial}}{}%
  \ifstrequal{#1}{Calibri}{\booltrue{@FontCalibri}}{}%
  \ifstrequal{#1}{Times}{%
    \booltrue{@FontTimes}%
    \csdef{rm@font}{ntxtlf}%
  }{}%
  \ifstrequal{#1}{LaTeX*}{\csdef{rm@font}{lmr}}{}%% Serif
}
%%%% Cor (HTML) hyperlink (azul escuro ^): nenhuma (cor texto)
\DeclareOptionX{LinkColor}[00008B]{\ifblank{#1}{\csdef{@LinkColor}{}}{\csdef{@LinkColor}{#1}}}
%%%% Planos de fundo (Capa e Contracapa): On ou Off (^)
\newbool{@CoverBGOn}
\DeclareOptionX{CoverBG}[Off]{\ifstrequal{#1}{On}{\booltrue{@CoverBGOn}}{\boolfalse{@CoverBGOn}}}
%%%% Dados de identificação (Capa): All ou Main (^)
\newbool{@CoverDataAll}
\DeclareOptionX{CoverData}[Main]{\ifstrequal{#1}{All}{\booltrue{@CoverDataAll}}{\boolfalse{@CoverDataAll}}}
%%%% Numeração de páginas (partes): All, Main (^) ou None
\newbool{@PageNumMain}
\newbool{@PageNumFront}
\DeclareOptionX{PageNum}[Main]{%
  \boolfalse{@PageNumMain}%
  \boolfalse{@PageNumFront}%
  \ifstrequal{#1}{All}{%
    \booltrue{@PageNumMain}%
    \booltrue{@PageNumFront}%
  }{}%
  \ifstrequal{#1}{Main}{\booltrue{@PageNumMain}}{}%
}
%%%% Frente e verso (partes) (¹): All, Main (^) ou None
\newbool{@TwoSideMain}
\newbool{@TwoSideFront}
\DeclareOptionX{TwoSide}[Main]{%
  \boolfalse{@TwoSideMain}%
  \boolfalse{@TwoSideFront}%
  \ifstrequal{#1}{All}{%
    \booltrue{@TwoSideMain}%
    \booltrue{@TwoSideFront}%
  }{}%
  \ifstrequal{#1}{Main}{\booltrue{@TwoSideMain}}{}%
}
%%%% Paginação de elementos (²): Odd ou Any (^)
\newbool{@OpenPageOdd}
\DeclareOptionX{OpenPage}[Any]{\ifstrequal{#1}{Odd}{\booltrue{@OpenPageOdd}}{\boolfalse{@OpenPageOdd}}}
%%%% Título (case) de apêndices e anexos: Lower ou Upper (^)
\newbool{@ApxAnxTtlLower}
\DeclareOptionX{ApxAnxTtl}[Upper]{\ifstrequal{#1}{Lower}{\booltrue{@ApxAnxTtlLower}}{\boolfalse{@ApxAnxTtlLower}}}
%%%% Alinhamento de legendas: Center (^) ou Left
\newbool{@CaptionCenter}
\DeclareOptionX{Caption}[Center]{\ifstrequal{#1}{Center}{\booltrue{@CaptionCenter}}{\boolfalse{@CaptionCenter}}}
%%%% Alinhamento de fontes (autoria): Center (^) ou Left
\newbool{@SourceCenter}
\DeclareOptionX{Source}[Center]{\ifstrequal{#1}{Center}{\booltrue{@SourceCenter}}{\boolfalse{@SourceCenter}}}
%%%% Citação ABNT: AAY (Nome, Ano) (^), NRB (1) ou NSB [1]
\newbool{@ABNTCitNRB}
\newbool{@ABNTCitNSB}
\DeclareOptionX{ABNTCit}[AAY]{%
  \boolfalse{@ABNTCitNRB}%
  \boolfalse{@ABNTCitNSB}%
  \ifstrequal{#1}{NRB}{\booltrue{@ABNTCitNRB}}{}%
  \ifstrequal{#1}{NSB}{%
    \booltrue{@ABNTCitNRB}%
    \booltrue{@ABNTCitNSB}%
  }{}%
}
%%%% Ícone de DOI em referências: On ou Off (^)
\newbool{@DOIIconOn}
\DeclareOptionX{DOIIcon}[Off]{\ifstrequal{#1}{On}{\booltrue{@DOIIconOn}}{\boolfalse{@DOIIconOn}}}
%%%% Ícone de URL em referências: On ou Off (^)
\newbool{@URLIconOn}
\DeclareOptionX{URLIcon}[Off]{\ifstrequal{#1}{On}{\booltrue{@URLIconOn}}{\boolfalse{@URLIconOn}}}
%%%% Aviso de indisponíveis, execução de padrões e processamento de atribuídas
\DeclareOptionX*{\PackageWarning{utfpr-thesis}{Unknown option `\CurrentOption'}}
\ExecuteOptionsX{%
  Version   = Final,%
  Font      = Arial,%
  LinkColor = 00008B,%
  CoverBG   = Off,%
  CoverData = Main,%
  PageNum   = Main,%
  TwoSide   = Main,%
  OpenPage  = Any,%
  ApxAnxTtl = Upper,%
  Caption   = Center,%
  Source    = Center,%
  ABNTCit   = AAY,%
  DOIIcon   = Off,%
  URLIcon   = Off,%
}
\ProcessOptionsX\relax%

%% Pacotes utilizados
\RequirePackage{ifdraft}
\RequirePackage{babel}
\RequirePackage{iflang}
\ifboolexpr{ bool {luatex} or bool {xetex} }{%
  \RequirePackage{fontspec}%
  \RequirePackage{amsmath}%
  \RequirePackage[bold-style = ISO]{unicode-math}%
  \defaultfontfeatures{Ligatures = TeX}%
  \ifboolexpr{ bool {@FontArial} or bool {@FontTimes} }{%
    \setmainfont{texgyretermes}[%
      UprightFont    = *-regular,%
      BoldFont       = *-bold,%
      ItalicFont     = *-italic,%
      BoldItalicFont = *-bolditalic,%
      Extension      = .otf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \setsansfont{texgyreheros}[%
      UprightFont    = *-regular,%
      BoldFont       = *-bold,%
      ItalicFont     = *-italic,%
      BoldItalicFont = *-bolditalic,%
      Extension      = .otf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \setmathfont{texgyretermes-math}[Extension = .otf]%% CHKTEX 26
    \setmathfont{texgyretermes-math}[Extension = .otf, version = bold]%% CHKTEX 26
  }{}%
  \ifbool{@FontCalibri}{%
    \setsansfont{Carlito}[%
      UprightFont    = *-Regular,%
      BoldFont       = *-Bold,%
      ItalicFont     = *-Italic,%
      BoldItalicFont = *-BoldItalic,%
      Extension      = .ttf,%% CHKTEX 26
      Scale          = 1.0,%
    ]%
    \ifbool{luatex}{\pdfvariable omitcidset = 1}{}%% CHKTEX 1
  }{}%
}{%
  \RequirePackage[utf8]{inputenc}%
  \RequirePackage[T1]{fontenc}%
  \@ifl@t@r\fmtversion{2023/02/11}{\pdfspacefont{texnansi-lmr1\@ptsize}}{}%
  \pdfinterwordspaceon%
  \ifboolexpr{ bool {@FontArial} or bool {@FontTimes} }{%
    \RequirePackage[scaled = 1.0, helvratio = 1.0]{newtxtext}%
    \RequirePackage[smallerops]{newtxmath}%
  }{%
    \RequirePackage{amsmath}%
    \@ifpackageloaded{amssymb}{}{\RequirePackage{amssymb}}%
    \RequirePackage{lmodern}%
    \RequirePackage{textcomp}%
  }%
  \ifbool{@FontCalibri}{\RequirePackage[sfdefault, lining, tabular]{carlito}}{}%
}
\RequirePackage{fontawesome5}
\RequirePackage{microtype}
\RequirePackage{ragged2e}
\RequirePackage{fvextra}
\RequirePackage{csquotes}
\RequirePackage{mfirstuc}
\RequirePackage[normalem]{ulem}
\ifbool{xetex}{}{\RequirePackage{transparent}}
\RequirePackage[table]{xcolor}
\RequirePackage[pass, \ifdraft{showframe}{}]{geometry}
\ifbool{luatex}{\RequirePackage{shellesc}}{\RequirePackage{morewrites}}
\RequirePackage{enumitem}
\RequirePackage{icomma}
\RequirePackage{algorithmic}
\RequirePackage[content = {\faFileImage}, position = {center}]{draftfigure}
\RequirePackage{eso-pic}
\RequirePackage{graphicx}
\RequirePackage{longtable}
\RequirePackage[%
  style        = abnt\ifbool{@ABNTCitNRB}{-numeric}{},%
  natbib       = true,%
  sorting      = \ifbool{@ABNTCitNRB}{none}{nty},%
  uniquename   = minfull,%
  uniquelist   = \ifbool{@ABNTCitNRB}{false}{minyear},%
  extradate    = true,%
  repeatfields = true,%
  \ifbool{@ABNTCitNRB}{comp = true,}{}%
]{biblatex}
\RequirePackage[hyphens]{xurl}
\@ifl@t@r\fmtversion{2023/06/01}{%
  \@ifclasslater{memoir}{2023/08/08}{}{%
    \RequirePackage{silence}%
    \WarningFilter*{nameref}{The definition of \string\label\space has changed!}%
  }%
}{}
\RequirePackage[depth = 4, numbered = true, \ifdraft{draft = true}{}]{bookmark}
\RequirePackage[capitalise, nameinlink]{cleveref}

%% Configurações do pacote microtype
\@ifpackagelater{microtype}{2021/10/31}{\microtypesetup{nopatch = footnote}}{}
\@ifpackagelater{microtype}{2023/03/06}{%
  \csdef{MT@prot@check@C}{%
    \ifcsequal{MT@prot@l}{MT@prot@l@tc}{%
      \csdef{MT@temp}*{\MT@exp@one@n\MT@prot@l{\the\MT@toks}}%
    }{%
      \csletcs{MT@prot@l}{MT@prot@l@tc}%
      \csdef{MT@temp}*##1{%
        \the\MT@toks%
        \MT@toks{}%
        \@testopt{\MT@prot@check@C@##1}{}%
      }%
    }%
  }%
  \csdef{MT@prot@check@C@}#1[#2]#3{%
    \MT@ifempty{#2}{%
      \cslet{MT@maybe@textcmd}#1%
      \MT@prot@toks{#1{#3}}%
    }{%
      \csdef{MT@maybe@textcmd}{#1[#2]}%
      \MT@prot@toks{#1[#2]{#3}}%
    }%
    \MT@prot@get@firstgroup@tc#3\MT@nil%
  }%
  \ifpatchable*{\MT@prot@check@cmds}{%
    \xpatchcmd{\MT@prot@check@cmds}{{F\MakeUppercase}{F\MakeLowercase}}{{C\MakeUppercase}{C\MakeLowercase}}{}{}%
    \xpatchcmd{\MT@prot@check@cmds}{{F\MakeTitlecase}}{{C\MakeTitlecase}}{}{}%
  }{}%
}{}

%% Fontes
\ifcsvoid{rm@font}{\renewcommand*{\familydefault}{\sfdefault}}{}
\csletcs{old@ttfamily}{ttfamily}
\renewrobustcmd*{\ttfamily}{\old@ttfamily\hyphenchar\font=`\-\relax}
\csletcs{Old@TeX}{TeX}
\csletcs{Old@LaTeX}{LaTeX}
\AtBeginDocument{%
  \renewrobustcmd*{\TeX}{{\fontfamily{lmr}\selectfont\protect\Old@TeX}}%
  \renewrobustcmd*{\LaTeX}{{\fontfamily{lmr}\selectfont\Old@LaTeX}}%
}
\newrobustcmd*{\UTFPR}{UTF{\miniscule\kern-0.1em\hbox{PR}}}
\newrobustcmd*{\No}{N\IfLanguageName{brazilian}{.\textsuperscript{o}}{o.}}
\DeclareFontEncoding{LS1}{}{}
\DeclareFontSubstitution{LS1}{stix2}{m}{n}
\DeclareFontFamily{LS1}{stix2scr}{\skewchar\font127 }
\DeclareFontShape{LS1}{stix2scr}{m}{n}{<->s*[1.2] stix2-mathscr}{}
\DeclareFontShape{LS1}{stix2scr}{b}{n}{<->s*[1.2] stix2-mathscr-bold}{}
\DeclareFontShape{LS1}{stix2scr}{bx}{n}{<->ssub * stix2scr/b/n}{}
\newrobustcmd*{\DottedCircle}{\text{\usefont{LS1}{stix2scr}{m}{n}\symbol{\string"E3}}}%% CHKTEX 18

%% Cores
\definecolor{UTFPRBlack}{RGB}{0, 0, 0}
\definecolor{UTFPRYellow}{RGB}{255, 204, 0}
\definecolor{UTFPRBeige}{RGB}{148, 141, 106}
\definecolor{UTFPRLightBeige}{RGB}{205, 193, 145}
\definecolor{UTFPRLightBlack}{RGB}{35, 31, 32}
\definecolor{ORCIDGreen}{RGB}{166, 206, 57}
\definecolor{shadecolor}{gray}{0.9}
\ifcsvoid{@LinkColor}{%
  \colorlet{LinkColor}{.}%
}{%
  \definecolor{LinkColor}{HTML}{\@LinkColor}%
}
\colorlet{HyRefColor}{\ifcsvoid{@LinkColor}{}{LinkColor!50!}.}
\AtBeginDocument{\colorlet{CoverBGColor}{\ifbool{Graduate}{UTFPRLightBlack}{UTFPRBeige}}}
\newrobustcmd*{\ColorBox}[2]{\colorbox{#1}{\kern-\fboxsep#2\kern-\fboxsep}}

%% Hiperlinks e URLs
\hypersetup{%
  colorlinks         = true,%
  allcolors          = HyRefColor,%
  pdfdisplaydoctitle = true,%
  pdfencoding        = unicode,%
}
\pdfstringdefDisableCommands{%
  \csletcs{SecFmt}{@firstoftwo}%
  \csletcs{MakeTextUppercase}{@firstofone}%
  \csletcs{uline}{@firstofone}%
  \csletcs{unskip}{relax}%
  \renewcommand*{\UTFPR}{UTFPR}%
  \renewcommand*{\No}{N.}%
  \renewcommand*{\and}{, }%
  \renewcommand*{\\}{ }%
}
\newcommand*{\HyperTarget}[2]{\label{ht@#1}\hypertarget{#1}{#2}}
\newcommand*{\HyperLink}[2]{\ifcsdef{r@ht@#1}{\hyperlink{#1}{#2}}{#2}}
\newcommand*{\PDFBookmark}[3][chapter]{%
  \pdfbookmark[#1]{#2}{#3}%
  \HyperTarget{#3}{}%
  \csgdef{#3ref}{\HyperLink{#3}{#2}}%
}
\newcommand*{\SectionPDFBookmark}[3][chapter]{%
  \phantomsection%
  \PDFBookmark[#1]{#2}{#3}%
  \csuse{#1}*{#2}%
  \label{#3}%
}
\DeclareUrlCommand{\URL}{%
  \renewcommand*{\UrlFont}{\color{HyRefColor}\ttfamily}%
  \renewcommand*{\UrlLeft}{<}%
  \renewcommand*{\UrlRight}{>}%
}
\csgappto{UrlBreaks}{\UrlOrds}
\csgappto{UrlSpecials}{\do\_{\_\penalty\UrlBreakPenalty}}
\providecommand*{\@setCpagerefrange}[3]{\@@setcpagerefrange{#1}{#2}{Cref}{#3}}
\providecommand*{\@setcpagerefrange}[3]{\@@setcpagerefrange{#1}{#2}{cref}{#3}}
\providecommand*{\@setlabelcpagerefrange}[3]{\@@setcpagerefrange{#1}{#2}{labelcref}{#3}}

%% Variáveis dependentes do idioma
\AtBeginDocument{\frenchspacing}
\newcommand*{\IfStringInList}[2]{\IfSubStr{,#2,}{,#1,}}
\csletcs{old@selectlanguage}{selectlanguage}
\@ifl@t@r\fmtversion{2020/10/01}{%
  \renewcommand*{\selectlanguage}[1]{\IfStringInList{#1}{\bbl@loaded}{\old@selectlanguage{#1}}{}}%
}{%
  \renewcommand*{\selectlanguage}[1]{\IfStringInList{#1}{\bbl@loaded}{\expandafter\old@selectlanguage\expandafter{#1}}{}}%
}
\newrobustcmd*{\ENLangIt}[1]{\foreignlanguage{english}{\textit{#1}}}
\newrobustcmd*{\ENLangNoIt}[1]{\foreignlanguage{english}{#1}}
\newrobustcmd*{\ENLang}{\@ifstar{\ENLangIt}{\ENLangNoIt}}
\newcommand*{\AddToLang}[4][extras]{%
  \ifblank{#2}{}{%
    \ifblank{#3}{}{%
      \csdef{#2}{#3}%
      \csappto{#1brazilian}{\csdef{#2}{#3}}%
    }%
    \ifblank{#4}{}{\csappto{#1english}{\csdef{#2}{#4}}}%
  }%
}
\AddToLang{UTFPRName}{%
  Universidade Tecnológica Federal do Paraná%
}{%
  Federal University of Technology \textemdash\ Paraná%
}
\AddToLang{PgAbrv}{f}{p}
\AddToLang{InPrep}{em}{in}
%%%% Definições para atualização no preâmbulo
\newbool{Graduate}
\newbool{DScOrMSc}
\newcounter{AcadDegOpt}
\newcommand*{\AcademicDegree}[2]{\AddToLang{AcademicDegreeName}{#1}{#2}}
\newcommand*{\AcademicTitle}[2]{\AddToLang{AcademicTitleName}{#1}{#2}}
\newcommand*{\DocumentType}[2]{\AddToLang{DocumentTypeName}{#1}{#2}}
\newcommand*{\AcademicDegreeOption}[1][0]{%
  \setcounter{AcadDegOpt}{#1}%
  \AcademicDegree{Grau Acadêmico}{Academic Degree}%
  \AcademicTitle{Título Acadêmico}{Academic Title}%
  \DocumentType{Tipo de Documento}{Document Type}%
  \ifnumgreater{\value{AcadDegOpt}}{0}{%
    \ifnumless{\value{AcadDegOpt}}{4}{%
      \booltrue{Graduate}%
      \ifnumequal{\value{AcadDegOpt}}{1}{%
        \booltrue{DScOrMSc}%
        \AcademicDegree{Doutorado}{Doctorate}%
        \AcademicTitle{Doutor\Gen{a}}{Doctor}%
        \DocumentType{Tese}{Thesis}%
      }{}%
      \ifnumequal{\value{AcadDegOpt}}{2}{%
        \booltrue{DScOrMSc}%
        \AcademicDegree{Mestrado}{Master's Degree}%
        \AcademicTitle{Mestr\Gen[e]{a}}{Master}%
        \DocumentType{Dissertação}{Dissertation}%
      }{}%
      \ifnumequal{\value{AcadDegOpt}}{3}{%
        \AcademicDegree{Especialização}{Specialization Degree}%
        \AcademicTitle{Especialista}{Specialist}%
        \DocumentType{Monografia}{Monograph}%
      }{}%
    }{%
      \ifnumequal{\value{AcadDegOpt}}{4}{%
        \AcademicDegree{Bacharelado}{Bachelor's Degree}%
        \AcademicTitle{Bacharel\Gen{a}}{Bachelor}%
      }{}%
      \ifnumequal{\value{AcadDegOpt}}{5}{%
        \AcademicDegree{Licenciatura}{Teaching Degree}%
        \AcademicTitle{Licenciad\Gen[o]{a}}{Teacher}%
      }{}%
      \ifnumequal{\value{AcadDegOpt}}{6}{%
        \AcademicDegree{Tecnologia}{Technologist Degree}%
        \AcademicTitle{Tecnólog\Gen[o]{a}}{Technologist}%
      }{}%
      \DocumentType{Trabalho de Conclusão de Curso}{Undergraduate Thesis}%
    }%
  }{}%
}
\newcommand*{\AcadDegInCrs}{\AcademicDegreeName\space\InPrep\space\CourseName}
\newcommand*{\Course}[2]{\AddToLang{CourseName}{#1}{#2}}
\newcommand*{\Department}[2]{\AddToLang{DepartmentName}{#1}{#2}}
\newcommand*{\Title}[3][\bbl@main@language]{%
  \IfStringInList{#1}{\bbl@loaded}{\csxdef{@TtlLang}{#1}}{\csxdef{@TtlLang}{\bbl@main@language}}%
  \AddToLang{@Ttl}{#2}{#3}%
}
\newcommand*{\SubTitle}[2]{\AddToLang{@SubTtl}{#1}{#2}}
\AcademicDegreeOption%
\Course{Curso{(s)}}{Course{(s)}}
\Department{%
  Departamento{(s)}, Coordenação{(ões)} ou Programa%
}{%
  Department{(s)}, Coordination{(s)}, or Program%
}
\Title{%
  Título de trabalho acadêmico, claro e preciso, com texto muito longo que pode ocupar mais de uma linha%
}{%
  Title of academic work, clear and precise, with very long text that can take more than one line%
}

%% Definições de comandos
\AddToLang{SourceCall}{Fonte}{Source}
\newcommand*{\MakeIcon}[2][\faQuestionCircle]{%
  \ifdraft{%
    \ifblank{#1}{\faQuestionCircle}{#1}%
  }{%
    \ifblank{#2}{}{\raisebox{-0.275ex}{\XeTeXLinkBox{\includegraphics[height = \f@size\p@]{#2}}}}%
  }%
}
\ifcsvoid{faOrcid}{%
  \newcommand*{\faOrcid}{\MakeIcon{orcid}}%
}{%
  \csletcs{old@faOrcid}{faOrcid}%
  \renewcommand*{\faOrcid}{{\color{ORCIDGreen}\old@faOrcid}}%
}
\newcommand*{\ORCID}[1]{\ifblank{#1}{}{\href{https://orcid.org/#1}{\faOrcid}}}
\providecommand*{\faLattes}{\MakeIcon{lattes}}
\newcommand*{\Lattes}[1]{\ifblank{#1}{}{\href{http://lattes.cnpq.br/#1}{\faLattes}}}
\newcommand*{\email}[1]{\ifblank{#1}{}{\href{mailto:#1}{\faEnvelope}}}
\newcommand*{\LinkIcon}{\textsuperscript{\fontsize{1.2ex}{1.2ex}\selectfont\faExternalLinkSquare*}}
\NewDocumentCommand{\SourceOrNote}{ t{+} s O{\SourceCall} O{: } m }{%
  \M@gettitle{#5}%
  \memlegendinfo{#5}%
  \par%
  \begingroup%
  \IfBooleanT{#1}{\boolfalse{@SourceCenter}}%
  \ifbool{@SourceCenter}{%
    \captionstyle[\centering]{\centering}%
    \normalcaption%
  }{%
    \captionstyle[\justifying]{\justifying}%
    \hangcaption%
  }%
  \@parboxrestore%
  \ifbool{@minipage}{\@setminipage}{}%
  \footnotesize%
  \ifblank{#3}{\captiondelim{\mbox{}}}{\captiondelim{\ifblank{#4}{ }{#4}}}%
  \@makecaption{#3}{\ignorespaces\IfBooleanTF{#2}{\@AddPeriod{#5}}{#5}}\par%
  \endgroup%
}
\NewExpandableDocumentCommand{\LTSourceOrNote}{ t{+} s O{\SourceCall} O{: } m }{%
  \multicolumn{\LT@cols}{@{}>{\footnotesize\bfseries}p{\z@}@{}}{%
    \ifblank{#3}{\captiondelim{\mbox{}}}{\captiondelim{\ifblank{#4}{ }{#4}}}%
    \ifblank{#3}{\savebox0{\SourceCall\@contdelimm}}{\savebox0{#3\@contdelim}}%
    \IfBooleanT{#1}{\boolfalse{@SourceCenter}}%
    \ifbool{@SourceCenter}{%
      \hb@xt@\z@{\parbox[t]{\LTcapwidth}{\centering\usebox0\IfBooleanTF{#2}{\@AddPeriod{#5}}{#5}}\hss}%
    }{%
      \hb@xt@\z@{\parbox[t]{\LTcapwidth}{\justifying\hangindent\wd0\usebox0\IfBooleanTF{#2}{\@AddPeriod{#5}}{#5}}\hss}%
    }%
  }%
}
\newcommand*{\ThreeDigitsCounter}[1]{%
  \ifnumless{\value{#1}}{100}{0}{}%
  \ifnumless{\value{#1}}{10}{0}{}%
  \arabic{#1}%
}
%%%% Campus
\AddToLang{CityCall}{Cidade}{City}
\newcommand*{\CmpsName}{\CityCall}
\newcommand*{\CmpsAcr}{}
\newcommand*{\CmpsFile}{}
\newcommand*{\CmpsBGFile}{}
\newcommand*{\Campus}[1]{%
  \ifblank{#1}{}{%
    \renewcommand*{\CmpsName}{#1}%
    \ifstrequal{#1}{Apucarana}{\renewcommand*{\CmpsAcr}{ap}}{}%
    \ifstrequal{#1}{Campo Mourão}{\renewcommand*{\CmpsAcr}{cm}}{}%
    \ifstrequal{#1}{Cornélio Procópio}{\renewcommand*{\CmpsAcr}{cp}}{}%
    \ifstrequal{#1}{Curitiba}{\renewcommand*{\CmpsAcr}{ct}}{}%
    \ifstrequal{#1}{Dois Vizinhos}{\renewcommand*{\CmpsAcr}{dv}}{}%
    \ifstrequal{#1}{Francisco Beltrão}{\renewcommand*{\CmpsAcr}{fb}}{}%
    \ifstrequal{#1}{Guarapuava}{\renewcommand*{\CmpsAcr}{gp}}{}%
    \ifstrequal{#1}{Londrina}{\renewcommand*{\CmpsAcr}{ld}}{}%
    \ifstrequal{#1}{Medianeira}{\renewcommand*{\CmpsAcr}{md}}{}%
    \ifstrequal{#1}{Pato Branco}{\renewcommand*{\CmpsAcr}{pb}}{}%
    \ifstrequal{#1}{Ponta Grossa}{\renewcommand*{\CmpsAcr}{pg}}{}%
    \ifstrequal{#1}{Santa Helena}{\renewcommand*{\CmpsAcr}{sh}}{}%
    \ifstrequal{#1}{Toledo}{\renewcommand*{\CmpsAcr}{td}}{}%
    \renewcommand*{\CmpsFile}{utfpr-\CmpsAcr-\ifbool{Graduate}{d}{l}}%
    \renewcommand*{\CmpsBGFile}{\CmpsFile-bg}%
  }%
}
%%%% Data(s)
\newcommand*{\YearNum}{\number\year}
\newcommand*{\DepYearNum}{\YearNum}
\newcommand*{\Dates}[4][]{%
  \ifblank{#2}{}{\year=#2}%
  \ifblank{#3}{}{\month=#3}%
  \ifblank{#4}{}{\day=#4}%
  \renewcommand*{\YearNum}{\ifblank{#2}{\number\year}{#2}}
  \renewcommand*{\DepYearNum}{\ifblank{#1}{\YearNum}{#1}}%
}
\csletcs{old@date}{date}
\renewcommand*{\date}[1]{\AtBeginDocument{\old@date{#1}}}
\date{\today}
%%%% Aluno(s), Orientador(es), Membros da Banca Examinadora e Palavras-chave
\newbool{@Male}
\booltrue{@Male}
\AddToLang{FrnmCall}{Prenome{(s)}}{Forename{(s)}}
\AddToLang{SrnmCall}{Sobrenome}{Surname}
\define@key{Person}{Gender}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Gen}{\csuse{#1}}}}}
\define@key{Person}{Title}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Ttl}{#1}}}}
\define@key{Person}{Forename}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Frnm}{#1}}}}
\define@key{Person}{Surname}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Srnm}{#1}}}}
\define@key{Person}{Email}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Email}{\email{#1}}}}}
\define@key{Person}{Lattes}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}Lattes}{\Lattes{#1}}}}}
\define@key{Person}{ORCID}{\ifcsvoid{PTag}{}{\ifblank{#1}{}{\csgdef{\csuse{PTag}ORCID}{\ORCID{#1}}}}}
\csletcs{KV@Person@gender}{KV@Person@Gender}
\csletcs{KV@Person@title}{KV@Person@Title}
\csletcs{KV@Person@forename}{KV@Person@Forename}
\csletcs{KV@Person@surname}{KV@Person@Surname}
\csletcs{KV@Person@email}{KV@Person@Email}
\csletcs{KV@Person@lattes}{KV@Person@Lattes}
\csletcs{KV@Person@orcid}{KV@Person@ORCID}
\newcommand*{\Person}[3][]{%
  \ifboolexpr{ test {\ifcsundef{the#1Num}} or test {\ifcsundef{the#1Tmp}} }{}{%
    \checkifinteger{#2}%
    \ifbool{integer}{%
      \global\boolfalse{integer}%
      \ifblank{#3}{}{%
        \setcounter{#1Tmp}{#2}%
        \csgdef{PTag}{#1\Alph{#1Tmp}}%
        \setkeys{Person}{%
          Gender   = {},%
          Title    = {\AcademicTitleName},%
          Forename = {},%
          Surname  = {},%
          Email    = {},%
          Lattes   = {},%
          ORCID    = {},%
          #3,%
        }%
        \ifboolexpr{ test {\ifcsvoid{\csuse{PTag}Frnm}} and test {\ifcsvoid{\csuse{PTag}Srnm}} }{%
          \csgdef{\csuse{PTag}Gen}{}%
          \csgdef{\csuse{PTag}Ttl}{}%
          \csgdef{\csuse{PTag}Email}{}%
          \csgdef{\csuse{PTag}Lattes}{}%
          \csgdef{\csuse{PTag}ORCID}{}%
        }{%
          \csgpreto{\csuse{PTag}Ttl}{\csuse{\csuse{PTag}Gen}}%
          \csgdef{\csuse{PTag}FlNm}{%
            \ifcsvoid{\csuse{PTag}Frnm}{}{\csuse{\csuse{PTag}Frnm}}%
            \ifcsvoid{\csuse{PTag}Srnm}{}{ \csuse{\csuse{PTag}Srnm}}%
          }%
          \ifstrequal{#1}{Adv}{\csgdef{\csuse{PTag}Call}{\csuse{\csuse{PTag}Gen}\@AdvCall{#2}}}{}%
          \ifstrequal{#1}{Mmbr}{%
            \csgdef{\csuse{PTag}FlNm}{\csuse{\csuse{PTag}Frnm}}%
            \csgdef{\csuse{PTag}Inst}{\csuse{\csuse{PTag}Srnm}}%
          }{}%
        }%
        \ifnumless{\value{#1Num}}{\value{#1Tmp}}{\setcounter{#1Num}{\value{#1Tmp}}}{}%
        \setcounter{#1Tmp}{0}%
        \csgundef{PTag}%
      }%
    }{}%
  }%
}
\newcommand*{\MakeList}[4][]{%
  \ifboolexpr{ test {\ifcsundef{the#3Ctr}} or test {\ifcsundef{the#3Num}} or test {\ifcsundef{the#3Tmp}} }{}{%
    \setcounter{#3Tmp}{\ifnumgreater{\value{#3Num}}{#2}{#2}{\value{#3Num}}}%
    \@whilenum\value{#3Ctr}<\value{#3Tmp}\do{%
      \stepcounter{#3Ctr}%
      \ifblank{#1}{}{\csdef{#1}{#3\Alph{#3Ctr}}}%
      #4%
    }%
    \ifblank{#1}{}{\csundef{#1}}%
    \setcounter{#3Ctr}{0}%
    \setcounter{#3Tmp}{0}%
  }%
}
\newcommand*{\Attrib@Num@Ex}[3][1]{%
  \ifboolexpr{ test {\ifcsundef{the#2Ctr}} or test {\ifcsundef{the#2Num}} }{}{%
    \setcounter{#2Num}{\ifblank{#1}{1}{#1}}%
    \@whilenum\value{#2Ctr}<\value{#2Num}\do{%
      \stepcounter{#2Ctr}%
      #3%
    }%
    \setcounter{#2Ctr}{0}%
  }%
}
\newcommand*{\Gen}[2][]{\ifbool{@Male}{#1}{#2}}
\newcommand*{\Male}{\@bsphack\booltrue{@Male}\@esphack}
\newcommand*{\Female}{\@bsphack\boolfalse{@Male}\@esphack}
\csletcs{male}{Male}
\csletcs{female}{Female}
%%%%%% Aluno(s)
\newcounter{StdtCtr}
\newcounter{StdtNum}
\newcounter{StdtTmp}
\newcommand*{\Student}[2]{\Person[Stdt]{#1}{#2}}
\NewDocumentCommand{\StudentsList}{ s O{} m m }{%
  \MakeList[PTag]{5}{Stdt}{%
    \ifcsvoid{\csuse{PTag}FlNm}{}{%
      {#2{\csuse{\csuse{PTag}FlNm}}}%
      \IfBooleanT{#1}{%
        \rlap{%
          \ifcsvoid{\csuse{PTag}Email}{}{\,\csuse{\csuse{PTag}Email}}%
          \ifcsvoid{\csuse{PTag}Lattes}{}{\,\csuse{\csuse{PTag}Lattes}}%
          \ifcsvoid{\csuse{PTag}ORCID}{}{\,\csuse{\csuse{PTag}ORCID}}%
        }%
      }%
      \ifnumless{\value{StdtCtr}}{\value{StdtTmp}}{#3}{#4}%
    }%
  }%
}
\newcommand*{\ABNTStudentsList}{%
  \MakeList[PTag]{5}{Stdt}{%
    \ifboolexpr{ test {\ifcsvoid{\csuse{PTag}Frnm}} or test {\ifcsvoid{\csuse{PTag}Srnm}} }{}{%
      \MakeTextUppercase{\csuse{\csuse{PTag}Srnm}}, \csuse{\csuse{PTag}Frnm}%
      \ifnumless{\value{StdtCtr}}{\value{StdtTmp}}{; }{.}%
    }%
  }%
}
\newcommand*{\StudentsTitlesList}{%
  \MakeList[PTag]{5}{Stdt}{%
    \ifcsvoid{\csuse{PTag}Ttl}{}{%
      \csuse{\csuse{PTag}Ttl}%
      \ifnumless{\value{StdtCtr}}{\value{StdtTmp}}{/}{}%
    }%
  }%
}
\newcommand*{\StudentsNumber}[1][1]{%
  \Attrib@Num@Ex[#1]{Stdt}{%
    \Student{\arabic{StdtCtr}}{%
      Forename = {\FrnmCall},%
      Surname  = {\SrnmCall-A\arabic{StdtCtr}},%
    }%
  }%
}
\StudentsNumber%
%%%%%% Orientador(es)
\newcounter{AdvCtr}
\newcounter{AdvNum}
\newcounter{AdvTmp}
\AddToLang{ProfCall}{Prof\Gen{a}.}{Prof.}
\AddToLang{PhDCall}{Dr\Gen{a}.}{Ph.D.}
\AddToLang{DScCall}{Dr\Gen{a}.}{D.Sc.}
\AddToLang{MScCall}{M\Gen[e]{a}.}{M.Sc.}
\AddToLang{EngCall}{Eng\Gen{a}.}{Eng.}
\csletcs{KV@Person@Fullname}{KV@Person@Forename}
\csletcs{KV@Person@fullname}{KV@Person@Forename}
\newcommand*{\@AdvCall}[1]{\ifnumequal{#1}{1}{\AdvCall}{\CoAdvCall}}
\newcommand*{\AdvisorCall}[2]{\AddToLang{AdvCall}{#1}{#2}}
\newcommand*{\CoAdvisorCall}[2]{\AddToLang{CoAdvCall}{#1}{#2}}
\AdvisorCall{Orientador\Gen{a}}{Advisor}
\CoAdvisorCall{Coorientador\Gen{a}}{Co-Advisor}
\newcommand*{\Advisor}[2]{\Person[Adv]{#1}{#2}}
\NewDocumentCommand{\AdvisorsList}{ s O{} m }{%
  \MakeList[PTag]{3}{Adv}{%
    \ifcsvoid{\csuse{PTag}FlNm}{}{%
      \ifcsvoid{\csuse{PTag}Call}{}{{#2{\csuse{\csuse{PTag}Call}:\\}}}%
      \hangindent0.5em\makebox[0.5em][l]{\faCaretRight}%
      \ifcsvoid{\csuse{PTag}Ttl}{}{\csuse{\csuse{PTag}Ttl} }%
      \csuse{\csuse{PTag}FlNm}%
      \IfBooleanT{#1}{%
        \ifcsvoid{\csuse{PTag}Email}{}{\,\csuse{\csuse{PTag}Email}}%
        \ifcsvoid{\csuse{PTag}Lattes}{}{\,\csuse{\csuse{PTag}Lattes}}%
        \ifcsvoid{\csuse{PTag}ORCID}{}{\,\csuse{\csuse{PTag}ORCID}}%
      }%
      \ifnumless{\value{AdvCtr}}{\value{AdvTmp}}{#3}{}%
    }%
  }%
}
\newcommand*{\AdvisorsNumber}[1][1]{%
  \Attrib@Num@Ex[#1]{Adv}{%
    \Advisor{\arabic{AdvCtr}}{%
      Title    = {\ProfCall\ \PhDCall},%
      Fullname = {\FrnmCall\ \SrnmCall-B\arabic{AdvCtr}},%
    }%
  }%
}
\AdvisorsNumber%
%%%%%% Membros da Banca Examinadora
\newbool{@MmbrTtlAfter}
\newcounter{MmbrCtr}
\newcounter{MmbrNum}
\newcounter{MmbrTmp}
\newlength{\SignLineWd}{}
\setlength{\SignLineWd}{\z@}
\AddToLang{MmbrCall}{Membro}{Member}
\AddToLang{InstCall}{Instituição}{Institution}
\csletcs{KV@Person@Institution}{KV@Person@Surname}
\csletcs{KV@Person@institution}{KV@Person@Surname}
\newcommand*{\Member}[2]{\Person[Mmbr]{#1}{#2}}
\NewDocumentCommand{\MembersList}{ s m }{%
  \MakeList[PTag]{6}{Mmbr}{%
    \ifcsvoid{\csuse{PTag}FlNm}{}{%
      \parbox{\linewidth}{%
        \ifbool{DScOrMSc}{}{\Centering}\scriptsize%
        \ifbool{DScOrMSc}{}{\ifdimgreater{\SignLineWd}{\z@}{\rule{\SignLineWd}{0.5\p@}\vskip0.5ex}{}}%
        \ifcsvoid{\csuse{PTag}Ttl}{}{\ifbool{@MmbrTtlAfter}{}{\csuse{\csuse{PTag}Ttl} }}%
        \csuse{\csuse{PTag}FlNm}%
        \ifcsvoid{\csuse{PTag}Ttl}{}{\ifbool{@MmbrTtlAfter}{\ifbool{DScOrMSc}{, }{\\}\csuse{\csuse{PTag}Ttl}}{}}%
        \IfBooleanT{#1}{%
          \ifcsvoid{\csuse{PTag}Email}{}{\,\csuse{\csuse{PTag}Email}}%
          \ifcsvoid{\csuse{PTag}Lattes}{}{\,\csuse{\csuse{PTag}Lattes}}%
          \ifcsvoid{\csuse{PTag}ORCID}{}{\,\csuse{\csuse{PTag}ORCID}}%
        }%
        \ifcsvoid{\csuse{PTag}Inst}{}{\ifbool{DScOrMSc}{ \textemdash\ }{\\}\csuse{\csuse{PTag}Inst}}%
      }%
      \ifnumless{\value{MmbrCtr}}{\value{MmbrTmp}}{#2}{}%
    }%
  }%
}
\newcommand*{\MembersNumber}[1][3]{%
  \Attrib@Num@Ex[#1]{Mmbr}{%
    \Member{\arabic{MmbrCtr}}{%
      Title       = {\ProfCall\ \PhDCall},%
      Fullname    = {\FrnmCall\ \SrnmCall-C\arabic{MmbrCtr}},%
      Institution = {\InstCall\ (\MmbrCall-C\arabic{MmbrCtr})},%
    }%
  }%
}
\MembersNumber%
%%%%%% Palavras-chave
\newcounter{KWCtr}
\newcounter{KWNum}
\newcounter{KWTmp}
\AddToLang{KeywordsCall}{Palavras-chave}{Keywords}
\newcommand*{\KWCallFrmt}{}
\newcommand*{\KeywordsCallFormat}[1]{\ifblank{#1}{}{\renewcommand*{\KWCallFrmt}{#1}}}
\newcommand*{\Keyword}[3]{%
  \ifboolexpr{ test {\ifcsundef{theKWNum}} or test {\ifcsundef{theKWTmp}} }{}{%
    \checkifinteger{#1}%
    \ifbool{integer}{%
      \boolfalse{integer}%
      \setcounter{KWTmp}{#1}%
      \csdef{KW\Alph{KWTmp}}{}%
      \cseappto{extrasbrazilian}{\csdef{KW\Alph{KWTmp}}{}}%
      \cseappto{extrasenglish}{\csdef{KW\Alph{KWTmp}}{}}%
      \ifblank{#2}{}{%
        \csdef{KW\Alph{KWTmp}}{#2}%
        \cseappto{extrasbrazilian}{\csdef{KW\Alph{KWTmp}}{#2}}%
      }%
      \ifblank{#3}{}{%
        \cseappto{extrasenglish}{\csdef{KW\Alph{KWTmp}}{#3}}%
      }%
      \ifnumless{\value{KWNum}}{\value{KWTmp}}{\setcounter{KWNum}{\value{KWTmp}}}{}%
      \setcounter{KWTmp}{0}%
    }{}%
  }%
}
\newcommand*{\KeywordsList}[3][]{%
  \MakeList{6}{KW}{%
    \ifcsvoid{KW\Alph{KWCtr}}{}{%
      {#1{\csuse{KW\Alph{KWCtr}}}}%
      \ifnumless{\value{KWCtr}}{\value{KWTmp}}{#2}{#3}%
    }%
  }%
}
\newcommand*{\KeywordsNumber}[1][3]{%
  \Attrib@Num@Ex[#1]{KW}{%
    \Keyword{\arabic{KWCtr}}{%
      palavra-chave\ \arabic{KWCtr}%
    }{%
      keyword\ \arabic{KWCtr}%
    }%
  }%
}
\KeywordsNumber%

%% Texto
\setulmarginsandblock{30mm}{20mm}{*}
\setlrmarginsandblock{30mm}{20mm}{*}
\setheadfoot{10mm}{10mm}
\setheaderspaces{*}{10mm}{*}
\setmarginnotes{2.5mm}{15mm}{\onelineskip}
\checkandfixthelayout%
\setlength{\parindent}{15mm}
\setSpacing{1.5}
\ifbool{@twoside}{%
  \ifboolexpr{ bool {@TwoSideFront} and bool {@TwoSideMain} }{}{%
    \boolfalse{@twoside}%
    \boolfalse{@mparswitch}%
  }%
}{%
  \boolfalse{@TwoSideFront}%
  \boolfalse{@TwoSideMain}%
}
\ifbool{@openleft}{\openright}{}
\newcommand*{\@AddPeriod}[2][.]{\ifblank{#2}{}{#2\@addpunct{#1}}}
\newcommand*{\LessSloppy}{%
  \setlength{\emergencystretch}{3em}%
  \hbadness\@M%
}
\csgappto{Centering}{%
  \sloppy%
  \hbadness\@M%
  \hyphenpenalty\@M%
  \exhyphenpenalty\@M%
}
\renewcommand*{\memfblineboxtwo}[1]{\@@line{\hss#1\hss}}
\renewcommand*{\memfblineboxa}[1]{\@@line{\hss#1\hss}}
\raggedbottom%
\ifboolexpr{ bool {xetex} or test {\ifdraft} }{\LessSloppy}{}
%%%% Texto verbatim
\AtBeginEnvironment{Verbatim}{\setSpacing{1}}
\AtBeginEnvironment{verbatim}{%
  \csdef{@xobeysp}{~\discretionary{\GrayInvRsh}{\GrayHookRightArrow}{}}%
  \csdef{wrapright}{\raggedwrap}%
  \setlength{\ragrparindent}{\z@}%
  \setlength{\verbatimindent}{\z@}%
  \setSpacing{1}%
  \footnotesize%
}
\cspreto{verb}{\csdef{@xobeysp}{\space\discretionary{}{}{}}}
\fvset{%
  fontsize               = \footnotesize,%
  breaklines             = true,%
  breakafter             = \space,%
  breakanywhere          = true,%
  breakautoindent        = false,%
  breakaftersymbolpre    = \GrayInvRsh,%
  breakanywheresymbolpre = \GrayInvRsh,%
  breaksymbolleft        = \GrayHookRightArrow,%
  breaksymbolindentleft  = 2ex,%
  breaksymbolsepleft     = \z@,%
  breaksymbolright       = \GrayInvRsh,%
  breaksymbolindentright = \z@,%
  breaksymbolsepright    = \z@,%
}
\fvinlineset{fontsize = auto}
\newcommand*{\GrayInvRsh}{\rotatebox{180}{\textcolor{gray}{\tiny\ensuremath{_\Rsh}}}}
\newcommand*{\GrayHookRightArrow}{\mbox{\textcolor{gray}{\tiny\ensuremath{\hookrightarrow}}}}

%% Cabeçalhos e rodapés
\makepagestyle{ABNTHdg}
\makeoddhead{ABNTHdg}{}{}{\footnotesize\thepage}
\makeevenhead{ABNTHdg}{\footnotesize\thepage}{}{}
\makepagestyle{TtlPgHdg}
\makeoddhead{TtlPgHdg}{}{}{\ifbool{@PageNumFront}{\footnotesize\thepage}{}}
\makeoddfoot{TtlPgHdg}{%
  \footnotesize%
  \ifboolexpr{ bool {@CCLicUTFPR} or (test {\ifcsvoid{CCLicYear}} and test {\ifcsvoid{CCLicCreator}}) }{%
    \parbox[b][4.5ex][t]{12.9ex}{\CCLicLogo}\hskip1ex%
    \parbox[b][4.5ex][t]{\textwidth-13.9ex}{\scriptsize\sffamily\CCLicDescr}%
  }{%
    \vskip-\baselineskip%
    \parbox[b][4.5ex][t]{\textwidth}{%
      \color{gray}\hypersetup{allcolors = {\ifcsvoid{@LinkColor}{}{LinkColor!50!}gray}}%
      \scriptsize\sffamily\CCLicDescr%
    }%
  }%
}{}{}

%% Níveis de divisões: Documento e Sumário
\setcounter{secnumdepth}{5}
\setsecnumdepth{subparagraph}
\maxsecnumdepth{subparagraph}
\setcounter{tocdepth}{4}
\settocdepth{paragraph}
\maxtocdepth{paragraph}

%% Partes
\newcommand*{\PhantomPart}{\bookmarksetup{startatroot}}
\renewcommand*{\beforepartskip}{\ifbool{@TwoSideMain}{\OpenPageOdd}{}\null\vfill}
\renewcommand*{\midpartskip}{\vskip\baselineskip}
\renewcommand*{\afterpartskip}{\vfill\null\clearforchapter}
\renewcommand*{\partnamefont}{\normalfont\normalsize\bfseries}
\renewcommand*{\partnumfont}{\partnamefont}
\renewcommand*{\parttitlefont}{\partnamefont}
\renewcommand*{\printpartname}{\partnamefont\MakeTextUppercase{\partname}}
\renewcommand*{\printparttitle}[1]{\parttitlefont\MakeTextUppercase{#1}}

%% Capítulos
\gluedef{\Chap@Skip}{\baselineskip\@plus0.2\baselineskip\@minus0.2\baselineskip}
\newcommand*{\OpenPageOdd}{\ifbool{@OpenPageOdd}{\ifbool{@openright}{}{\ifnumodd{\value{page}}{}{\addtocounter{page}{1}}}}{}}
\makechapterstyle{UnnumberedChapter}{%
  \chapterstyle{article}%
  \setlength{\beforechapskip}{\z@}%
  \setlength{\afterchapskip}{\Chap@Skip}%
  \renewcommand*{\chapterheadstart}{\ifbool{@TwoSideFront}{\OpenPageOdd}{}}%
  \renewcommand*{\chapnamefont}{\normalfont\normalsize\bfseries}%
  \renewcommand*{\chapnumfont}{\chapnamefont}%
  \renewcommand*{\chaptitlefont}{\chapnamefont}%
  \renewcommand*{\printchaptertitle}[1]{\Centering\chaptitlefont\MakeTextUppercase{##1}}%
  \indentafterchapter%
}
\makechapterstyle{NumberedChapter}{%
  \chapterstyle{UnnumberedChapter}%
  \renewcommand*{\chapterheadstart}{\ifbool{@TwoSideMain}{\OpenPageOdd}{}}%
  \renewcommand*{\afterchapternum}{\quad}%
  \renewcommand*{\printchapternum}{\chapnumfont\thechapter}%
  \renewcommand*{\printchaptertitle}[1]{\chaptitlefont\MakeTextUppercase{##1}}%
}
\makechapterstyle{AppendixChapter}{%
  \chapterstyle{UnnumberedChapter}%
  \setlength{\afterchapskip}{\z@}%
  \renewcommand*{\chapterheadstart}{%
    \ifbool{@TwoSideMain}{\OpenPageOdd}{}%
    \null\vfill%
    \phantomsection%
  }%
  \renewcommand*{\chapternamenum}{\space}%
  \renewcommand*{\afterchapternum}{\space\textemdash\space}%
  \renewcommand*{\printchaptername}{\chapnamefont\MakeTextUppercase{\@chapapp}}%
  \renewcommand*{\printchapternum}{\chapnumfont\thechapter}%
  \ifbool{@ApxAnxTtlLower}{\renewcommand*{\printchaptertitle}[1]{\Centering\chaptitlefont##1}}{}%
  \renewcommand*{\memendofchapterhook}{\vfill\null\clearforchapter}%
}

%% Seções
\newcommand*{\Sect@Name}[1]{\AddToLang{#1autorefname}{\Cref@section@name}{\Cref@section@name}}
\forcsvlist{\Sect@Name}{section, subsection, subsubsection, paragraph, subparagraph}
\crefalias{paragraph}{section}
\crefalias{subparagraph}{section}
\newcommand*{\Sect@Fmt}[1]{%
  \csuse{setbefore#1skip}{\Chap@Skip}%
  \csuse{setafter#1skip}{\Chap@Skip}%
  \csuse{set#1headstyle}{\normalfont\normalsize}%
}
\forcsvlist{\Sect@Fmt}{sec, subsec, subsubsec, para, subpara}
\setbeforesubparaskip{\parskip}
\setaftersubparaskip{-1ex}
\setsubparaindent{\parindent}
\csappto{secheadstyle}{\bfseries}
\csappto{paraheadstyle}{\noindent\emph}
\csappto{subparaheadstyle}{\@AddPeriod[:]}
\setsecnumformat{%
  \ifcsundef{#1secnumformat}{%
    \csuse{the#1}\quad%
  }{%
    \csuse{#1secnumformat}%
  }%
}
\newcommand*{\subsubsectionsecnumformat}{\uline{\thesubsubsection\quad}}
\newcommand*{\subparagraphsecnumformat}{\S\,\arabic{subparagraph}\IfLanguageName{brazilian}{.\textordmasculine}{}\quad}
\newrobustcmd*{\SecFmt}[2]{\ifstrequal{#2}{3}{\uline{#1}}{#1}}
\csletcs{old@M@sect}{M@sect}
\csdef{M@sect}#1#2#3#4#5#6[#7][#8]#9{\protect\old@M@sect{#1}{#2}{#3}{#4}{#5}{#6}[\SecFmt{#7}{#2}][{#8}]{\SecFmt{#9}{#2}}}
\ifpatchable*{\thesubparagraph}{%
  \xpatchcmd{\thesubparagraph}{\theparagraph.\@arabic\c@subparagraph}{%
    \theparagraph, \S\,\@arabic\c@subparagraph\IfLanguageName{brazilian}{.\textordmasculine}{}%
  }{}{}%
}{}

%% Listas de itens
\AtBeginEnvironment{itemize}{\LessSloppy}
\AtBeginEnvironment{enumerate}{\LessSloppy}
\setlist{%
  topsep     = \z@,%
  partopsep  = \z@,%
  parsep     = \z@,%
  itemsep    = \z@,%
  leftmargin = *,%
  align      = left,%
}
\setlist[1]{labelindent = \parindent}
\newcommand*{\alphsect}{\alph*^^29}
\renewcommand*{\@listI}{%
  \leftmargin\leftmargini%
  \topsep\z@%
  \parsep\z@%
  \itemsep\z@%
}

%% Notas de rodapé
% \counterwithout{footnote}{chapter}%% Usa numeração consecutiva e independente
\setlength{\footmarkwidth}{1em}
\setlength{\footmarksep}{\z@}
\setfootins{\baselineskip}{\baselineskip}
\footmarkstyle{\textsuperscript{#1}\hfill}
\csletcs{old@footnotetext}{@footnotetext}
\renewcommand*{\@footnotetext}[1]{\old@footnotetext{\@AddPeriod{#1}}}
\renewcommand*{\footnoterule}{\kern-3\p@\hrule\@width50mm\kern2.5\p@}
%%%% Notas laterais
\sideparmargin{outer}
\renewcommand*{\sideparfont}{\tiny}
\renewcommand*{\sideparform}{\ifbool{memtortm}{\RaggedRight}{\RaggedLeft}}
%%%% Barras laterais
\sidebarmargin{outer}
\setsidebars{\marginparsep}{\marginparwidth}{*}{*}{*}{*}
\renewcommand*{\sidebarfont}{\tiny}
\renewcommand*{\sidebarform}{\ifbool{memtortm}{\RaggedRight}{\RaggedLeft}}

%% Citações diretas: curtas e longas
\dimdef{\CitLeftSkip}{40mm}
\NewDocumentCommand{\Citation}{ O{\languagename} m m O{} }{%
  \IfStringInList{#1}{\bbl@loaded}{\csdef{@CitLang}{#1}}{\csdef{@CitLang}{\languagename}}%
  \hyphenblockquote{\@CitLang}[%
    \ignorespaces\ifblank{#2}{}{#2}\ifblank{#4}{}{\csdisplayfalse\footnote{#4}}\unskip%
  ]{%
    \ignorespaces\ifcsstring{languagename}{#1}{#3}{\textit{#3}}\unskip%
  }%
}
\NewDocumentEnvironment{DisplayCitation}{ O{\languagename} m O{} }{%
  \IfStringInList{#1}{\bbl@loaded}{\csdef{@CitLang}{#1}}{\csdef{@CitLang}{\languagename}}%
  \begin{hyphendisplayquote}{\@CitLang}[%
    \ifblank{#2}{}{\ignorespaces#2\unskip}%
    \ifblank{#3}{}{\csdisplayfalse\footnote{\ignorespaces#3\unskip}}\@addpunct{.}%
  ]%
  \begingroup%
  \ifcsstring{languagename}{#1}{}{\itshape}%
}{%
  \endgroup%
  \end{hyphendisplayquote}%
}
\newenvironment*{DisplayCitationBlock}{%
  \list{}{\setlength{\leftmargin}{\z@}}%
  \item%
  \LessSloppy%
  \ifbool{@twocolumn}{%
    \addtolength{\leftskip}{0.25\linewidth}%
  }{%
    \addtolength{\leftskip}{\CitLeftSkip}%
  }%
  \begin{SingleSpace}%
  \footnotesize%
}{%
  \end{SingleSpace}%
  \endlist%
}
\renewcommand*{\mkcitation}[1]{\ifblank{#1}{}{ #1}}
\SetBlockEnvironment{DisplayCitationBlock}

%% Equações
\counterwithout{equation}{chapter}
\ifbool{@fleqn}{\setlength{\mathindent}{\parindent}}{}
\csletcs{math@up}{mathrm}
\AtBeginDocument{%
  \csxdef{rm@default}{\rmdefault}%
  \ifcsequal{f@family}{rm@default}{%
    \csletcs{math@up@fm}{mathrm}%
  }{%
    \csletcs{math@up@fm}{mathsf}%
  }%
}
\newrobustcmd*{\Unit}[2][]{%
  \ifbool{mmode}{%
    \math@up{\ifblank{#1}{}{#1\,}#2}%
  }{%
    \ensuremath{\math@up@fm{\ifblank{#1}{}{#1\,}#2}}%
  }%
}
\newrobustcmd*{\MathBF}[1]{%
  \ifboolexpr{ bool {luatex} or bool {xetex} }{%
    \begingroup%
    \ifcsequal{f@family}{rm@default}{%
      \csletcs{math@up@fm}{symbfup}%
    }{%
      \csletcs{math@up@fm}{symbfsf}%
    }%
    \ifbool{mmode}{\symbf{#1}}{{\csletcs{math@up}{math@up@fm}\ensuremath{\symbf{#1}}}}%
    \endgroup%
  }{%
    \ifbool{mmode}{\text{\boldmath\ensuremath{#1}}}{{\csletcs{math@up}{math@up@fm}\boldmath\ensuremath{#1}}}%
  }%
}
\newrobustcmd*{\Degree}[1][]{\ifbool{mmode}{\text{\textdegree}}{\textdegree}\ifblank{#1}{}{#1}}
\ExplSyntaxOn%
\ProvideExpandableDocumentCommand{\inteval}{ m }{\int_eval:n {#1}}
\ProvideExpandableDocumentCommand{\fpeval}{ m }{\fp_eval:n {#1}}
\cs_new:Npn \point_to_comma:n #1
  {
    \exp_args:Ne \tl_to_str:n
      { \str_map_function:nN {#1} \__point_to_comma:n }
  }
\cs_new:Npn \__point_to_comma:n #1
  {
    \int_compare:nNnTF { `#1 } = { `. }
      { , }                                   %% CHKTEX 26
      { #1 }
  }
\cs_generate_variant:Nn \point_to_comma:n {e}
\cs_set_eq:NN \pointtocomma \point_to_comma:e %% CHKTEX 1
\cs_set_eq:NN \origfpeval \fp_eval:n          %% CHKTEX 1
\RenewExpandableDocumentCommand{\fpeval}{ s m }{%
  \IfBooleanTF{#1}{%
    \origfpeval{#2}%
  }{%
    \IfLanguageName{brazilian}{%
      \pointtocomma{\origfpeval{#2}}%
    }{%
      \origfpeval{#2}%
    }%
  }%
}
\ExplSyntaxOff%

%% Objetos flutuantes: figuras, tabelas, etc.
\newbool{LTMoreThanOnePage}
\Crefname{flowchart}{Fluxograma}{Fluxogramas}
\Crefname{photograph}{Fotografia}{Fotografias}
\Crefname{graph}{Gráfico}{Gráficos}
\Crefname{tabframed}{Quadro}{Quadros}
\ifbool{@cref@capitalise}{%
  \ifbool{@cref@abbrev}{%
    \crefname{flowchart}{Flux.}{Fluxs.}%
    \crefname{photograph}{Fot.}{Fots.}%
    \crefname{graph}{Gráf.}{Gráfs.}%
    \crefname{tabframed}{Quad.}{Quads.}%
  }{%
    \crefname{flowchart}{Fluxograma}{Fluxogramas}%
    \crefname{photograph}{Fotografia}{Fotografias}%
    \crefname{graph}{Gráfico}{Gráficos}%
    \crefname{tabframed}{Quadro}{Quadros}%
  }%
}{%
  \ifbool{@cref@abbrev}{%
    \crefname{flowchart}{flux.}{fluxs.}%
    \crefname{photograph}{fot.}{fots.}%
    \crefname{graph}{gráf.}{gráfs.}%
    \crefname{tabframed}{quad.}{quads.}%
  }{%
    \crefname{flowchart}{fluxograma}{fluxogramas}%
    \crefname{photograph}{fotografia}{fotografias}%
    \crefname{graph}{gráfico}{gráficos}%
    \crefname{tabframed}{quadro}{quadros}%
  }%
}
\csappto{extrasbrazilian}{%
  \Crefname{flowchart}{Fluxograma}{Fluxogramas}%
  \Crefname{photograph}{Fotografia}{Fotografias}%
  \Crefname{graph}{Gráfico}{Gráficos}%
  \Crefname{tabframed}{Quadro}{Quadros}%
  \ifbool{@cref@capitalise}{%
    \ifbool{@cref@abbrev}{%
      \crefname{flowchart}{Flux.}{Fluxs.}%
      \crefname{photograph}{Fot.}{Fots.}%
      \crefname{graph}{Gráf.}{Gráfs.}%
      \crefname{tabframed}{Quad.}{Quads.}%
    }{%
      \crefname{flowchart}{Fluxograma}{Fluxogramas}%
      \crefname{photograph}{Fotografia}{Fotografias}%
      \crefname{graph}{Gráfico}{Gráficos}%
      \crefname{tabframed}{Quadro}{Quadros}%
    }%
  }{%
    \ifbool{@cref@abbrev}{%
      \crefname{flowchart}{flux.}{fluxs.}%
      \crefname{photograph}{fot.}{fots.}%
      \crefname{graph}{gráf.}{gráfs.}%
      \crefname{tabframed}{quad.}{quads.}%
    }{%
      \crefname{flowchart}{fluxograma}{fluxogramas}%
      \crefname{photograph}{fotografia}{fotografias}%
      \crefname{graph}{gráfico}{gráficos}%
      \crefname{tabframed}{quadro}{quadros}%
    }%
  }%
  \renewcommand*{\algorithmicrequire}{\textbf{Requer:}}%
  \renewcommand*{\algorithmicensure}{\textbf{Garantir:}}%
  \renewcommand*{\algorithmicend}{\textbf{finaliza}}%
  \renewcommand*{\algorithmicif}{\textbf{se}}%
  \renewcommand*{\algorithmicthen}{\textbf{então}}%
  \renewcommand*{\algorithmicelse}{\textbf{senão}}%
  \renewcommand*{\algorithmicelsif}{\algorithmicelse, \algorithmicif}%
  \renewcommand*{\algorithmicfor}{\textbf{para}}%
  \renewcommand*{\algorithmicforall}{\textbf{para todos}}%
  \renewcommand*{\algorithmicdo}{\textbf{faz}}%
  \renewcommand*{\algorithmicwhile}{\textbf{enquanto}}%
  \renewcommand*{\algorithmicloop}{\textbf{ciclo}}%
  \renewcommand*{\algorithmicrepeat}{\textbf{repete}}%
  \renewcommand*{\algorithmicuntil}{\textbf{até}}%
  \renewcommand*{\algorithmicprint}{\textbf{imprime}}%
  \renewcommand*{\algorithmicreturn}{\textbf{retorna}}%
  \renewcommand*{\algorithmicand}{\textbf{e}}%
  \renewcommand*{\algorithmicor}{\textbf{ou}}%
  \renewcommand*{\algorithmicxor}{\textbf{exou}}%
  \renewcommand*{\algorithmicnot}{\textbf{não}}%
  \renewcommand*{\algorithmicto}{\textbf{a}}%
  \renewcommand*{\algorithmicinputs}{\textbf{entrada{(s)}}}%
  \renewcommand*{\algorithmicoutputs}{\textbf{saída{(s)}}}%
  \renewcommand*{\algorithmicglobals}{\textbf{global{(is)}}}%
  \renewcommand*{\algorithmicbody}{\textbf{faz}}%
  \renewcommand*{\algorithmictrue}{\textbf{verdadeiro}}%
  \renewcommand*{\algorithmicfalse}{\textbf{falso}}%
}
\csappto{extrasenglish}{%
  \Crefname{flowchart}{Flowchart}{Flowcharts}%
  \Crefname{photograph}{Photograph}{Photographs}%
  \Crefname{graph}{Graph}{Graphs}%
  \Crefname{tabframed}{Frame}{Frames}%
  \ifbool{@cref@capitalise}{%
    \ifbool{@cref@abbrev}{%
      \crefname{flowchart}{Flow.}{Flows.}%
      \crefname{photograph}{Phot.}{Phots.}%
    }{%
      \crefname{flowchart}{Flowchart}{Flowcharts}%
      \crefname{photograph}{Photograph}{Photographs}%
    }%
    \crefname{graph}{Graph}{Graphs}%
    \crefname{tabframed}{Frame}{Frames}%
  }{%
    \ifbool{@cref@abbrev}{%
      \crefname{flowchart}{flow.}{flows.}%
      \crefname{photograph}{phot.}{phots.}%
    }{%
      \crefname{flowchart}{flowchart}{flowcharts}%
      \crefname{photograph}{photograph}{photographs}%
    }%
    \crefname{graph}{graph}{graphs}%
    \crefname{tabframed}{frame}{frames}%
  }%
}
\newcommand*{\Flt@Name}[1]{%
  \crefalias{sub#1}{#1}%
  \csdef{#1name}{\csuse{Cref@#1@name}}%
  \csdef{#1autorefname}{\csuse{Cref@#1@name}}%
  \csdef{sub#1autorefname}{\csuse{Cref@#1@name}}%
}
\forcsvlist{\Flt@Name}{algorithm, flowchart, photograph, graph, tabframed}
\csletcs{subfigureautorefname}{figurename}
\csletcs{subtableautorefname}{tablename}
\renewcommand*{\graphicspath}[1]{%
  \providecommand*{\Ginput@path}{}%
  \csgappto{Ginput@path}{#1}%
}
\graphicspath{%
  {./Pre-Textual/Backgrounds/}%
  {./Pre-Textual/Logos/}%
  {./Pre-Textual/Logos/Campi/}%
}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
\setlength{\aboverulesep}{\z@}
\setlength{\belowrulesep}{\z@}
\setlength{\extrarowheight}{0.25ex}
\setlength{\arrayrulewidth}{\lightrulewidth}
\newcolumntype{?}[1]{!{\vrule\@width\ifblank{#1}{\heavyrulewidth}{#1}}}
\newcolumntype{e}[1]{@{\extracolsep{\ifblank{#1}{\fill}{#1}}}}
\newcolumntype{,}[1]{\DT{,}{\mathord\mathcomma}{\ifblank{#1}{-1}{#1}}}
\newcolumntype{.}[1]{\DT{.}{.}{\ifblank{#1}{-1}{#1}}}
\newcolumntype{;}[1]{\DTB{,}{\mathord\mathcomma}{\ifblank{#1}{-1}{#1}}}
\newcolumntype{:}[1]{\DTB{.}{.}{\ifblank{#1}{-1}{#1}}}
\newcolumntype{\DT}[3]{>{\textfont0=\the\font\DC@{#1}{#2}{#3}}c<{\DC@end}}
\newcolumntype{\DTB}[3]{>{\bfseries\textfont0=\the\font\DC@{#1}{#2}{#3}}c<{\DC@end}}
\newcolumntype{Y}{>{\centering\arraybackslash}X}
\newcolumntype{Z}{>{\raggedleft\arraybackslash}X}
\renewcommand*{\@memfront@floats}{}
\renewcommand*{\@memmain@floats}{}
\renewcommand*{\@memback@floats}{}
\newfloat{algorithm}{loa}{\algorithmname}
\newfloat{flowchart}{low}{\flowchartname}
\newfloat{photograph}{lop}{\photographname}
\newfloat{graph}{loh}{\graphname}
\newfloat{tabframed}{lod}{\tabframedname}
\newcommand*{\Flt@Sub@Adj}[1]{%
  \newsubfloat{#1}%
  \setfloatadjustment{#1}{\centering\footnotesize}%
}
\forcsvlist{\Flt@Sub@Adj}{algorithm, figure, flowchart, photograph, graph, tabframed, table}
\algsetup{linenosize = {\color{gray}\tiny}, linenodelimiter = {:}}
\renewcommand*{\algorithmiccomment}[1]{\hskip2em\@plus0.05fil\@minus1em\textcolor{gray}{\#\ #1}}
\AtBeginEnvironment{longtable}{%
  \setlength{\LTleft}{\z@}%
  \setlength{\LTright}{\z@}%
  \setlength{\LTcapwidth}{\linewidth-0.5\tabcolsep}%
  \setlength{\JustifyingParindent}{\z@}%
  \setSpacing{1}\centering\footnotesize%
}
\newsavebox{\LT@lasthead}
\csdef{endlasthead}{\LT@end@hd@ft\LT@lasthead}
\ifpatchable*{\LT@output}{%
  \xpatchcmd{\LT@output}{%
    \ifnum\outputpenalty<-\@Mi%
  }{%
    \ifnum\outputpenalty<-\@Mi%
    \ifbool{LTMoreThanOnePage}{\copy\LT@lasthead}{}%
    \setbox\LT@head\vsplit\@cclv to \ht\LT@lasthead%
  }{}{}%
  \xpatchcmd{\LT@output}{%
    \setbox\z@\vbox{\box\LT@head}%
  }{%
    \setbox\z@\vbox{\box\LT@lasthead}%
  }{}{}%
  \xpatchcmd{\LT@output}{%
    \setbox\@cclv\vbox{\unvbox\@cclv\copy\LT@foot\vss}%
  }{%
    \global\booltrue{LTMoreThanOnePage}%
    \setbox\@cclv\vbox{\unvbox\@cclv\copy\LT@foot\vss}%
  }{}{}%
  \xpatchcmd{\LT@output}{%
    \copy\LT@head\nobreak%
  }{%
    \copy\LT@head%
  }{}{}%
}{}
\BeforeBeginEnvironment{algorithmic}{\vskip0.25ex\hrule\@height\heavyrulewidth}
\AfterEndEnvironment{algorithmic}{\hrule\@height\heavyrulewidth\vskip-0.25ex}
%%%% Legendas
\setlength{\abovecaptionskip}{\p@}
\setlength{\belowcaptionskip}{\p@}
\captiondelim{\space\textendash\space}
\captionnamefont{\footnotesize\bfseries}
\captiontitlefont{\footnotesize\bfseries}
% \captiontitlefinal{\@addpunct{.}}%% Adiciona ponto final, se não houver um
\ifbool{@CaptionCenter}{%
  \captionstyle[\centering]{\centering}%
  \subcaptionstyle{\centering}%
  \normalcaption%
  \normalsubcaption%
}{%
  \captionstyle[\justifying]{\justifying}%
  \subcaptionstyle{\justifying}%
  \hangcaption%
  \hangsubcaption%
}
\subcaptionlabelfont{\scriptsize\bfseries}
\subcaptionfont{\scriptsize\bfseries}
\newcommand*{\SetCaptionWidth}[1]{%
  \ifblank{#1}{}{%
    \captionwidth{#1}%
    \changecaptionwidth%
  }%
}
\csletcs{CaptionWidth}{@contcwidth}

%% Inicialização do documento
\newcounter{RomanPage}
\AtBeginDocument{%
  \newcommand*{\TheTitle}{\protect\textbf{\@Ttl}\ifcsvoid{@SubTtl}{}{\protect\textbf{:} \@SubTtl}}%
  \newcommand*{\TheAuthors}{}%
  \newcommand*{\TheSubject}{\DocumentTypeName\ (\AcadDegInCrs)}%
  \MakeList[PTag]{5}{Stdt}{%
    \csxappto{TheAuthors}{%
      \csuse{\csuse{PTag}FlNm}%
      \ifnumless{\value{StdtCtr}}{\value{StdtTmp}}{, }{}%
    }%
  }%
  \title{\@Ttl\ifcsvoid{@SubTtl}{}{: \@SubTtl}}%
  \author{\TheAuthors}%
  \hypersetup{%
    pdftitle    = {\thetitle},%
    pdfauthor   = {\theauthor},%
    pdfsubject  = {\TheSubject},%
  }%
  \ifboolexpr{%
    test {\ifnumgreater{\value{AcadDegOpt}}{0}} and %
    test {\ifnumless{\value{AcadDegOpt}}{7}}%
  }{}{\boolfalse{@CoverBGOn}}%
  \ifbool{@TwoSideFront}{%
    \booltrue{@twoside}%
    \booltrue{@mparswitch}%
  }{}%
  \ifbool{@openright}{}{\csletcs{cleardoublepage}{clearpage}}%
  \pagenumbering{Roman}%
  \IfStringInList{brazilian}{\bbl@loaded}{\toggletrue{@BRLang}}{\togglefalse{@BRLang}}%
  \IfStringInList{english}{\bbl@loaded}{\toggletrue{@ENLang}}{\togglefalse{@ENLang}}%
  \begin{titlingpage}%
  \maketitle%
  \end{titlingpage}%
  \setcounter{RomanPage}{\value{page}}%
  \ifbool{@twoside}{\ifbool{@openright}{\addtocounter{RomanPage}{1}}{}}{}%
  \PreTextual%
}

%% Capa
\AddToLang{CvrName}{Capa}{Cover}
\renewcommand*{\@maketitle}{%
  \csletcs{footnote}{@mem@titlefootkill}%
  \ifdimgreater{\pagetotal}{\z@}{\clearpage}{}%
  \PDFBookmark{\CvrName}{cvr}%
  \begingroup%
  \ifbool{@CoverBGOn}{%
    \ifdraft{}{\ifbool{Graduate}{\color{white}}{}}%
    \AddToShipoutPictureBG*{%
      \ifcsvoid{CmpsAcr}{%
        \colorlet{CoverBGAltColor}{\ifbool{Graduate}{CoverBGColor}{UTFPRLightBeige}}%
        \AtPageLowerLeft{\makebox{\color{CoverBGAltColor}\rule{\paperwidth}{\paperheight}}}%
      }{%
        \AtPageLowerLeft{\includegraphics[width = \paperwidth, height = \paperheight]{\CmpsBGFile}}%
      }%
      \ifbool{Graduate}{}{%
        \ifbool{xetex}{}{\transparent{0.5}}%
        \AtPageUpperLeft{\raisebox{-60mm}{\makebox{\color{CoverBGColor}\rule{\paperwidth}{60mm}}}}%
        \AtPageLowerLeft{\raisebox{12mm}{\makebox{\color{CoverBGColor}\rule{\paperwidth}{24mm}}}}%
      }%
    }%
  }{}%
  \centering\bfseries%
  \begin{minipage}[t][13\baselineskip][t]{\textwidth}%
  \strut\Centering%
  \MakeTextUppercase{\UTFPRName}\\%
  \ifbool{@CoverDataAll}{\MakeTextUppercase{\DepartmentName}}{\strut}\\%
  \ifbool{@CoverDataAll}{\MakeTextUppercase{\AcadDegInCrs}}{\strut}\vfill%
  \StudentsList[\MakeTextUppercase]{\\}{\vfill}%
  \strut%
  \end{minipage}%
  \par%
  \begin{Center}%
  \selectlanguage{\@TtlLang}\MakeTextUppercase{\TheTitle}%
  \end{Center}%
  \vfill%
  \ifbool{@CoverDataAll}{\MakeTextUppercase{\DocumentTypeName}}{\strut}\vfill%
  \MakeTextUppercase{\CmpsName}\\%
  \YearNum\\%
  \endgroup%
}
%%%% Contracapa
\AddToLang{BckCvrName}{Contracapa}{Back Cover}
\newcommand*{\BackCover}{%
  \clearforchapter%
  \ifbool{@CoverBGOn}{%
    \savepagenumber%
    \pagenumbering{Roman}%
    \addtocounter{RomanPage}{1}%
    \setcounter{page}{\value{RomanPage}}%
    \PDFBookmark{\BckCvrName}{bckcvr}%
    \pagestyle{titlingpage}%
    \ifbool{@twoside}{%
      \cleartoevenpage%
    }{%
      \booltrue{@twoside}%
      \booltrue{@mparswitch}%
    }%
    \AddToShipoutPictureBG*{%
      \AtPageLowerLeft{\makebox{\color{CoverBGColor}\rule{\paperwidth}{\paperheight}}}%
      \ifcsvoid{CmpsAcr}{}{%
        \AtPageLowerLeft{%
          \raisebox{20mm}{%
            \parbox[b]{\paperwidth}{\centering\includegraphics[height = 2\baselineskip]{\CmpsFile}}%
          }%
        }%
      }%
    }%
    \null%
    \clearpage%
    \restorepagenumber%
  }{}%
}

%% Elementos pré-textuais
\newcommand*{\PreTextual}{%
  \frontmatter%
  \ifbool{@PageNumFront}{%
    \pagestyle{ABNTHdg}%
    \aliaspagestyle{chapter}{ABNTHdg}%
    \aliaspagestyle{cleared}{ABNTHdg}%
    \aliaspagestyle{part}{ABNTHdg}%
    \nopartblankpage%
  }{%
    \pagestyle{empty}%
    \aliaspagestyle{chapter}{empty}%
    \aliaspagestyle{cleared}{empty}%
    \aliaspagestyle{part}{empty}%
  }%
  \chapterstyle{UnnumberedChapter}%
}

%% Folha de Rosto
\newbool{@FrgnTtlUpperCase}
\newtoggle{@BRLang}
\newtoggle{@ENLang}
\AddToLang{TtlPgName}{Folha de Rosto}{Title Page}
\providecommand*{\ttlpgref}{\TtlPgName}
\NewDocumentEnvironment{TitlePage}{ O{} O{} O{} O{} }{%
  \ifblank{#1}{}{%
    \ifstrequal{#1}{BY}{}{}%
    \ifstrequal{#1}{BY-SA}{\global\booltrue{@CCLicSA}}{}%
    \ifstrequal{#1}{BY-ND}{\global\booltrue{@CCLicND}}{}%
    \ifstrequal{#1}{BY-NC}{\global\booltrue{@CCLicNC}}{}%
    \ifstrequal{#1}{BY-NC-SA}{%
      \global\booltrue{@CCLicSA}%
      \global\booltrue{@CCLicNC}%
    }{}%
    \ifstrequal{#1}{BY-NC-ND}{%
      \global\booltrue{@CCLicND}%
      \global\booltrue{@CCLicNC}%
    }{}%
    \ifblank{#2}{}{\renewcommand*{\CCLicYear}{#2}}%
    \ifblank{#3}{}{\renewcommand*{\CCLicCreator}{#3}}%
    \ifblank{#4}{}{\CCLicenseDescription*{#4}}%
    \ifbool{@VersionAbstract}{}{\thispagestyle{TtlPgHdg}}%
  }%
  \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
  \PDFBookmark{\TtlPgName}{ttlpg}%
  \begin{center}%
  \begin{minipage}[t][13\baselineskip][t]{\textwidth}%
  \strut\Centering%
  \StudentsList*[\bfseries\MakeTextUppercase]{\\}{}%
  \strut%
  \end{minipage}%
  \par%
  \begin{Center}%
  \selectlanguage{\@TtlLang}%
  \IfLanguageName{brazilian}{\selectlanguage{brazilian}}{\selectlanguage{english}}%
  \bfseries\MakeTextUppercase{\TheTitle}%
  \end{Center}%
  \ifboolexpr{ togl {@BRLang} and togl {@ENLang} }{%
    \vskip\baselineskip%
    \begin{Center}%
    \selectlanguage{\@TtlLang}%
    \IfLanguageName{brazilian}{\selectlanguage{english}}{\selectlanguage{brazilian}}%
    \bfseries\ifbool{@FrgnTtlUpperCase}{\MakeTextUppercase{\TheTitle}}{\TheTitle}%
    \end{Center}%
  }{}%
  \end{center}%
  \vskip\baselineskip%
  \begin{SingleSpace}%
  \raggedleft\footnotesize%
  \begin{minipage}{0.5\textwidth}%
  \LessSloppy%
}{%
  \end{minipage}%
  \ifnumgreater{\value{AdvNum}}{0}{%
    \vskip\baselineskip%
    \parbox{0.5\textwidth}{\raggedright\AdvisorsList*{\\}}%
  }{}%
  \end{SingleSpace}%
  \vfill%
  \begingroup%
  \centering\bfseries%
  \MakeTextUppercase{\CmpsName}\\%
  \YearNum\\%
  \endgroup%
  \TtlPgBack%
}
\csletcs{TitlePage*}{TitlePage}
\csletcs{endTitlePage*}{endTitlePage}
\AtBeginEnvironment{TitlePage*}{\booltrue{@FrgnTtlUpperCase}}
%%%% Termo de Licenciamento
\newbool{@CCLicUTFPR}
\newbool{@CCLicNC}
\newbool{@CCLicND}
\newbool{@CCLicSA}
\AddToLang{CCLicInt}{Internacional}{International}
\newcommand*{\CCLicYear}{}
\newcommand*{\CCLicCreator}{}
\newcommand*{\CCLicAcr}[1]{%
  \ifbool{@CCLicNC}{#1nc}{}%
  \ifbool{@CCLicND}{#1nd}{}%
  \ifbool{@CCLicSA}{#1sa}{}%
}
\newcommand*{\CCLicIcons}{%
  \faCreativeCommons\,\faCreativeCommonsBy%
  \ifbool{@CCLicNC}{\,\faCreativeCommonsNc}{}%
  \ifbool{@CCLicND}{\,\faCreativeCommonsNd}{}%
  \ifbool{@CCLicSA}{\,\faCreativeCommonsSa}{}%
}
\newcommand*{\CCLicURL}{https://creativecommons.org/licenses/by\CCLicAcr{-}/4.0/}
\newcommand*{\CCLicLogo}{\href{\CCLicURL}{\XeTeXLinkBox{\includegraphics[height = 4.5ex]{cc-by\CCLicAcr{-}}}}}
\NewDocumentCommand{\CCLicenseDescription}{ s O{} m }{%
  \IfBooleanT{#1}{%
    \global\booltrue{@CCLicUTFPR}%
    \renewcommand*{\CCLicLogo}{%
      \begin{minipage}{12.9ex}%
      \centering%
      \includegraphics[height = 4.5ex]{cc-by\CCLicAcr{-}}\\%
      \href{\CCLicURL}{{\scriptsize 4.0 \CCLicInt}}%
      \end{minipage}%
    }%
  }%
  \ifblank{#2}{%
    \AddToLang{CCLicDescr}{#3}{#3}%
  }{%
    \AddToLang{CCLicDescr}{#3}{#2}%
  }%
}
\CCLicenseDescription[%
  This \DocumentTypeName\ifcsvoid{CCLicYear}{}{ \faCopyright[regular] \CCLicYear}%
  \ifcsvoid{CCLicCreator}{}{ by \CCLicCreator} is licensed under %
  \href{\CCLicURL}{%
    Creative Commons Attribution%
    \ifbool{@CCLicNC}{\csuse{textendash}Non\-Com\-mer\-cial}{}%
    \ifbool{@CCLicND}{\csuse{textendash}No\-De\-riv\-a\-tives}{}%
    \ifbool{@CCLicSA}{\csuse{textendash}Share\-Alike}{} %
    4.0 International\ifboolexpr{ test {\ifcsvoid{CCLicYear}} and test {\ifcsvoid{CCLicCreator}} }{}{ \CCLicIcons}%
  }%
  \ifboolexpr{ test {\ifcsvoid{CCLicYear}} and test {\ifcsvoid{CCLicCreator}} }{, %
    which permits use and distribution in any medium or format, %
    provided that the original work is properly cited%
    \ifbool{@CCLicNC}{\ifboolexpr{ bool {@CCLicND} or bool {@CCLicSA} }{,}{ and} use is non-commercial}{}%
    \ifbool{@CCLicND}{\ifbool{@CCLicNC}{,}{} and no modification or adaptation is made}{}%
    \ifbool{@CCLicSA}{\ifbool{@CCLicNC}{,}{} and the modifications or adaptations are licensed under identical terms}{}%
  }{}.%
]{%
  Est\ifbool{Graduate}{a}{e} \DocumentTypeName\ifcsvoid{CCLicYear}{}{ \faCopyright[regular] \CCLicYear}%
  \ifcsvoid{CCLicCreator}{}{ de \CCLicCreator} está licenciad\ifbool{Graduate}{a}{o} sob %
  \href{\CCLicURL}{%
    Cre\-ative Com\-mons Atribuição%
    \ifbool{@CCLicNC}{\csuse{textendash}Não\-Co\-mer\-cial}{}%
    \ifbool{@CCLicND}{\csuse{textendash}Sem\-De\-ri\-va\-ções}{}%
    \ifbool{@CCLicSA}{\csuse{textendash}Com\-par\-ti\-lha\-Igual}{} %
    4.0 Internacional\ifboolexpr{ test {\ifcsvoid{CCLicYear}} and test {\ifcsvoid{CCLicCreator}} }{}{ \CCLicIcons}%
  }%
  \ifboolexpr{ test {\ifcsvoid{CCLicYear}} and test {\ifcsvoid{CCLicCreator}} }{, %
    que permite uso e distribuição em qualquer meio ou formato, %
    desde que o trabalho original seja devidamente citado%
    \ifbool{@CCLicNC}{\ifboolexpr{ bool {@CCLicND} or bool {@CCLicSA} }{,}{ e} o uso não seja comercial}{}%
    \ifbool{@CCLicND}{ e nenhuma modificação ou adaptação seja feita}{}%
    \ifbool{@CCLicSA}{ e as modificações ou adaptações sejam licenciadas sob termos idênticos}{}%
  }{}.%
}
%%%% Ficha Catalográfica
\AddToLang{IdxCardName}{Ficha Catalográfica}{Index Card}
\AddToLang{PDFCall}{Inserir Arquivo PDF}{Insert PDF File}
\AddToLang{DebibWrng}{%
  Elaborada pelo Departamento de Biblioteca%
}{%
  Elaborated by the Library Department%
}
\newcommand*{\TtlPgBack}{\clearforchapter}
\newcommand*{\IndexCardPDF}[2][./Pre-Textual/Extras/]{%
  \ifboolexpr{ bool {@VersionFinal} and bool {DScOrMSc} }{%
    \csgdef{TtlPgBack}{%
      \newpage%
      \begingroup%
      \ifbool{@twoside}{}{%
        \savepagenumber%
        \pagenumbering{gobble}%
        \setcounter{page}{2}%
        \booltrue{@twoside}%
        \booltrue{@mparswitch}%
      }%
      \ifblank{#2}{%
        \setlength{\fboxrule}{\heavyrulewidth}%
        \setlength{\fboxsep}{\p@}%
        \raggedright%
        \null\vfill%
        \fbox{%
          \begin{minipage}[c][75mm][c]{125mm}%
          \centering\scriptsize\color{gray}%
          \faAddressCard\space\fbox{\textbf{\MakeTextUppercase{\IdxCardName}}}\space\faAddressCard\vfill%
          \faBook\space\fbox{\DebibWrng}\space\faBook\vfill%
          \faFilePdf\space\fbox{\PDFCall\space\InPrep\space\texttt{#1}}\space\faFilePdf%
          \end{minipage}%
        }\vskip-\fboxsep%
      }{%
        \AddToShipoutPictureFG*{\AtPageLowerLeft{\includegraphics[width = \paperwidth, height = \paperheight]{#1#2}}}%
      }%
      \null%
      \clearpage%
      \endgroup%
      \ifbool{@twoside}{}{%
        \pagenumbering{roman}%
        \restorepagenumber%
      }%
    }%
  }{}%
}

%% Errata
\newcounter{alphpage}
\AddToLang{WhereItReads}{Onde se lê}{Where it reads}
\AddToLang{Read}{Leia-se}{Read}
\providecommand*{\errref}{Errata}
\NewDocumentEnvironment{Errata}{ O{} +b }{%
  \ifbool{@VersionFinal}{%
    \savepagenumber%
    \pagenumbering{alph}%
    \setlength{\parindent}{\z@}%
    \SectionPDFBookmark{\ifblank{#1}{Errata}{#1}}{err}%
    \aliaspagestyle{chapter}{empty}%
    \aliaspagestyle{cleared}{empty}%
    \ifbool{@VersionAbstract}{\booltrue{@WorkRef}}{}%
    \ifbool{@WorkRef}{%
      \begin{SingleSpace}%
      \raggedright%
      \ABNTStudentsList\space\TheTitle. \DepYearNum.\ifbool{@VersionAbstract}{}{ \thelastpage~\PgAbrv.} %
      \TheSubject\space\textemdash\space\UTFPRName, \CmpsName, \YearNum.%
      \end{SingleSpace}%
    }{%
      \vskip-1.5ex%
    }%
    \begingroup%
    \footnotesize%
    \begin{tabularx}{\textwidth}[t]{?{}p{30mm}*{2}{|X}?{}}%% CHKTEX 44
    \toprule%
    \multicolumn{1}{?{}c|}{\textbf{\Cref@page@name{(s)}}} &%
    \multicolumn{1}{c|}{\textbf{\WhereItReads}}           &%
    \multicolumn{1}{c?{}}{\textbf{\Read}}                 \\%
    \midrule%
    #2%
    \bottomrule%
    \end{tabularx}%
    \endgroup%
    \clearforchapter%
    \setcounter{alphpage}{\value{page}-1}%
    \pagenumbering{roman}%
    \restorepagenumber%
  }{}%
}{}
\csletcs{Errata*}{Errata}
\csletcs{endErrata*}{endErrata}
\AtBeginEnvironment{Errata*}{\booltrue{@WorkRef}}

%% Folha de Aprovação
\AddToLang{ApvlPgName}{Folha de Aprovação}{Approval Page}
\AddToLang{ApvlDateCall}{Data de aprovação}{Approval date}
\AddToLang{AcadSysWrng}{%
  Gerada pelo Sistema Acadêmico e sem Assinaturas%
}{%
  Generated by the Academic System and without Signatures%
}
\AddToLang{AcadSysWrngGrad}{%
  Documento gerado pelo Sistema Acadêmico da UTFPR a partir dos dados da Ata de Defesa em%
}{%
  Document generated by the UTFPR Academic System based on data from the Defense Act in%
}
\AddToLang{MECName}{Ministério da Educação}{Ministry of Education}
\providecommand*{\apvlpgref}{\ApvlPgName}
\newcommand*{\ApprovalPagePDF}[2][./Pre-Textual/Extras/]{%
  \ifboolexpr{ bool {@VersionFinal} or bool {@VersionAbstract} }{%
    \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
    \PDFBookmark{\ApvlPgName}{apvlpgpdf}%
    \global\csletcs{apvlpgref}{apvlpgpdfref}%
    \ifblank{#2}{%
      \noindent%
      \begin{minipage}[c][\textheight][c]{\textwidth}%
      \centering\color{gray}%
      \faFileSignature\space\fbox{\textbf{\MakeTextUppercase{\ApvlPgName}}}\space\faFileSignature\vfill%
      \faDatabase\space\fbox{\AcadSysWrng}\space\faDatabase\vfill%
      \faFilePdf\space\fbox{\PDFCall\space\InPrep\space\texttt{#1}}\space\faFilePdf%
      \end{minipage}%
    }{%
      \AddToShipoutPictureFG*{\AtPageLowerLeft{\includegraphics[width = \paperwidth, height = \paperheight]{#1#2}}}%
    }%
    \null%
    \clearforchapter%
  }{}%
}
\NewDocumentEnvironment{ApprovalPage}{ O{} O{} O{} O{} +b }{%
  \ifboolexpr{ bool {@VersionFinal} or bool {@VersionAbstract} }{%
    \ifblank{#1}{}{\IfLanguageName{#1}{}{\selectlanguage{#1}}}%
    \ifblank{#4}{}{\setlength{\SignLineWd}{#4}}%
    \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
    \PDFBookmark{\ApvlPgName}{apvlpg}%
    \begin{center}%
    \begin{minipage}[t][13\baselineskip][t]{\textwidth}%
    \Centering\bfseries%
    \ifbool{DScOrMSc}{%
      \begin{minipage}{35mm}%
      \raggedright\null%
      \includegraphics[width = 15mm]{republic-blazon}%
      \end{minipage}%
      \begin{minipage}{\linewidth-70mm}%
      \OnehalfSpacing\centering\footnotesize%
      \MECName\\%
      \UTFPRName\\%
      Campus \CmpsName%
      \end{minipage}%
      \begin{minipage}{35mm}%
      \raggedleft\null%
      \includegraphics[width = 30mm]{utfpr}%
      \end{minipage}%
      \vskip2\p@%
      {\color{UTFPRBlack}\hrule\@height0.5\p@}\vskip\p@%
      {\color{UTFPRYellow}\hrule\@height0.5\p@}%
      \strut\vfill%
    }{\strut}%
    \StudentsList[\MakeTextUppercase]{\\}{}%
    \vfill\strut%
    \end{minipage}%
    \par%
    \begin{Center}%
    \selectlanguage{\@TtlLang}\bfseries\MakeTextUppercase{\TheTitle}%
    \end{Center}%
    \end{center}%
    \vskip\baselineskip%
    \begin{SingleSpace}%
    \raggedleft\footnotesize%
    \begin{minipage}{0.5\textwidth}%
    \LessSloppy%
    #5%
    \end{minipage}%
    \ifnumgreater{\value{MmbrNum}}{0}{%
      \vskip\baselineskip%
      \parbox{\textwidth}{\centering\ApvlDateCall: \ifblank{#2}{\today}{#2}}\vfill%
      \MembersList*{\ifbool{DScOrMSc}{\vskip\baselineskip}{\vfill}}%
    }{}%
    \vfill%
    \ifbool{DScOrMSc}{%
      \parbox{\textwidth}{%
        \scriptsize%
        \AcadSysWrngGrad\ \ifblank{#3}{\two@digits{\the\day}/\two@digits{\the\month}/\YearNum}{#3}.%
      }\vskip\dimexpr\baselineskip-\belowdisplayskip%
    }{}%
    \end{SingleSpace}%
    \begingroup%
    \centering\bfseries%
    \MakeTextUppercase{\CmpsName}\\%
    \YearNum\\%
    \endgroup%
    \cleardoublepage%
  }{}%
}{}
\csletcs{ApprovalPage*}{ApprovalPage}
\csletcs{endApprovalPage*}{endApprovalPage}
\AtBeginEnvironment{ApprovalPage*}{\booltrue{@MmbrTtlAfter}}

%% Dedicatória
\AddToLang{DedName}{Dedicatória}{Dedication}
\providecommand*{\dedref}{\DedName}
\NewDocumentEnvironment{Dedication}{ O{} O{} +b }{%
  \ifbool{@VersionAbstract}{}{%
    \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
    \ifblank{#2}{%
      \ifblank{#1}{\null\vfill}{\ifdimgreater{#1}{\z@}{\null\vskip\dimexpr#1}{}}%
      \PDFBookmark{\DedName}{ded}%
    }{%
      \SectionPDFBookmark{#2}{ded}%
      \ifblank{#1}{\vfill}{\ifdimgreater{#1}{\z@}{\vskip\dimexpr#1}{\bigskip}}%
    }%
    \raggedleft%
    \begin{minipage}[b][][t]{0.5\textwidth}%
    \raggedleft%
    #3%
    \end{minipage}%
    \clearforchapter%
  }%
}{}

%% Agradecimentos
\AddToLang{AckName}{Agradecimentos}{Acknowledgments}
\AddToLang{FundingText}{%
  O presente trabalho foi realizado com apoio%
}{%
  This study was financed in part by the%
}
\NewDocumentCommand{\FundingAgency}{ m O{} }{\ifblank{#1}{}{\FundingText\ #1\ifblank{#2}{}{ \textemdash\ #2}.}}
\providecommand*{\ackref}{\AckName}
\NewDocumentEnvironment{Acknowledgments}{ O{} +b }{%
  \ifbool{@VersionAbstract}{}{%
    \SectionPDFBookmark{\ifblank{#1}{\AckName}{#1}}{ack}%
    #2%
    \clearforchapter%
  }%
}{}

%% Epígrafe
\newbool{@NoDisplayCitation}
\AddToLang{EpiName}{Epígrafe}{Epigraph}
\providecommand*{\epiref}{\EpiName}
\NewDocumentEnvironment{Epigraph}{ O{} O{} +b }{%
  \ifbool{@VersionAbstract}{}{%
    \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
    \ifblank{#2}{%
      \ifblank{#1}{\null\vfill}{\ifdimgreater{#1}{\z@}{\null\vskip\dimexpr#1}{}}%
      \PDFBookmark{\EpiName}{epi}%
    }{%
      \SectionPDFBookmark{#2}{epi}%
      \ifblank{#1}{\vfill}{\ifdimgreater{#1}{\z@}{\vskip\dimexpr#1}{\bigskip}}%
    }%
    \raggedleft%
    \begin{minipage}[b][][t]{0.5\textwidth}%
    \dimdef{\CitLeftSkip}{0.25\linewidth}%
    \ifbool{@NoDisplayCitation}{}{\csdisplaytrue}%
    #3%
    \end{minipage}%
    \clearforchapter%
  }%
}{}
\csletcs{Epigraph*}{Epigraph}
\csletcs{endEpigraph*}{endEpigraph}
\AtBeginEnvironment{Epigraph*}{\booltrue{@NoDisplayCitation}}
%%%% Epígrafe (alternativa) baseada na classe memoir
\setlength{\beforeepigraphskip}{\z@}
\setlength{\afterepigraphskip}{\z@}
\setlength{\epigraphwidth}{0.5\textwidth}
\setlength{\epigraphrule}{\z@}
\epigraphfontsize{\normalsize}
\epigraphtextposition{flushleftright}
\epigraphsourceposition{flushleftright}
\NewDocumentCommand{\EpiItem}{ O{\languagename} m m O{} }{%
  \begingroup%
  \raggedright\item%
  \begin{minipage}{\epigraphwidth}%
  \IfLanguageName{#1}{\@epitext{#3}}{\textit{\@epitext{#3}}}%
  \ifblank{#2}{}{\vskip0.5ex\@episource{#2\ifblank{#4}{}{\footnote{#4}}}}%
  \end{minipage}%
  \endgroup%
}
\NewDocumentEnvironment{Epigraphs}{ O{} O{} +b }{%
  \ifbool{@VersionAbstract}{}{%
    \ifbool{@TwoSideFront}{\OpenPageOdd}{}%
    \ifblank{#2}{%
      \ifblank{#1}{\null\vfill}{\ifdimgreater{#1}{\z@}{\null\vskip\dimexpr#1}{}}%
      \PDFBookmark{\EpiName}{epimmr}%
    }{%
      \SectionPDFBookmark{#2}{epimmr}%
      \ifblank{#1}{\vfill}{\ifdimgreater{#1}{\z@}{\vskip\dimexpr#1}{\bigskip}}%
    }%
    \global\csletcs{epiref}{epimmrref}%
    \begin{epigraphs}%
    \setlength{\itemsep}{\onelineskip}%
    \LessSloppy%
    #3%
    \end{epigraphs}%
    \clearforchapter%
  }%
}{}

%% Resumo
\newbool{@WorkRef}
\AddToLang{OriTitle}{%
  Título original: {\selectlanguage{english}\@Ttl\ifcsvoid{@SubTtl}{}{: \@SubTtl}}%
}{%
  Original title: {\selectlanguage{brazilian}\@Ttl\ifcsvoid{@SubTtl}{}{: \@SubTtl}}%
}
\AddToLang{ContactNotice}{%
  Autoriz\ifnumgreater{\value{StdtNum}}{1}{amos}{o} a disponibilização de correio eletrônico para contato%
}{%
  \ifnumgreater{\value{StdtNum}}{1}{We}{I} authorize the availability of e-mail for contact%
}
\newcommand*{\@ContactEmail}{}
\newcommand*{\ContactEmail}[1]{\ifblank{#1}{}{\renewcommand*{\@ContactEmail}{\href{mailto:#1}{\faEnvelope~#1}}}}
\providecommand*{\@AbsLang}{\bbl@main@language}
\providecommand*{\resref}{{\selectlanguage{brazilian}\abstractname}}
\providecommand*{\absref}{{\selectlanguage{english}\abstractname}}
\AtBeginDocument{%
  \abstractnum%
  \setlength{\absleftindent}{\z@}%
  \setlength{\absrightindent}{\z@}%
  \setlength{\absparindent}{\z@}%
  \renewcommand*{\abstracttextfont}{\normalfont\normalsize}%
  \renewcommand*{\num@bs}{%
    \ifcsstring{@AbsLang}{brazilian}{%
      \SectionPDFBookmark{Resumo}{res}%
      \csgdef{resref}{\titleref{res}}%
    }{%
      \SectionPDFBookmark{Abstract}{abs}%
      \csgdef{absref}{\titleref{abs}}%
    }%
  }%
}
\NewDocumentEnvironment{Abstract}{ O{\bbl@main@language} O{\bbl@main@language} }{%
  \ifblank{#1}{}{%
    \csdef{@AbsLang}{#1}%
    \IfLanguageName{#1}{}{\selectlanguage{#1}}%
    \ifcsstring{@TtlLang}{#1}{}{\csdef{Ori@Title}{\OriTitle}}%
  }%
  \ifbool{@VersionAbstract}{\booltrue{@WorkRef}}{}%
  \begin{abstract}%
  \SingleSpace%
  \ifbool{@WorkRef}{%
    \begin{flushleft}%
    \ifblank{#2}{\selectlanguage{\bbl@main@language}}{\selectlanguage{#2}}%
    \ABNTStudentsList\space{\selectlanguage{\@AbsLang}\TheTitle}. \DepYearNum.\ifbool{@VersionAbstract}{}{ \thelastpage~\PgAbrv.} %
    \TheSubject\space\textemdash\space\UTFPRName, \CmpsName, \YearNum.\ifcsvoid{Ori@Title}{}{ {\selectlanguage{\@AbsLang}\Ori@Title}.}%
    \end{flushleft}%
    \vskip\baselineskip%
  }{}%
}{%
  \vskip\baselineskip%
  {\KWCallFrmt{\KeywordsCall}:} \KeywordsList{; }{.}%
  \end{abstract}%
  \ifboolexpr{ bool {@VersionAbstract} and test {\ifcsvoid{Ori@Title}} }{%
    \vskip\baselineskip%
    \begin{minipage}{\textwidth}%
    \ContactNotice:\par%
    \ifcsvoid{@ContactEmail}{\faSquare[regular]}{\faCheckSquare[regular]}~\IfLanguageName{brazilian}{Sim}{Yes}%
    \ifcsvoid{@ContactEmail}{}{: \@ContactEmail}\par%
    \ifcsvoid{@ContactEmail}{\faCheckSquare[regular]}{\faSquare[regular]}~\IfLanguageName{brazilian}{Não}{No}%
    \end{minipage}%
  }{}%
  \clearforchapter%
}
\csletcs{Abstract*}{Abstract}
\csletcs{endAbstract*}{endAbstract}
\AtBeginEnvironment{Abstract*}{\booltrue{@WorkRef}}

%% Listas: algoritmos; ilustrações; tabelas
\newlistof{listofalgorithms}{loa}{\listalgorithmname}
\newlistof{listofflowcharts}{low}{\listflowchartname}
\newlistof{listofphotographs}{lop}{\listphotographname}
\newlistof{listofgraphs}{loh}{\listgraphname}
\newlistof{listoftabframeds}{lod}{\listtabframedname}
\newcommand*{\Flt@Chk}[1]{%
  \newbool{@print#1slist}%
  \AddToLang[captions]{list#1name}{Lista de \csuse{#1name}s}{List of \csuse{#1name}s}%
  \csdef{#1@in@doc}{%
    \immediate\write\@mainaux{\global\booltrue{@print#1slist}}%
    \global\csletcs{#1@in@doc}{empty}%
  }%
  \cspreto{#1}{\csuse{#1@in@doc}}%
  \csdef{\csuse{ext@#1}ref}{\csuse{list#1name}}%
}
\forcsvlist{\Flt@Chk}{algorithm, figure, flowchart, photograph, graph, tabframed, table}
\newcommand*{\LoX@Entry}[1]{\newlistentry{#1}{\csuse{ext@#1}}{0}}
\forcsvlist{\LoX@Entry}{algorithm, flowchart, photograph, graph, tabframed}
\newcommand*{\LoX@Fmt}[1]{%
  \csdef{cft#1name}{\csuse{#1name}\space}%
  \csdef{cft#1aftersnum}{\hfill\textendash\hfill}%
  \csdef{cft#1font}{\bfseries}%
  \csdef{cft#1leader}{\bfseries\cftdotfill{\csuse{cft#1dotsep}}}%
  \csdef{cft#1pagefont}{\bfseries}%
}
\AtBeginDocument{\forcsvlist{\LoX@Fmt}{algorithm, figure, flowchart, photograph, graph, tabframed, table}}
\newcommand*{\PrintFloatsList}[1]{%
  \ifbool{@print#1slist}{%
    \cftinserthook{\csuse{ext@#1}}{ToCLoXConf}%
    \PDFBookmark{\csuse{list#1name}}{\csuse{ext@#1}}%
    \csuse{listof#1s}*%
    \clearforchapter%
  }{}%
}
\renewcommand*{\insertchapterspace}{}
%%%% Lista de Ilustrações
\newbool{@printillustrationslist}
\AddToLang[captions]{listillustrationname}{Lista de Ilustrações}{List of Illustrations}
\providecommand*{\loiref}{\listillustrationname}
\newcommand*{\LoI@Cfg}[1]{%
  \ifbool{@print#1slist}{%
    \csletcs{list#1name}{relax}%
    \cftinserthook{\csuse{ext@#1}}{ToCLoXConf}%
    \csdef{after\csuse{ext@#1}title}{\vskip\z@}%
    \ifbool{@printillustrationslist}{}{\booltrue{@printillustrationslist}}%
  }{}%
}
\newcommand*{\@LoI}[1]{\ifbool{@print#1slist}{\csuse{listof#1s}*}{}}
\newcommand*{\PrintIllustrationsList}[1]{%
  \begingroup%
  \forcsvlist{\LoI@Cfg}{#1}%
  \ifbool{@printillustrationslist}{\SectionPDFBookmark{\listillustrationname}{loi}}{}%
  \forcsvlist{\@LoI}{#1}%
  \endgroup%
  \clearforchapter%
}

%% Listas: abreviaturas e siglas; símbolos
\AddToLang{UnclName}{Não Classificados}{Unclassifieds}
%%%% Abreviaturas e siglas
\newcommand*{\Acr@Entry}[1]{%
  \csdef{New#1Entry}##1##2{%
    \ifblank{##2}{}{%
      \ifstrequal{#1}{Abbreviation}{\csdef{GTag}{Abrv@##1}}{}%
      \ifstrequal{#1}{Initials}{\csdef{GTag}{Intl@##1}}{}%
      \setkeys{Glossary}{%
        Key         = {##1},%
        Translation = {},%
        Term        = {},%
        Description = {},%
        Plural      = {},%
        Parent      = {},%
        Unit        = {},%
        Type        = {Acronym},%
        AcronymType = {#1},%
        SymbolType  = {},%
        ##2,%
      }%
      \csundef{GTag}%
    }%
  }%
}
\forcsvlist{\Acr@Entry}{Abbreviation, Initials}
%%%%%% Abreviaturas
\AddToLang{AbrvName}{Abreviaturas}{Abbreviations}
\NewDocumentCommand{\abrv}{ s m }{\IfBooleanTF{#1}{\gly*{Abrv@#2}}{\gly{Abrv@#2}}}
\NewDocumentCommand{\Abrv}{ s m }{\IfBooleanTF{#1}{\Gly*{Abrv@#2}}{\Gly{Abrv@#2}}}
\NewDocumentCommand{\abrvpl}{ s m }{\IfBooleanTF{#1}{\glypl*{Abrv@#2}}{\glypl{Abrv@#2}}}
\NewDocumentCommand{\AbrvPl}{ s m }{\IfBooleanTF{#1}{\GlyPl*{Abrv@#2}}{\GlyPl{Abrv@#2}}}
\NewDocumentCommand{\abrvdescr}{ t{+} s m }{%
  \ignorespaces%
  \IfBooleanTF{#1}{%
    \ENLang*{\csuse{Abrv@#3Sort}}%
    \IfBooleanT{#2}{\index{\csuse{Abrv@#3Sort}?\ENLang*{\csuse{Abrv@#3Sort}}}}%
  }{
    \glydescr{Abrv@#3}\IfBooleanT{#2}{\index{\csuse{Abrv@#3Descr}}}%
  }%
}
\NewDocumentCommand{\AbrvDescr}{ t{+} s m }{%
  \ignorespaces%
  \IfBooleanTF{#1}{%
    \ENLang*{\emakefirstuc{\csuse{Abrv@#3Sort}}}%
    \IfBooleanT{#2}{\index{\csuse{Abrv@#3Sort}?\ENLang*{\csuse{Abrv@#3Sort}}}}%
  }{
    \GlyDescr{Abrv@#3}\IfBooleanT{#2}{\index{\csuse{Abrv@#3Descr}}}%
  }%
}
%%%%%% Siglas
\AddToLang{IntlName}{Siglas}{Initials}
\NewDocumentCommand{\intl}{ s m }{\IfBooleanTF{#1}{\gly*{Intl@#2}}{\gly{Intl@#2}}}
\NewDocumentCommand{\Intl}{ s m }{\IfBooleanTF{#1}{\Gly*{Intl@#2}}{\Gly{Intl@#2}}}
\NewDocumentCommand{\intlpl}{ s m }{\IfBooleanTF{#1}{\glypl*{Intl@#2}}{\glypl{Intl@#2}}}
\NewDocumentCommand{\IntlPl}{ s m }{\IfBooleanTF{#1}{\GlyPl*{Intl@#2}}{\GlyPl{Intl@#2}}}
\NewDocumentCommand{\intldescr}{ t{+} s m }{%
  \ignorespaces%
  \IfBooleanTF{#1}{%
    \ENLang*{\csuse{Intl@#3Sort}}%
    \IfBooleanT{#2}{\index{\csuse{Intl@#3Sort}?\ENLang*{\csuse{Intl@#3Sort}}}}%
  }{
    \glydescr{Intl@#3}\IfBooleanT{#2}{\index{\csuse{Intl@#3Descr}}}%
  }%
}
\NewDocumentCommand{\IntlDescr}{ t{+} s m }{%
  \ignorespaces%
  \IfBooleanTF{#1}{%
    \ENLang*{\emakefirstuc{\csuse{Intl@#3Sort}}}%
    \IfBooleanT{#2}{\index{\csuse{Intl@#3Sort}?\ENLang*{\csuse{Intl@#3Sort}}}}%
  }{
    \GlyDescr{Intl@#3}\IfBooleanT{#2}{\index{\csuse{Intl@#3Descr}}}%
  }%
}
%%%% Lista de Abreviaturas e Siglas
\newbool{@PrintAcrHdg}
\newbool{@PrevAcrList}
\AddToLang{AcrLstName}{%
  Lista de Abreviaturas e Siglas%
}{%
  List of Abbreviations and Initials%
}
\AddToLang{AcronymsListName}{%
  Lista de %
  \ifbool{@printabrvttl}{%
    \ifbool{@printintlttl}{\AbrvName\ e \IntlName}{\AbrvName}%
  }{%
    \ifbool{@printintlttl}{\IntlName}{\UnclName}%
  }%
}{%
  List of %
  \ifbool{@printabrvttl}{%
    \ifbool{@printintlttl}{\AbrvName\ and \IntlName}{\AbrvName}%
  }{%
    \ifbool{@printintlttl}{\IntlName}{\UnclName}%
  }%
}
\newcommand*{\Acr@In@Doc}[1]{%
  \newbool{@print#1ttl}%
  \csdef{#1@in@doc}{%
    \immediate\write\@mainaux{\global\booltrue{@print#1ttl}}%
    \global\csletcs{#1@in@doc}{empty}%
  }%
}
\forcsvlist{\Acr@In@Doc}{abrv, intl}
\newcommand*{\AcrHdg}[1]{%
  \ifbool{@PrintAcrHdg}{%
    \ifstrequal{#1}{0}{\SectionPDFBookmark[section]{\UnclName}{unclacr}}{%
      \ifstrequal{#1}{A}{\SectionPDFBookmark[section]{\AbrvName}{abrvacr}}{%
        \ifstrequal{#1}{B}{\SectionPDFBookmark[section]{\IntlName}{intlacr}}{}%
      }%
    }%
  }{%
    \ifstrequal{#1}{0}{\booltrue{@PrevAcrList}}{%
      \ifstrequal{#1}{Acrn@}{\ifbool{@PrevAcrList}{\vskip-\baselineskip}{\booltrue{@PrevAcrList}}}{}%
    }%
  }%
}
\NewDocumentCommand{\MakeAcronyms}{ s O{} }{%
  \IfBooleanTF{#1}{\booltrue{@PrintAcrHdg}}{\boolfalse{@PrintAcrHdg}}%
  \ifblank{#2}{\MakeGlossary[][acr]}{\MakeGlossary[#2][acr]}%
}
\newcommand*{\PrintAcronymsList}{\printglossary[acr]}
\providecommand*{\acrref}{\AcrLstName}
\newcommand*{\AcronymsListLabelFont}[1]{\normalfont#1}
\newenvironment*{AcronymsList}[1][]{%
  \SectionPDFBookmark{\ifblank{#1}{\AcrLstName}{#1}}{acrlst}%
  \global\csletcs{acrref}{acrlstref}%
  \vskip-0.5\onelineskip%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = multiline,%
    font          = \AcronymsListLabelFont,%
    first         = \SingleSpacing,%
    leftmargin    = 0.15\linewidth,%
    listparindent = -\leftmargin,%
  ]%
}{%
  \end{description}%
  \clearforchapter%
}
%%%% Símbolos
\newcommand*{\Sym@Entry}[1]{%
  \csdef{New#1Entry}##1##2{%
    \ifblank{##2}{}{%
      \ifstrequal{#1}{Notation}{\csdef{GTag}{Nttn@##1}}{}%
      \ifstrequal{#1}{Superscript}{\csdef{GTag}{Sprs@##1}}{}%
      \ifstrequal{#1}{Subscript}{\csdef{GTag}{Sbsc@##1}}{}%
      \ifstrequal{#1}{GreekLetter}{\csdef{GTag}{GrkL@##1}}{}%
      \ifstrequal{#1}{LatinLetter}{\csdef{GTag}{LtnL@##1}}{}%
      \setkeys{Glossary}{%
        Key         = {##1},%
        Sort        = {},%
        Term        = {},%
        Description = {},%
        Plural      = {},%
        Parent      = {},%
        Unit        = {},%
        Type        = {Symbol},%
        AcronymType = {},%
        SymbolType  = {#1},%
        ##2,%
      }%
      \csundef{GTag}%
    }%
  }%
}
\forcsvlist{\Sym@Entry}{Notation, Superscript, Subscript, GreekLetter, LatinLetter}
%%%%%% Notações
\AddToLang{NttnName}{Notações}{Notations}
\newcommand*{\MrkSym}{\DottedCircle}
\newcommand*{\Phantom}[1][A]{\protect\phantom{#1}}
\NewDocumentCommand{\nttn}{ s m O{} }{%
  \ifblank{#3}{%
    \csdef{@MrkSym}{}%
  }{%
    \csdef{@MrkSym}{#3}%
  }%
  \IfBooleanTF{#1}{\gly*{Nttn@#2}}{\gly{Nttn@#2}}%
}
\NewDocumentCommand{\nttndescr}{ s m }{\glydescr{Nttn@#2}\IfBooleanT{#1}{\index{\csuse{Nttn@#2Descr}}}}
\NewDocumentCommand{\NttnDescr}{ s m }{\GlyDescr{Nttn@#2}\IfBooleanT{#1}{\index{\csuse{Nttn@#2Descr}}}}
\newcommand*{\nttnunit}[1]{\ifblank{#1}{}{\ifcsvoid{Nttn@#1Unit}{}{\csuse{Nttn@#1Unit}}}}
%%%%%% Sobrescritos
\AddToLang{SprsName}{Sobrescritos}{Superscripts}
\NewDocumentCommand{\sprs}{ s m }{\IfBooleanTF{#1}{\gly*{Sprs@#2}}{\gly{Sprs@#2}}}
\NewDocumentCommand{\sprsdescr}{ s m }{\glydescr{Sprs@#2}\IfBooleanT{#1}{\index{\csuse{Sprs@#2Descr}}}}
\NewDocumentCommand{\SprsDescr}{ s m }{\GlyDescr{Sprs@#2}\IfBooleanT{#1}{\index{\csuse{Sprs@#2Descr}}}}
\newcommand*{\sprsunit}[1]{\ifblank{#1}{}{\ifcsvoid{Sprs@#1Unit}{}{\csuse{Sprs@#1Unit}}}}
%%%%%% Subscritos
\AddToLang{SbscName}{Subscritos}{Subscripts}
\NewDocumentCommand{\sbsc}{ s m }{\IfBooleanTF{#1}{\gly*{Sbsc@#2}}{\gly{Sbsc@#2}}}
\NewDocumentCommand{\sbscdescr}{ s m }{\glydescr{Sbsc@#2}\IfBooleanT{#1}{\index{\csuse{Sbsc@#2Descr}}}}
\NewDocumentCommand{\SbscDescr}{ s m }{\GlyDescr{Sbsc@#2}\IfBooleanT{#1}{\index{\csuse{Sbsc@#2Descr}}}}
\newcommand*{\sbscunit}[1]{\ifblank{#1}{}{\ifcsvoid{Sbsc@#1Unit}{}{\csuse{Sbsc@#1Unit}}}}
%%%%%% Letras gregas
\AddToLang{GrkLName}{Letras gregas}{Greek letters}
\NewDocumentCommand{\grkl}{ s m }{\IfBooleanTF{#1}{\gly*{GrkL@#2}}{\gly{GrkL@#2}}}
\NewDocumentCommand{\grkldescr}{ s m }{\glydescr{GrkL@#2}\IfBooleanT{#1}{\index{\csuse{GrkL@#2Descr}}}}
\NewDocumentCommand{\GrkLDescr}{ s m }{\GlyDescr{GrkL@#2}\IfBooleanT{#1}{\index{\csuse{GrkL@#2Descr}}}}
\newcommand*{\grklunit}[1]{\ifblank{#1}{}{\ifcsvoid{GrkL@#1Unit}{}{\csuse{GrkL@#1Unit}}}}
%%%%%% Letras latinas
\AddToLang{LtnLName}{Letras latinas}{Latin letters}
\NewDocumentCommand{\ltnl}{ s m }{\IfBooleanTF{#1}{\gly*{LtnL@#2}}{\gly{LtnL@#2}}}
\NewDocumentCommand{\ltnldescr}{ s m }{\glydescr{LtnL@#2}\IfBooleanT{#1}{\index{\csuse{LtnL@#2Descr}}}}
\NewDocumentCommand{\LtnLDescr}{ s m }{\GlyDescr{LtnL@#2}\IfBooleanT{#1}{\index{\csuse{LtnL@#2Descr}}}}
\newcommand*{\ltnlunit}[1]{\ifblank{#1}{}{\ifcsvoid{LtnL@#1Unit}{}{\csuse{LtnL@#1Unit}}}}
%%%% Lista de Símbolos
\newbool{@PrintSymHdg}
\newbool{@PrevSymList}
\newbool{@UnitRightMargin}
\AddToLang{SymbolsListName}{Lista de Símbolos}{List of Symbols}
\newcommand*{\SymHdg}[1]{%
  \ifbool{@PrintSymHdg}{%
    \ifstrequal{#1}{0}{\SectionPDFBookmark[section]{\UnclName}{unclsym}}{%
      \ifstrequal{#1}{A}{\SectionPDFBookmark[section]{\NttnName}{nttnsym}}{%
        \ifstrequal{#1}{B}{\SectionPDFBookmark[section]{\SprsName}{sprssym}}{%
          \ifstrequal{#1}{C}{\SectionPDFBookmark[section]{\SbscName}{sbscsym}}{%
            \ifstrequal{#1}{D}{\SectionPDFBookmark[section]{\GrkLName}{grklsym}}{%
              \ifstrequal{#1}{E}{\SectionPDFBookmark[section]{\LtnLName}{ltnlsym}}{}%
            }%
          }%
        }%
      }%
    }%
  }{%
    \ifstrequal{#1}{0}{\booltrue{@PrevSymList}}{%
      \ifstrequal{#1}{Symb@}{\ifbool{@PrevSymList}{\vskip-\baselineskip}{\booltrue{@PrevSymList}}}{}%
    }%
  }%
}
\NewDocumentCommand{\MakeSymbols}{ s O{} }{%
  \IfBooleanTF{#1}{\booltrue{@PrintSymHdg}}{\boolfalse{@PrintSymHdg}}%
  \ifblank{#2}{\MakeGlossary[][sym]}{\MakeGlossary[#2][sym]}%
}
\NewDocumentCommand{\PrintSymbolsList}{ s }{%
  \IfBooleanTF{#1}{\booltrue{@UnitRightMargin}}{\boolfalse{@UnitRightMargin}}%
  \printglossary[sym]%
}
\providecommand*{\symref}{\SymbolsListName}
\newcommand*{\SymbolsListLabelFont}[1]{\ensuremath{#1}}
\newenvironment*{SymbolsList}[1][]{%
  \SectionPDFBookmark{\ifblank{#1}{\SymbolsListName}{#1}}{symlst}%
  \global\csletcs{symref}{symlstref}%
  \vskip-0.5\onelineskip%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = multiline,%
    font          = \SymbolsListLabelFont,%
    first         = \SingleSpacing,%
    leftmargin    = 0.15\linewidth,%
    listparindent = -\leftmargin,%
  ]%
}{%
  \end{description}%
  \clearforchapter%
}

%% Sumário
\AddToLang[captions]{contentsname}{}{Summary}
\newcommand*{\Part@Chap@U@ToC}[1]{%
  \settocpreprocessor{#1}{%
    \csletcs{tempf@rtoc}{f@rtoc}%
    \csdef{f@rtoc}{\MakeTextUppercase{\tempf@rtoc}}%
  }%
}
\forcsvlist{\Part@Chap@U@ToC}{part, chapter}
\csletcs{old@numberline}{numberline}
\csletcs{old@contentsline}{contentsline}
\renewcommand*{\contentsline}[3]{%
  \ifcsequal{l@#1}{l@subsubsection}{%
    \csletcs{numberline}{uline@numberline}%
  }{%
    \csletcs{numberline}{old@numberline}%
  }%
  \old@contentsline{#1}{#2}{#3}%
}
\newcommand*{\uline@numberline}[1]{%
  \numberlinehook{#1}%
  \numberlinebox\@tempdima{\@cftn@me\@cftbsnum\uline{#1}\@cftasnum}\@cftasnumb%
}
\newlength{\cftlastnumwidth}
\setlength{\cftlastnumwidth}{\cftsubsubsectionnumwidth}
\setpnumwidth{2em}
\addtolength{\cftlastnumwidth}{1em}
\newcommand*{\cft@set@indents}[1]{\cftsetindents{#1}{\z@}{\cftlastnumwidth}}
\forcsvlist{\cft@set@indents}{part, chapter, section, subsection, subsubsection, paragraph, subparagraph}
\renewcommand*{\cftpartbreak}{%
  \addpenalty{-\@highpenalty}%
  \vskip\cftbeforepartskip%
}
\renewcommand*{\cftpartfont}{\normalfont\normalsize\bfseries}
\renewcommand*{\cftpartdotsep}{\cftdotsep}
\renewcommand*{\cftpartpagefont}{\cftpartfont}
\renewcommand*{\cftchapterdotsep}{\cftdotsep}
\renewcommand*{\cftsectionfont}{\normalfont\normalsize\bfseries}
\renewcommand*{\cftsectionleader}{\bfseries\cftdotfill{\cftsectiondotsep}}
\renewcommand*{\cftsectionpagefont}{\bfseries}
\renewcommand*{\cftsubsubsectionformatpnum}[1]{%
  \cftsubsubsectionformatpnumhook{#1}%
  \hb@xt@\@pnumwidth{\hfil{\cftsubsubsectionpagefont\uline{#1}}}%
}
\renewcommand*{\cftparagraphfont}{\normalfont\normalsize\emph}
\renewcommand*{\cftparagraphformatpnum}[1]{%
  \cftparagraphformatpnumhook{#1}%
  \hb@xt@\@pnumwidth{\hfil{\cftparagraphpagefont\itshape#1}}%
}
\cftinsertcode{ToCLoXConf}{%
  \LessSloppy%
  \SingleSpace%
}
\providecommand*{\tocref}{\contentsname}
\NewDocumentCommand{\PrintSummary}{ s }{%
  \IfBooleanTF{#1}{%
    \setlength{\cftbeforepartskip}{\z@}%
    \setlength{\cftbeforechapterskip}{\z@}%
  }{%
    \setlength{\cftbeforepartskip}{1ex}%
    \setlength{\cftbeforechapterskip}{1ex}%
    \addtocontents{toc}{\vskip-1ex}%
  }%
  \cftinserthook{toc}{ToCLoXConf}%
  \PDFBookmark{\contentsname}{toc}%
  \tableofcontents*%
  \clearforchapter%
}

%% Elementos textuais
\newcommand*{\Textual}{%
  \MakeList{6}{KW}{%
    \protected@csxappto{TheKeywords}{%
      \csuse{KW\Alph{KWCtr}}%
      \ifnumless{\value{KWCtr}}{\value{KWTmp}}{, }{}%
    }%
  }%
  \pdfstringdef{\@TheKeywords}{\TheKeywords}%
  \ifbool{xetex}{%
    \special{pdf:docinfo<</Keywords (\@TheKeywords)>>}%
  }{%
    \ifbool{luatex}{\protected@csxdef{pdfinfo}{\pdfextension info}}{}%% CHKTEX 1
    \pdfinfo{/Keywords (\@TheKeywords)}%
  }%
  \ifbool{@TwoSideMain}{%
    \booltrue{@twoside}%
    \booltrue{@mparswitch}%
  }{}%
  \csgappto{@smemmain}{\savepagenumber}%
  \csgappto{@memmain}{\restorepagenumber}%
  \mainmatter%
  \ifbool{@PageNumMain}{%
    \pagestyle{ABNTHdg}%
    \aliaspagestyle{chapter}{ABNTHdg}%
    \aliaspagestyle{cleared}{ABNTHdg}%
    \aliaspagestyle{part}{ABNTHdg}%
    \nopartblankpage%
  }{%
    \pagestyle{empty}%
    \aliaspagestyle{chapter}{empty}%
    \aliaspagestyle{cleared}{empty}%
    \aliaspagestyle{part}{empty}%
  }%
  \chapterstyle{NumberedChapter}%
}

%% Elementos pós-textuais
\newbool{@ToCDepthZero}
\NewDocumentCommand{\PostTextual}{ s }{%
  \IfBooleanTF{#1}{\booltrue{@ToCDepthZero}}{\boolfalse{@ToCDepthZero}}%
  \backmatter%
  \booltrue{@mainmatter}%
  \setcounter{secnumdepth}{\value{maxsecnumdepth}}%
  \ifbool{@ToCDepthZero}{%
    \setcounter{tocdepth}{0}%
    \settocdepth{chapter}%
    \maxtocdepth{chapter}%
    \hypersetup{bookmarksdepth = 0}%
  }{}%
  \PhantomPart%
  \chapterstyle{UnnumberedChapter}%
}
\newcommand*{\AddToToC}[3][chapter]{%
  \ifblank{#2}{}{%
    \phantomsection%
    \ifnumless{\csuse{toclevel@#1}}{1}{%
      \addcontentsline{toc}{#1}{\MakeTextUppercase{#2}}%
    }{%
      \addcontentsline{toc}{#1}{%
        \texorpdfstring{\protect\numberline{}}{}%
        \ifcsequal{l@#1}{l@subsubsection}{\uline{#2}}{\ifcsequal{l@#1}{l@paragraph}{\textit{#2}}{#2}}%
      }%
    }%
    \ifblank{#3}{}{\HyperTarget{#3}{}}%
  }%
}

%% Citações e referências
\setlength{\bibitemsep}{\onelineskip}%% ABNT NBR 6023:2018
\AtBeginBibliography{\SingleSpace\vskip-\bibitemsep}%% ABNT NBR 6023:2018
% \AtEveryCitekey{\hyphenrules{nohyphenation}}%% Desativa hifenização em rótulos
\DeclareLanguageMapping{brazilian}{brazilian-abnt}
\DeclareLanguageMapping{english}{english-abnt}
\DeclareLanguageMappingSuffix{}
\NewBibliographyString{%
  apud,%% ABNT NBR 10520:2023
  sheettotal,%
  sheettotals,%
  sineloco,%
  sinenomine,%
}
\DefineBibliographyStrings{brazilian}{%
  apud        = {\textit{apud}},%% ABNT NBR 10520:2023
  sineloco    = {s\adddot~l\adddot},%
  sinenomine  = {s\adddot~n\adddot},%
}
\DefineBibliographyStrings{english}{%
  apud        = {\textit{apud}},%% ABNT NBR 10520:2023
  sheettotal  = {s\adddot},%
  sheettotals = {s\adddot},%
  sineloco    = {s\adddot~l\adddot},%
  sinenomine  = {s\adddot~n\adddot},%
}
\xpretofieldformat{pages}{\midsentence}{}{}
\xpatchbibmacro{in:}{%% ABNT NBR 6023:2018
  \bibstring{in}%
}{%
  \mkbibemph{\bibstring{in}}%
}{}{}
\xpatchbibmacro{name:andothers}{%% ABNT NBR 6023:2018
  \bibstring{andothers}%
}{%
  \mkbibemph{\bibstring{andothers}}%
}{}{}
\xpatchbibmacro{location}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
}{}{}
\xpatchbibmacro{venue}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
}{}{}
\xpatchbibmacro{publisher}{%% ABNT NBR 6023:2018
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\xpatchbibmacro{publisher+location+date}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
  \setunit{\addcolon\addnbspace}%
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
  \setunit{\addcolon\addnbspace}%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\xpatchbibmacro{publisher+location+issue+date}{%% ABNT NBR 6023:2018
  \bibstring{sineloco}%
  \setunit{\addcolon\addnbspace}%
  \bibstring{sinenomine}%
}{%
  \mkbibemph{\bibstring{sineloco}}%
  \setunit{\addcolon\addnbspace}%
  \mkbibemph{\bibstring{sinenomine}}%
}{}{}
\ifbool{@ABNTCitNRB}{%
  \csletcs{multinamedelim}{multinamedelimorig}%
  \csletcs{finalnamedelim}{finalnamedelimorig}%
  \newrobustcmd{\mkbibparensorig}[1]{%
    \begingroup%
    \blx@blxinit%
    \blx@setsfcodes%
    \blx@bibopenparen#1\blx@bibcloseparen%
    \endgroup%
  }%
  \DeclareCiteCommand{\apud}[\mkbibparens]{%
    \usebibmacro{cite:init}%
    \iffieldundef{prenote}{}{%
      \ifnumgreater{\value{multicitetotal}}{1}{%
        \usebibmacro{prenote}%
      }{%
        \printfield{prenote}%
        \isdot\addspace\bibstring{apud}\addspace%
      }%
    }%
  }{%
    \usebibmacro{citeindex}%
    \usebibmacro{cite:comp}%
  }{\iftoggle{comp}{}{\multicitedelim}}{%
    \usebibmacro{cite:dump}%
    \usebibmacro{postnote}%
  }%
  \DeclareCiteCommand{\citeauthor}[\mkbibparensorig]{%
    \boolfalse{citetracker}%
    \boolfalse{pagetracker}%
    \usebibmacro{prenote}%
  }{%
    \ifciteindex{\indexnames{labelname}}{}%
    \printtext[bibhyperref]{\printnames{labelname}}%
  }{\multicitedelim}{\usebibmacro{postnote}}%
  \DeclareCiteCommand*{\citeauthor}{%
    \boolfalse{citetracker}%
    \boolfalse{pagetracker}%
    \usebibmacro{prenote}%
  }{%
    \ifciteindex{\indexnames{labelname}}{}%
    \printtext[bibhyperref]{\printnames{labelname}}%
  }{\multicitedelim}{\usebibmacro{postnote}}%
  \DeclareCiteCommand{\citeyear}[\mkbibparensorig]{%
    \boolfalse{citetracker}%
    \boolfalse{pagetracker}%
    \usebibmacro{prenote}%
  }{\printfield[bibhyperref]{year}}{\multicitedelim}{\usebibmacro{postnote}}%
  \DeclareCiteCommand*{\citeyear}{%
    \boolfalse{citetracker}%
    \boolfalse{pagetracker}%
    \usebibmacro{prenote}%
  }{\printfield[bibhyperref]{year}}{\multicitedelim}{\usebibmacro{postnote}}%
}{%
  \xpatchbibmacro{textcite}{%
    \ifnumequal{\value{textcitecount}}{\value{textcitetotal}-1}{%
      \finalnamedelim%
    }{%
      \multinamedelim%
    }%
  }{%
    \textcitedelim%
  }{}{}%
  \DeclareCiteCommand{\@apud}{%% ABNT NBR 10520:2023
    \usebibmacro{cite:init}%
    \iffieldundef{prenote}{}{%
      \ifnumgreater{\value{multicitetotal}}{1}{%
        \usebibmacro{prenote}%
      }{%
        \printfield{prenote}%
        \isdot\addspace\bibstring{apud}\addspace%
      }%
    }%
  }{%
    \usebibmacro{citeindex}%
    \usebibmacro{apud}%
  }{\setunit{\multicitedelim}}{\usebibmacro{postnote}}%
  \DeclareCiteCommand*{\citeauthor}{%
    \boolfalse{citetracker}%
    \boolfalse{pagetracker}%
    \usebibmacro{prenote}%
    \csletcs{mkbibnamefamily}{origmkbibnamefamily}%
    \csletcs{mkbibnamegiven}{origmkbibnamegiven}%
    \csletcs{mkbibnameprefix}{origmkbibnameprefix}%
    \csletcs{mkbibnamesuffix}{origmkbibnamesuffix}%
    \csletcs{multinamedelim}{multinamedelimorig}%
    \csletcs{finalnamedelim}{finalnamedelimorig}%
  }{%
    \ifciteindex{\indexnames{labelname}}{}%
    \printtext[bibhyperref]{\printnames{labelname}}%
  }{\multicitedelim}{\usebibmacro{postnote}}%
}
\ifbool{@ABNTCitNSB}{%
  \csletcs{mkbibparens}{mkbibbrackets}%
  \csletcs{bibopenparen}{bibopenbracket}%
  \csletcs{bibcloseparen}{bibclosebracket}%
  \DeclareFieldFormat{labelnumberwidth}{\mkbibbrackets{#1}}%
}{}
\DeclareFieldFormat{firstword}{%% ABNT NBR 10520:2023
  \iftoggle{sccite}{%
    \normalfont\textsc{\MakeLowercase{\FirstWord{#1}}}\space[\ldots]\isdot%
  }{%
    \normalfont\FirstWord{#1}\space[\ldots]\isdot%
  }%
}
\DeclareFieldFormat{doi}{%
  \ifbool{@DOIIconOn}{\MakeIcon{doi}\addnbspace}{}\mkbibacro{DOI}\addcolon\space%
  \ifhyperref{\href{https://doi.org/#1}{\nolinkurl{#1}}}{\nolinkurl{#1}}%
}
\DeclareFieldFormat{url}{%% ABNT NBR 6023:2018
  \ifbool{@URLIconOn}{\faExternalLinkSquare*\addnbspace\mkbibacro{URL}}{\bibstring{urlfrom}}\addcolon\space%
  \url{#1}%
}
\defbibheading{bibliography}[\refname]{%
  \ifmemoirbibintoc{%
    \addtocontents{toc}{\cftsetindents{chapter}{\cftlastnumwidth}{2em}}%
    \AddToToC{#1}{ref}%
  }{}%
  \chapter*{#1}%
  \label{ref}%
}
\csletcs{PrintReferences}{printbibliography}
\newcommand*{\refref}{\HyperLink{ref}{\refname}}
\newcommand*{\etal}{\textit{et al}.}%% ABNT NBR 10520:2023
\renewcommand*{\mkbibnamefamily}[1]{#1}%% ABNT NBR 10520:2023

%% Glossário
\newcommand*{\gly@err}[2]{%
  \PackageWarning{utfpr-thesis}{%
    undefined #1 for label #2\MessageBreak%
    in an entry of Abbreviation, Initials, Symbol,\MessageBreak%
    or Glossary%
  }%
  \textbf{#2}%
}
\renewcommand*{\mfirstucMakeUppercase}{\MakeTextUppercase}
%%%% Arquivo de estilo de glossário makeindex
\begin{verbatimoutput}{\jobname.gst}
%% \jobname.gst makeindex glossary style file
%%%% Output style parameters
preamble "\\begin{theglossary}\n"
postamble "\n\n\\end{theglossary}\n"
group_skip "\n\n\\glossaryspace\n"
heading_prefix "\n\\GlyHdg{"
heading_suffix "}"
headings_flag 1
item_0 "\n  \\glossitem "
delim_0 "{\\memglonum{"
delim_1 "{\\memglonum{"
delim_2 "{\\memglonum{"
delim_t "}}"
line_max 1000
indent_space ""
%%%% Input style parameters
keyword "\\glossaryentry"
actual '?'
\end{verbatimoutput}
\ifpatchable*{\@ctualm@mwritetoglo}{%
  \xpatchcmd{\@ctualm@mwritetoglo}{%
    \immediate\write\memglofile%
  }{%
    \immediate@protected@write\memglofile{}%
  }{}{}%
}{}
%%%% Itens de glossário
\newcounter{SymCtr}
\define@key{Glossary}{Key}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Key}{#1}}}}
\define@key{Glossary}{Sort}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Sort}{#1}}}}
\define@key{Glossary}{Term}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Term}{#1}}}}
\define@key{Glossary}{Description}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Descr}{#1}}}}
\define@key{Glossary}{Plural}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Plural}{#1}}}}
\define@key{Glossary}{Parent}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Parent}{#1}}}}
\define@key{Glossary}{Unit}{\ifcsvoid{GTag}{}{\ifblank{#1}{}{\csdef{\csuse{GTag}Unit}{\Unit{#1}}}}}
\define@key{Glossary}{Type}{%
  \ifcsvoid{GTag}{}{%
    \csdef{\csuse{GTag}Type}{gly}%
    \ifblank{#1}{}{%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Acronym}} or %
        test {\ifstrequal{#1}{acronym}}%
      }{\csdef{\csuse{GTag}Type}{acr}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Symbol}} or %
        test {\ifstrequal{#1}{symbol}}%
      }{\csdef{\csuse{GTag}Type}{sym}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Glossary}} or %
        test {\ifstrequal{#1}{glossary}}%
      }{\csdef{\csuse{GTag}Type}{gly}}{}%
    }%
  }%
}
\define@key{Glossary}{AcronymType}{%
  \ifcsvoid{GTag}{}{%
    \csdef{\csuse{GTag}AcrType}{}%
    \ifblank{#1}{}{%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Abbreviation}} or %
        test {\ifstrequal{#1}{abbreviation}}%
      }{\csdef{\csuse{GTag}AcrType}{A}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Initials}} or %
        test {\ifstrequal{#1}{initials}}%
      }{\csdef{\csuse{GTag}AcrType}{B}}{}%
    }%
  }%
}
\define@key{Glossary}{SymbolType}{%
  \ifcsvoid{GTag}{}{%
    \csdef{\csuse{GTag}SymType}{}%
    \ifblank{#1}{}{%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Notation}} or %
        test {\ifstrequal{#1}{notation}}%
      }{\csdef{\csuse{GTag}SymType}{A}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Superscript}} or %
        test {\ifstrequal{#1}{superscript}}%
      }{\csdef{\csuse{GTag}SymType}{B}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{Subscript}} or %
        test {\ifstrequal{#1}{subscript}}%
      }{\csdef{\csuse{GTag}SymType}{C}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{GreekLetter}} or %
        test {\ifstrequal{#1}{greekletter}} or %
        test {\ifstrequal{#1}{Greek Letter}} or %
        test {\ifstrequal{#1}{greek letter}}%
      }{\csdef{\csuse{GTag}SymType}{D}}{}%
      \ifboolexpr{%
        test {\ifstrequal{#1}{LatinLetter}} or %
        test {\ifstrequal{#1}{latinletter}} or %
        test {\ifstrequal{#1}{Latin Letter}} or %
        test {\ifstrequal{#1}{latin letter}}%
      }{\csdef{\csuse{GTag}SymType}{E}}{}%
    }%
  }%
}
\csletcs{KV@Glossary@key}{KV@Glossary@Key}
\csletcs{KV@Glossary@sort}{KV@Glossary@Sort}
\csletcs{KV@Glossary@term}{KV@Glossary@Term}
\csletcs{KV@Glossary@description}{KV@Glossary@Description}
\csletcs{KV@Glossary@plural}{KV@Glossary@Plural}
\csletcs{KV@Glossary@parent}{KV@Glossary@Parent}
\csletcs{KV@Glossary@unit}{KV@Glossary@Unit}
\csletcs{KV@Glossary@type}{KV@Glossary@Type}
\csletcs{KV@Glossary@acronymtype}{KV@Glossary@AcronymType}
\csletcs{KV@Glossary@symboltype}{KV@Glossary@SymbolType}
\csletcs{KV@Glossary@Translation}{KV@Glossary@Sort}
\csletcs{KV@Glossary@translation}{KV@Glossary@sort}
\newcommand*{\NewGlossaryEntry}[2]{%
  \ifblank{#2}{}{%
    \csdef{GTag}{#1}%
    \setkeys{Glossary}{%
      Key         = {#1},%
      Sort        = {},%
      Term        = {},%
      Description = {},%
      Plural      = {},%
      Parent      = {},%
      Unit        = {},%
      Type        = {Glossary},%
      AcronymType = {},%
      SymbolType  = {},%
      #2,%
    }%
    \csundef{GTag}%
  }%
}
\NewDocumentCommand{\MakeGlossaryEntry}{ s O{} m }{%
  \ifblank{#3}{}{%
    \csdef{Gly@Type}{\jobname-gly}%
    \ifblank{#2}{%
      \ifcsvoid{#3Type}{}{\csdef{Gly@Type}{\jobname-\csuse{#3Type}}}%
    }{%
      \csdef{Gly@Type}{\jobname-#2}%
    }%
    \csdef{Gly@Key}{#3}%
    \ifcsstring{#3Type}{acr}{%
      \ifcsvoid{#3AcrType}{%
        \csepreto{Gly@Key}{0@}%
      }{%
        \csepreto{Gly@Key}{\csuse{#3AcrType}@}%
      }%
      \ifbool{@PrintAcrHdg}{}{\csdef{Gly@Key}{Acrn@\csuse{#3Key}}}%
      \ifcsstring{#3AcrType}{A}{\abrv@in@doc}{}%
      \ifcsstring{#3AcrType}{B}{\intl@in@doc}{}%
    }{}%
    \ifcsstring{#3Type}{sym}{%
      \ifcsvoid{#3SymType}{%
        \csepreto{Gly@Key}{0@}%
      }{%
        \csepreto{Gly@Key}{\csuse{#3SymType}@}%
      }%
      \ifbool{@PrintSymHdg}{}{%
        \ifcsvoid{#3Sort}{%
          \stepcounter{SymCtr}%
          \csxdef{#3Sort}{\ThreeDigitsCounter{SymCtr}}%
        }{}%
        \csdef{Gly@Key}{Symb@\csuse{#3Sort}@\csuse{#3Key}}%
      }%
    }{}%
    \ifcsvoid{#3Term}{}{%
      \csdef{Gly@Term}{\csuse{#3Term}}%
      \csdef{Gly@Idx}{\csuse{#3Term}}%
      \ifcsstring{#3Type}{acr}{%
        \csdef{Gly@Term}{\emakefirstuc{\csuse{#3Term}}}%
        \cspreto{Gly@Idx}{\csuse{#3Term}?}%
      }{}%
      \ifcsstring{#3Type}{sym}{%
        \csdef{Gly@Term}{\ensuremath{\csuse{#3Term}}}%
        \ifboolexpr{ test {\ifcsstring{#3SymType}{B}} or test {\ifcsstring{#3SymType}{C}} }{%
          \csdef{Gly@Term}{\ensuremath{\DottedCircle\csuse{#3Term}}}%
        }{}%
        \csdef{Gly@Idx}{\csuse{#3Key}?\Gly@Term}%
        \ifcsstring{#3SymType}{D}{\cspreto{Gly@Idx}{@}}{}%
        \ifcsstring{#3SymType}{C}{\cspreto{Gly@Idx}{@@}}{}%
        \ifcsstring{#3SymType}{B}{\cspreto{Gly@Idx}{@@@}}{}%
        \ifcsstring{#3SymType}{A}{\cspreto{Gly@Idx}{@@@@}}{}%
      }{}%
      \ifcsstring{#3Type}{gly}{%
        \cspreto{Gly@Idx}{#3?}%
        \ifcsvoid{#3Parent}{}{%
          \cspreto{Gly@Idx}{\csuse{#3Parent}?\csuse{\csuse{#3Parent}Term}!}%
          \ifcsvoid{\csuse{#3Parent}Parent}{}{%
            \cspreto{Gly@Idx}{\csuse{\csuse{#3Parent}Parent}?\csuse{\csuse{\csuse{#3Parent}Parent}Term}!}%
          }%
        }%
      }{}%
      \ifcsvoid{#3Descr}{}{%
        \csdef{Gly@Descr}{\csuse{#3Descr}}%
        \ifcsstring{#3Type}{acr}{%
          \csdef{Gly@Descr}{\emakefirstuc{\csuse{#3Descr}}}%
          \ifcsvoid{#3Sort}{}{\csappto{Gly@Descr}{ (\ENLang*{\csuse{#3Sort}})}}%
        }{}%
        \ifcsstring{#3Type}{sym}{%
          \csdef{Gly@Descr}{\emakefirstuc{\csuse{#3Descr}}}%
          \ifcsvoid{#3Unit}{}{%
            \ifbool{@UnitRightMargin}{%
              \csdef{Gly@Descr}{%
                \parbox[t]{0.7\linewidth}{\emakefirstuc{\csuse{#3Descr}}}%
                \makebox[0.15\linewidth][r]{\ensuremath{\left[\csuse{#3Unit}\right]}}%
              }%
            }{%
              \csappto{Gly@Descr}{, \csuse{#3Unit}}%
            }%
          }%
        }{}%
        \glossary[\Gly@Type](\Gly@Key){\Gly@Term}{\Gly@Descr}%% CHKTEX 36
      }%
      \IfBooleanT{#1}{%
        \ifboolexpr{ test {\ifcsstring{#3Type}{acr}} or test {\ifcsstring{#3Type}{sym}} }{%
          \IndexSee*{\Gly@Idx}{\csuse{#3Descr}}%
        }{%
          \index{\Gly@Idx}%
        }%
      }%
    }%
    \csundef{Gly@Type}%
    \csundef{Gly@Key}%
    \csundef{Gly@Term}%
    \csundef{Gly@Descr}%
    \csundef{Gly@Idx}%
  }%
}
\NewDocumentCommand{\gly}{ s O{} m O{} }{%
  \ifblank{#3}{}{%
    \ifcsvoid{#3Term}{\gly@err{Term}{#3}}{%
      \ifcsstring{#3Type}{sym}{%
        \begingroup%
        \ifcsvoid{@MrkSym}{}{\csletcs{MrkSym}{@MrkSym}}%
        \ensuremath{\csuse{#3Term}}%
        \endgroup%
      }{%
        #4{\csuse{#3Term}}%
      }%
      \IfBooleanTF{#1}{%
        \ifblank{#2}{\MakeGlossaryEntry*{#3}}{\MakeGlossaryEntry*[#2]{#3}}%
      }{%
        \ifblank{#2}{\MakeGlossaryEntry{#3}}{\MakeGlossaryEntry[#2]{#3}}%
      }%
    }%
  }%
}
\NewDocumentCommand{\Gly}{ s O{} m }{%
  \ifblank{#3}{}{%
    \IfBooleanTF{#1}{%
      \gly*[#2]{#3}[\emakefirstuc]%
    }{%
      \gly[#2]{#3}[\emakefirstuc]%
    }%
  }%
}
\NewDocumentCommand{\glypl}{ s O{} m O{} }{%
  \ifblank{#3}{}{%
    \ifcsvoid{#3Plural}{\gly@err{Plural}{#3}}{%
      \ifcsstring{#3Type}{sym}{%
        \ensuremath{\csuse{#3Plural}}%
      }{%
        #4{\csuse{#3Plural}}%
      }%
      \IfBooleanTF{#1}{%
        \ifblank{#2}{\MakeGlossaryEntry*{#3}}{\MakeGlossaryEntry*[#2]{#3}}%
      }{%
        \ifblank{#2}{\MakeGlossaryEntry{#3}}{\MakeGlossaryEntry[#2]{#3}}%
      }%
    }%
  }%
}
\NewDocumentCommand{\GlyPl}{ s O{} m }{%
  \ifblank{#3}{}{%
    \IfBooleanTF{#1}{%
      \glypl*[#2]{#3}[\emakefirstuc]%
    }{%
      \glypl[#2]{#3}[\emakefirstuc]%
    }%
  }%
}
\newcommand*{\glydescr}[2][]{\ifblank{#2}{}{\ifcsvoid{#2Descr}{\gly@err{Description}{#2}}{#1{\csuse{#2Descr}}}}}
\newcommand*{\GlyDescr}[1]{\glydescr[\emakefirstuc]{#1}}
%%%% Ambiente de glossário
\newbool{MakeAcr}
\newbool{MakeSym}
\newbool{MakeGly}
\newbool{@GlyNoPgs}
\newbool{@GlyLst}
\AtBeginEnvironment{theglossary}{\clearforchapter}
\ifpatchable*{\theglossary}{%
  \xpatchcmd{\theglossary}{%
    \chapter*{\glossaryname}%
  }{%
    \Gly@BM@ToC%
    \chapter*{\Gly@Name}%
  }{}{}%
  \xpatchcmd{\theglossary}{%
    \@makeschapterhead{\glossaryname}%
  }{%
    \Gly@BM@ToC%
    \@makeschapterhead{\Gly@Name}%
  }{}{}%
}{}%
\newcommand*{\glyref}{\HyperLink{\ifbool{@GlyLst}{glylst}{gly}}{\glossaryname}}
\newcommand*{\Gly@Name}{\glossaryname}
\newcommand*{\Gly@BM@ToC}{}
\newcommand*{\GlyHdg}[1]{\@gobble{#1}}
\NewDocumentCommand{\MakeGlossary}{ O{} O{gly} }{%
  \ifboolexpr{%
    test {\ifstrequal{#2}{acr}} or %
    test {\ifstrequal{#2}{sym}} or %
    test {\ifstrequal{#2}{gly}}%
  }{%
    \ifblank{#1}{}{\InputIfFileExists{#1}{}{\PackageWarning{utfpr-thesis}{no file #1.tex}}}%
    \IfFileExists{\jobname-#2.glo}{%
      \immediate\write18{makeindex -c -q -s \jobname.gst -o \jobname-#2.gls \jobname-#2.glo}%
    }{}%
    \makeglossary[\jobname-#2]%
    \ifstrequal{#2}{acr}{\booltrue{MakeAcr}}{}%
    \ifstrequal{#2}{sym}{\booltrue{MakeSym}}{}%
    \ifstrequal{#2}{gly}{\booltrue{MakeGly}}{}%
  }{}%
}
\csletcs{old@printglossary}{printglossary}
\RenewDocumentCommand{\printglossary}{ s O{gly} O{} }{%
  \IfBooleanTF{#1}{\booltrue{@GlyNoPgs}}{\boolfalse{@GlyNoPgs}}%
  \ifboolexpr{%
    test {\ifstrequal{#2}{acr}} or %
    test {\ifstrequal{#2}{sym}} or %
    test {\ifstrequal{#2}{gly}}%
  }{%
    \changeglossactual[\jobname-#2]{?}%
    \changeglossnumformat[\jobname-#2]{|hyperpage}%
    \renewcommand*{\glossitem}[4]{%
      \hangindent0.15\linewidth%
      \settowidth{\dimen1}{##1\quad}%
      \ifdimless{\dimen1}{\hangindent}{\makebox[\hangindent][l]{##1}}{##1\quad}##2\par%
    }%
    \ifstrequal{#2}{acr}{%
      \renewcommand*{\Gly@BM@ToC}{\PDFBookmark{\AcronymsListName}{#2}}%
      \renewcommand*{\Gly@Name}{\AcronymsListName}%
      \csletcs{GlyHdg}{AcrHdg}%
    }{}%
    \ifstrequal{#2}{sym}{%
      \renewcommand*{\Gly@BM@ToC}{\PDFBookmark{\SymbolsListName}{#2}}%
      \renewcommand*{\Gly@Name}{\SymbolsListName}%
      \csletcs{GlyHdg}{SymHdg}%
    }{}%
    \ifstrequal{#2}{gly}{%
      \renewcommand*{\glossitem}[4]{%
        \hangindent15mm%
        {#3{##1}:} ##2.\ifbool{@GlyNoPgs}{}{ ##4.}\par%
      }%
      \renewcommand*{\Gly@BM@ToC}{\AddToToC{\glossaryname}{#2}}%
      \renewcommand*{\Gly@Name}{\glossaryname}%
      \renewcommand*{\GlyHdg}[1]{\IdxHdg[gly]{##1}}%
    }{}%
    \ifbool{onecolglossary}{\renewcommand*{\preglossaryhook}{\label{#2}}}{}%
    \noglossaryintoc%
    \old@printglossary[\jobname-#2]%
    \clearforchapter%
  }{}%
}
\newcommand*{\PrintGlossary}{\@ifstar{\printglossary*[gly]}{\printglossary[gly]}}
\renewcommand*{\begintheglossaryhook}{\begin{SingleSpace}}
\renewcommand*{\atendtheglossaryhook}{\end{SingleSpace}}
\newenvironment*{Glossary}[1][\normalfont]{%
  \immediate\write\@mainaux{\global\booltrue{@GlyLst}}%
  \csdef{GlossaryLabelFont}##1{#1{##1}:}%
  \clearforchapter%
  \AddToToC{\glossaryname}{glylst}%
  \chapter*{\glossaryname}%
  \label{glylst}%
  \vskip-0.5\onelineskip%
  \setlength{\parindent}{\z@}%
  \begin{description}[%
    style         = unboxed,%
    font          = \GlossaryLabelFont,%
    first         = \SingleSpacing,%
    leftmargin    = 15mm,%
    listparindent = -\leftmargin,%
    labelsep      = 0.25em,%
  ]%
}{%
  \end{description}%
  \clearforchapter%
}

%% Apêndices e Anexos
\DeclareRobustCommand*{\@Switch}[1]{%
  \@writefile{toc}{%
    \renewcommand*{\cftappendixname}{\MakeTextUppercase{#1} }%
    \renewcommand*{\cftsectionname}{#1 }%
    \renewcommand*{\cftsubsectionname}{#1 }%
    \renewcommand*{\cftsubsubsectionname}{\uline{#1 }}%
    \renewcommand*{\cftparagraphname}{#1 }%
  }%
}
\newcommand*{\SwitchDivisionName}[1]{\protected@write\@auxout{}{\string\@Switch{#1}}}
\newcommand*{\cft@K@aftersnum}[1]{\csdef{cft#1aftersnum}{\hfill\textendash\hfill}}
\cftinsertcode{ApxCfg}{%
  \cftsetindents{chapter}{\cftlastnumwidth}{2em}%
  \cftsetindents{section}{\cftlastnumwidth}{2.8em}%
  \cftsetindents{subsection}{\cftlastnumwidth}{3.7em}%
  \cftsetindents{subsubsection}{\cftlastnumwidth}{4.6em}%
  \cftsetindents{paragraph}{\cftlastnumwidth}{5.5em}%
  \forcsvlist{\cft@K@aftersnum}{chapter, section, subsection, paragraph}%
  \renewcommand*{\cftsubsubsectionaftersnum}{\uline{\hfill\textendash\hfill}}%
}
\newcommand*{\Hy@param@chk}[1]{\ifcsstring{Hy@param}{#1}{\csletcs{Hy@param}{Hy@appendixstring}}{}}
\newcommand*{\patch@hyper@makecurrent}[1][appendix]{%
  \ifbool{@ApxAnxTtlLower}{%
    \settocpreprocessor{chapter}{%
      \csletcs{tempf@rtoc}{f@rtoc}%
      \csdef{f@rtoc}{\tempf@rtoc}%
    }%
  }{}%
  \ifblank{#1}{}{%
    \renewcommand*{\Hy@appendixstring}{#1}%
    \renewcommand*{\Hy@chapapp}{\Hy@appendixstring}%
  }%
  \ifpatchable*{\hyper@makecurrent}{%
    \xpatchcmd{\hyper@makecurrent}{%
      \ifx\Hy@param\Hy@chapterstring\let\Hy@param\Hy@chapapp\fi%
    }{%
      \forcsvlist{\Hy@param@chk}{chapter, section, subsection, subsubsection, paragraph, subparagraph}%
    }{}{}%
  }{}%
}
\newcommand*{\appendixnumberline}[1]{\appendixname\ #1 \textemdash\ }
\csletcs{old@chapter}{chapter}
\cspreto{old@chapter}{%
  \cftinserthook{toc}{ApxCfg}%
  \SwitchDivisionName{\appendixname}%
}
\cspreto{appendices}{%
  \chapterstyle{AppendixChapter}%
  \csletcs{chapter}{old@chapter}%
  \csdef{sectionsecnumformat}{\appendixname\ \thesection\ \textemdash\ }%
  \csdef{subsectionsecnumformat}{\appendixname\ \thesubsection\ \textemdash\ }%
  \csdef{subsubsectionsecnumformat}{\uline{\appendixname\ \thesubsubsection\ \textemdash\ }}%
  \csdef{paragraphsecnumformat}{\appendixname\ \theparagraph\ \textemdash\ }%
  \ifpatchable*{\Hy@writebookmark}{%
    \xpatchcmd{\Hy@writebookmark}{%
      \let\chapternumberline\Hy@numberline%
    }{%
      \csletcs{chapternumberline}{appendixnumberline}%
    }{}{}%
    \xpatchcmd{\Hy@writebookmark}{%
      \let\numberline\Hy@numberline%
    }{%
      \csletcs{numberline}{appendixnumberline}%
    }{}{}%
  }{}%
}
\csappto{appendices}{\appendix}
%%%% Apêndices
\newcommand*{\apxsref}{\HyperLink{apxs}{\Cref@appendix@name@plural}}
\newcommand*{\crefaliasapxs}[1]{\crefalias{#1}{appendix}}
\newcommand*{\AppendicesPart}{%
  \renewcommand*{\appendixtocname}{\Cref@appendix@name@plural}%
  \renewcommand*{\appendixpagename}{\Cref@appendix@name@plural}%
  \renewcommand*{\addappheadtotoc}{%
    \addtocontents{toc}{\cftsetindents{part}{\cftlastnumwidth}{2em}}%
    \AddToToC[part]{\appendixtocname}{apxs}%
  }%
  \clearforchapter%
  \appendixpage%
}
\newenvironment*{Appendices}{%
  \forcsvlist{\crefaliasapxs}{subappendix, subsubappendix, subsubsubappendix, paragraph, subparagraph}%
  \renewcommand*{\appendixname}{\Cref@appendix@name}%
  \patch@hyper@makecurrent%
  \begin{appendices}%
}{%
  \end{appendices}%
  \PhantomPart%
}
%%%% Anexos
\Crefname{annex}{Anexo}{Anexos}
\ifbool{@cref@capitalise}{%
  \crefname{annex}{Anexo}{Anexos}%
}{%
  \crefname{annex}{anexo}{anexos}%
}
\csappto{extrasbrazilian}{%
  \Crefname{annex}{Anexo}{Anexos}%
  \ifbool{@cref@capitalise}{%
    \crefname{annex}{Anexo}{Anexos}%
  }{%
    \crefname{annex}{anexo}{anexos}%
  }%
}
\csappto{extrasenglish}{%
  \Crefname{annex}{Annex}{Annexes}%
  \ifbool{@cref@capitalise}{%
    \crefname{annex}{Annex}{Annexes}%
  }{%
    \crefname{annex}{annex}{annexes}%
  }%
}
\newcommand*{\annexautorefname}{\Cref@annex@name}
\newcommand*{\anxsref}{\HyperLink{anxs}{\Cref@annex@name@plural}}
\newcommand*{\crefaliasanxs}[1]{\crefalias{#1}{annex}}
\newcommand*{\AnnexesPart}{%
  \renewcommand*{\appendixtocname}{\Cref@annex@name@plural}%
  \renewcommand*{\appendixpagename}{\Cref@annex@name@plural}%
  \renewcommand*{\addappheadtotoc}{%
    \addtocontents{toc}{\cftsetindents{part}{\cftlastnumwidth}{2em}}%
    \AddToToC[part]{\appendixtocname}{anxs}%
  }%
  \clearforchapter%
  \appendixpage%
}
\newenvironment*{Annexes}{%
  \forcsvlist{\crefaliasanxs}{appendix, subappendix, subsubappendix, subsubsubappendix, paragraph, subparagraph}%
  \renewcommand*{\appendixname}{\Cref@annex@name}%
  \patch@hyper@makecurrent[annex]%
  \begin{appendices}%
}{%
  \end{appendices}%
  \PhantomPart%
}

%% Índice
\AddToLang{NAlsName}{Não alfabéticos}{Non-alphabetics}
\AddToLang{NumsName}{Números}{Numbers}
\AddToLang{seename}{ver}{see}
\AddToLang{alsoname}{ver também}{see also}
%%%% Arquivo de estilo de índice makeindex
\begin{verbatimoutput}{\jobname.ist}
%% \jobname.ist makeindex index style file
%%%% Output style parameters
preamble "\\begin{theindex}\n\\begin{SingleSpace}\n"
postamble "\n\n\\end{SingleSpace}\n\\end{theindex}\n"
group_skip "\n\n\\indexspace\n"
heading_prefix "\n\\IdxHdg{"
heading_suffix "}"
headings_flag 1
line_max 1000
indent_space ""
%%%% Input style parameters
actual '?'
\end{verbatimoutput}
%%%% Itens de índice
\newbool{@IdxSee}
\AfterEndPreamble{%
  \csdef{@@@wrindexm@m}#1#2{%
    \ifbool{@filesw}{%
      \ifbool{@IdxSee}{%
        \immediate@protected@write\@idxfile{}{\string\indexentry{#1}{999}}%
      }{%
        \immediate@protected@write\@idxfile{}{\string\indexentry{#1}{#2}}%
      }%
    }{}%
    \endgroup%
  }%
}
\DeclareRobustCommand*{\GobbleComma}[1]{\@gobble{#1}}
\renewcommand*{\see}[2]{\ifblank{#1}{}{\textbf{\seename} #1}}
\renewcommand*{\seealso}[2]{\ifblank{#1}{}{\textbf{\alsoname} #1}}
\renewcommand*{\@idxitem}{\par\hangindent40\p@}
\renewcommand*{\subitem}{\@idxitem\nobreak\hskip15\p@}
\renewcommand*{\subsubitem}{\@idxitem\nobreak\hskip30\p@}
\NewDocumentCommand{\IndexSee}{ s m m }{%
  \ifboolexpr{ test {\ifblank{#2}} or test {\ifblank{#3}}}{}{%
    \protected@write\@auxout{}{\string\booltrue{@IdxSee}}%
    \IfBooleanF{#1}{#2}\index{#2\GobbleComma|see{#3}}%
    \protected@write\@auxout{}{\string\boolfalse{@IdxSee}}%
  }%
}
\NewDocumentCommand{\IndexSeeAlso}{ s m m }{%
  \ifboolexpr{ test {\ifblank{#2}} or test {\ifblank{#3}}}{}{%
    \protected@write\@auxout{}{\string\booltrue{@IdxSee}}%
    \IfBooleanF{#1}{#2}\index{#2\GobbleComma|seealso{#3}}%
    \protected@write\@auxout{}{\string\boolfalse{@IdxSee}}%
  }%
}
\NewDocumentCommand{\Index}{ O{} O{} m O{} }{%
  \ifblank{#3}{}{%
    \csdef{Idx@Term}{#3}%
    \ifblank{#4}{}{\ifstrequal{#4}{#3}{}{\cspreto{Idx@Term}{#4?}}}%
    \ifblank{#2}{}{\cspreto{Idx@Term}{#2!}}%
    \ifblank{#1}{}{\cspreto{Idx@Term}{#1!}}%
    #3\index{\Idx@Term}%
    \csundef{Idx@Term}%
  }%
}
%%%% Ambiente de índice
\newbool{@IdxLst}
\AtBeginEnvironment{theindex}{\LessSloppy}
\csletcs{indexspace}{glossaryspace}
\ifpatchable*{\theindex}{%
  \xpatchcmd{\theindex}{%
    \chapter*{\indexname}%
  }{%
    \AddToToC{\indexname}{\ifbool{@IdxLst}{idxlst}{idx}}%
    \chapter*{\indexname}%
  }{}{}%
  \xpatchcmd{\theindex}{%
    \@makeschapterhead{\indexname}%
  }{%
    \AddToToC{\indexname}{\ifbool{@IdxLst}{idxlst}{idx}}%
    \@makeschapterhead{\indexname}%
  }{}{}%
}{}
\newcommand*{\idxref}{\HyperLink{\ifbool{@IdxLst}{idxlst}{idx}}{\indexname}}
\newcommand*{\IdxHdg}[2][idx]{%
  \ifstrequal{#2}{Symbols}{\pdfbookmark[section]{\NAlsName}{nals#1}}{%
    \ifstrequal{#2}{Numbers}{\pdfbookmark[section]{\NumsName}{nums#1}}{%
      \pdfbookmark[section]{#2}{#2#1}%
    }%
  }%
}
\newcommand*{\MakeIndex}{%
  \IfFileExists{\jobname.idx}{\immediate\write18{makeindex -c -q -s \jobname.ist \jobname.idx}}{}%
  \makeindex%
}
\newcommand*{\PrintIndex}{%
  \ifbool{onecolindex}{\renewcommand*{\preindexhook}{\label{idx}}}{}%
  \noindexintoc%
  \printindex%
  \clearforchapter%
}
\newenvironment*{RemissiveIndex}{%
  \global\booltrue{@IdxLst}%
  \noindexintoc%
  \begin{theindex}%
  \begin{SingleSpace}%
}{%
  \end{SingleSpace}%
  \end{theindex}%
  \clearforchapter%
}

%% Finalização do documento
\AtEndDocument{\BackCover}
